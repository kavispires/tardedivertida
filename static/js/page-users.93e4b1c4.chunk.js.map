{"version":3,"file":"static/js/page-users.93e4b1c4.chunk.js","mappings":"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","sources":["pages/Me/Users.tsx","../node_modules/@tanstack/query-core/src/mutationObserver.ts","../node_modules/@tanstack/react-query/src/useMutation.ts"],"sourcesContent":["// Components\n// Sass\nimport './Me.scss';\n\nimport { App, Button, Input, Select, Space, Typography } from 'antd';\nimport { collection, getDocs, query, where } from 'firebase/firestore';\nimport { cloneDeep, merge } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { useTitle } from 'react-use';\nimport { USER_API, USER_API_ACTIONS } from 'services/adapters';\nimport { firestore } from 'services/firebase';\n\ninterface GameUserEntry {\n  gameName?: GameName;\n  gameId: GameId;\n  startedAt: number;\n  endedAt: number;\n  playerCount: number;\n  placement: number;\n  win?: boolean;\n  last?: boolean;\n  achievements: AchievementKey[];\n}\n\ntype AvatarId = string;\ntype AchievementKey = string;\ntype GameName = string;\ntype DailyEntry = {\n  id: string; // Format YYYY-MM-DD\n  number: number;\n  victory: boolean;\n  hearts: number;\n  letters: string[];\n};\n\n/**\n * User database structure saved in Firestore\n */\ninterface FirebaseUserDB {\n  id: string;\n  isAdmin?: boolean;\n  isGuest?: boolean;\n  preferredLanguage: Language;\n  names: string[]; // unique list but most recent comes last\n  gender?: string;\n  avatars: Record<AvatarId, number>;\n  ratings: Record<GameName, number>;\n  games: Record<GameName, Record<GameId, GameUserEntry>>;\n  blurredImages: Record<ImageCardId, true>;\n  daily: Record<CardId, DailyEntry>;\n}\n\nconst DEFAULT_FIREBASE_USER_DB: FirebaseUserDB = {\n  id: '',\n  names: [],\n  avatars: {},\n  preferredLanguage: 'en',\n  games: {},\n  gender: 'unknown',\n  ratings: {},\n  blurredImages: {},\n  daily: {},\n};\n\nfunction Users() {\n  useTitle('Users - Tarde Divertida');\n  const { message, notification } = App.useApp();\n  const queryClient = useQueryClient();\n\n  const [selectedUserO, setSelectedUserO] = useState(DEFAULT_FIREBASE_USER_DB);\n  const [selectedUserD, setSelectedUserD] = useState(DEFAULT_FIREBASE_USER_DB);\n\n  const usersQuery = useQuery({\n    queryKey: ['users'],\n    queryFn: async () => {\n      const querySnapshot = await getDocs(\n        query(collection(firestore, 'users'), where('isGuest', '!=', true))\n      );\n      const result: any[] = [];\n      querySnapshot.forEach((doc) => result.push(doc.data()));\n      return result;\n    },\n  });\n\n  const usersMutation = useMutation({\n    mutationKey: ['users'],\n    mutationFn: async (data: FirebaseUserDB) => {\n      USER_API.run({ action: USER_API_ACTIONS.UPDATE_USER_DB, ...data });\n    },\n    onSuccess: () => {\n      message.success('User updated');\n      queryClient.invalidateQueries({\n        queryKey: ['users'],\n      });\n    },\n    onError: (error: any) => {\n      notification.error({\n        message: 'Error',\n        description: error.message,\n      });\n    },\n  });\n\n  const data: FirebaseUserDB[] = usersQuery.data ?? [];\n\n  const onSelectUserO = (uid: string) => {\n    setSelectedUserO(data.find((e) => e.id === uid) ?? DEFAULT_FIREBASE_USER_DB);\n  };\n\n  const onSelectUserD = (uid: string) => {\n    setSelectedUserD(data.find((e) => e.id === uid) ?? DEFAULT_FIREBASE_USER_DB);\n  };\n\n  const options = data.map((entry) => (\n    <Select.Option key={entry.id} value={entry.id}>\n      <strong>{entry?.names?.[0]}</strong>: {entry.id}\n    </Select.Option>\n  ));\n\n  const selectO = (\n    <Select onChange={onSelectUserO} style={{ minWidth: 300 }}>\n      {options}\n    </Select>\n  );\n\n  const selectD = (\n    <Select onChange={onSelectUserD} style={{ minWidth: 300 }}>\n      {options}\n    </Select>\n  );\n\n  const mergedUser = useMemo(\n    () => merge(cloneDeep(selectedUserO ?? {}), cloneDeep(selectedUserD ?? {})),\n    [selectedUserO, selectedUserD]\n  );\n\n  console.log(data);\n\n  return (\n    <div>\n      <Typography.Title>Users</Typography.Title>\n      {usersQuery.isLoading && <Typography.Paragraph>Loading...</Typography.Paragraph>}\n      <Space className=\"margin\" style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)' }}>\n        <Space direction=\"vertical\">\n          <Typography.Title level={2}>Origin</Typography.Title>\n          <Space className=\"margin\">{selectO}</Space>\n          <Typography.Paragraph>\n            {selectedUserO?.names?.join(', ') ?? 'No user selected'}\n          </Typography.Paragraph>\n          <Input.TextArea\n            value={JSON.stringify(selectedUserO ?? {}, null, 2)}\n            rows={20}\n            cols={50}\n            className=\"margin\"\n          />\n        </Space>\n\n        <Space direction=\"vertical\">\n          <Typography.Title level={2}>Destination</Typography.Title>\n          <Space className=\"margin\">{selectD}</Space>\n          <Typography.Paragraph>\n            {selectedUserD?.names?.join(', ') ?? 'No user selected'}\n          </Typography.Paragraph>\n          <Input.TextArea\n            value={JSON.stringify(selectedUserD ?? {}, null, 2)}\n            rows={20}\n            cols={50}\n            className=\"margin\"\n          />\n        </Space>\n      </Space>\n\n      <Space direction=\"vertical\">\n        <Typography.Title level={2}>Merge</Typography.Title>\n\n        <Typography.Paragraph>{mergedUser?.names?.join(', ') ?? 'No user selected'}</Typography.Paragraph>\n        <Input.TextArea\n          value={JSON.stringify(mergedUser ?? {}, null, 2)}\n          rows={20}\n          cols={50}\n          className=\"margin\"\n        />\n        <Button\n          type=\"primary\"\n          size=\"large\"\n          loading={usersMutation.isPending}\n          onClick={() => usersMutation.mutate(mergedUser)}\n          disabled={!mergedUser?.id}\n        >\n          Merge Users \"{selectedUserO.id}\" into \"{selectedUserD.id}\"\n        </Button>\n      </Space>\n    </div>\n  );\n}\n\nexport default Users;\n","import { getDefaultState } from './mutation'\nimport { notifyManager } from './notifyManager'\nimport { Subscribable } from './subscribable'\nimport { hashKey, shallowEqualObjects } from './utils'\nimport type { QueryClient } from './queryClient'\nimport type {\n  DefaultError,\n  MutateOptions,\n  MutationObserverOptions,\n  MutationObserverResult,\n} from './types'\nimport type { Action, Mutation } from './mutation'\n\n// TYPES\n\ntype MutationObserverListener<TData, TError, TVariables, TContext> = (\n  result: MutationObserverResult<TData, TError, TVariables, TContext>,\n) => void\n\n// CLASS\n\nexport class MutationObserver<\n  TData = unknown,\n  TError = DefaultError,\n  TVariables = void,\n  TContext = unknown,\n> extends Subscribable<\n  MutationObserverListener<TData, TError, TVariables, TContext>\n> {\n  options!: MutationObserverOptions<TData, TError, TVariables, TContext>\n\n  #client: QueryClient\n  #currentResult: MutationObserverResult<TData, TError, TVariables, TContext> =\n    undefined!\n  #currentMutation?: Mutation<TData, TError, TVariables, TContext>\n  #mutateOptions?: MutateOptions<TData, TError, TVariables, TContext>\n\n  constructor(\n    client: QueryClient,\n    options: MutationObserverOptions<TData, TError, TVariables, TContext>,\n  ) {\n    super()\n\n    this.#client = client\n    this.setOptions(options)\n    this.bindMethods()\n    this.#updateResult()\n  }\n\n  protected bindMethods(): void {\n    this.mutate = this.mutate.bind(this)\n    this.reset = this.reset.bind(this)\n  }\n\n  setOptions(\n    options: MutationObserverOptions<TData, TError, TVariables, TContext>,\n  ) {\n    const prevOptions = this.options as\n      | MutationObserverOptions<TData, TError, TVariables, TContext>\n      | undefined\n    this.options = this.#client.defaultMutationOptions(options)\n    if (!shallowEqualObjects(this.options, prevOptions)) {\n      this.#client.getMutationCache().notify({\n        type: 'observerOptionsUpdated',\n        mutation: this.#currentMutation,\n        observer: this,\n      })\n    }\n\n    if (\n      prevOptions?.mutationKey &&\n      this.options.mutationKey &&\n      hashKey(prevOptions.mutationKey) !== hashKey(this.options.mutationKey)\n    ) {\n      this.reset()\n    } else if (this.#currentMutation?.state.status === 'pending') {\n      this.#currentMutation.setOptions(this.options)\n    }\n  }\n\n  protected onUnsubscribe(): void {\n    if (!this.hasListeners()) {\n      this.#currentMutation?.removeObserver(this)\n    }\n  }\n\n  onMutationUpdate(action: Action<TData, TError, TVariables, TContext>): void {\n    this.#updateResult()\n\n    this.#notify(action)\n  }\n\n  getCurrentResult(): MutationObserverResult<\n    TData,\n    TError,\n    TVariables,\n    TContext\n  > {\n    return this.#currentResult\n  }\n\n  reset(): void {\n    // reset needs to remove the observer from the mutation because there is no way to \"get it back\"\n    // another mutate call will yield a new mutation!\n    this.#currentMutation?.removeObserver(this)\n    this.#currentMutation = undefined\n    this.#updateResult()\n    this.#notify()\n  }\n\n  mutate(\n    variables: TVariables,\n    options?: MutateOptions<TData, TError, TVariables, TContext>,\n  ): Promise<TData> {\n    this.#mutateOptions = options\n\n    this.#currentMutation?.removeObserver(this)\n\n    this.#currentMutation = this.#client\n      .getMutationCache()\n      .build(this.#client, this.options)\n\n    this.#currentMutation.addObserver(this)\n\n    return this.#currentMutation.execute(variables)\n  }\n\n  #updateResult(): void {\n    const state =\n      this.#currentMutation?.state ??\n      getDefaultState<TData, TError, TVariables, TContext>()\n\n    this.#currentResult = {\n      ...state,\n      isPending: state.status === 'pending',\n      isSuccess: state.status === 'success',\n      isError: state.status === 'error',\n      isIdle: state.status === 'idle',\n      mutate: this.mutate,\n      reset: this.reset,\n    } as MutationObserverResult<TData, TError, TVariables, TContext>\n  }\n\n  #notify(action?: Action<TData, TError, TVariables, TContext>): void {\n    notifyManager.batch(() => {\n      // First trigger the mutate callbacks\n      if (this.#mutateOptions && this.hasListeners()) {\n        const variables = this.#currentResult.variables!\n        const context = this.#currentResult.context\n\n        if (action?.type === 'success') {\n          this.#mutateOptions.onSuccess?.(action.data, variables, context!)\n          this.#mutateOptions.onSettled?.(action.data, null, variables, context)\n        } else if (action?.type === 'error') {\n          this.#mutateOptions.onError?.(action.error, variables, context)\n          this.#mutateOptions.onSettled?.(\n            undefined,\n            action.error,\n            variables,\n            context,\n          )\n        }\n      }\n\n      // Then trigger the listeners\n      this.listeners.forEach((listener) => {\n        listener(this.#currentResult)\n      })\n    })\n  }\n}\n","'use client'\nimport * as React from 'react'\nimport { MutationObserver, notifyManager } from '@tanstack/query-core'\nimport { useQueryClient } from './QueryClientProvider'\nimport { noop, shouldThrowError } from './utils'\nimport type {\n  UseMutateFunction,\n  UseMutationOptions,\n  UseMutationResult,\n} from './types'\nimport type { DefaultError, QueryClient } from '@tanstack/query-core'\n\n// HOOK\n\nexport function useMutation<\n  TData = unknown,\n  TError = DefaultError,\n  TVariables = void,\n  TContext = unknown,\n>(\n  options: UseMutationOptions<TData, TError, TVariables, TContext>,\n  queryClient?: QueryClient,\n): UseMutationResult<TData, TError, TVariables, TContext> {\n  const client = useQueryClient(queryClient)\n\n  const [observer] = React.useState(\n    () =>\n      new MutationObserver<TData, TError, TVariables, TContext>(\n        client,\n        options,\n      ),\n  )\n\n  React.useEffect(() => {\n    observer.setOptions(options)\n  }, [observer, options])\n\n  const result = React.useSyncExternalStore(\n    React.useCallback(\n      (onStoreChange) =>\n        observer.subscribe(notifyManager.batchCalls(onStoreChange)),\n      [observer],\n    ),\n    () => observer.getCurrentResult(),\n    () => observer.getCurrentResult(),\n  )\n\n  const mutate = React.useCallback<\n    UseMutateFunction<TData, TError, TVariables, TContext>\n  >(\n    (variables, mutateOptions) => {\n      observer.mutate(variables, mutateOptions).catch(noop)\n    },\n    [observer],\n  )\n\n  if (\n    result.error &&\n    shouldThrowError(observer.options.throwOnError, [result.error])\n  ) {\n    throw result.error\n  }\n\n  return { ...result, mutate, mutateAsync: result.mutate }\n}\n"],"names":["DEFAULT_FIREBASE_USER_DB","id","names","avatars","preferredLanguage","games","gender","ratings","blurredImages","daily","useTitle","App","message","notification","queryClient","useQueryClient","useState","selectedUserO","setSelectedUserO","selectedUserD","setSelectedUserD","usersQuery","useQuery","queryKey","queryFn","getDocs","query","collection","firestore","where","querySnapshot","result","forEach","doc","push","data","usersMutation","useMutation","mutationKey","mutationFn","USER_API","action","USER_API_ACTIONS","onSuccess","success","invalidateQueries","onError","error","description","options","map","entry","value","selectO","onChange","uid","find","e","style","minWidth","selectD","mergedUser","useMemo","merge","cloneDeep","console","log","isLoading","className","display","gridTemplateColumns","direction","level","join","JSON","stringify","rows","cols","type","size","loading","isPending","onClick","mutate","disabled","MutationObserver","client","setOptions","bindMethods","this","bind","reset","prevOptions","defaultMutationOptions","getMutationCache","notify","mutation","observer","state","status","hasListeners","removeObserver","variables","build","addObserver","execute","isSuccess","isError","isIdle","notifyManager","context","onSettled","listeners","listener","useEffect","useSyncExternalStore","useCallback","onStoreChange","subscribe","getCurrentResult","mutateOptions","catch","throwOnError","mutateAsync"],"sourceRoot":""}