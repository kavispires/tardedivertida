import{r as g,$ as T,bn as C,bF as F,aw as z,v as y,j as a,c as $,av as h,T as k,bt as D}from"./index-BbyNXcvu.js";import{u as G}from"./DebugOnly-i3bRuDG4.js";import{P}from"./PlayerAvatar-DCVN2rBx.js";var L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zM512 734.2c-62.1 0-112.6-50.5-112.6-112.6S449.9 509 512 509s112.6 50.5 112.6 112.6S574.1 734.2 512 734.2zm0-160.9c-26.6 0-48.2 21.6-48.2 48.3 0 26.6 21.6 48.3 48.2 48.3s48.2-21.6 48.2-48.3c0-26.6-21.6-48.3-48.2-48.3z"}}]},name:"crown",theme:"filled"};function f(){return f=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var i=arguments[s];for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(n[e]=i[e])}return n},f.apply(this,arguments)}const q=(n,s)=>g.createElement(T,f({},n,{ref:s,icon:L})),I=g.forwardRef(q);function H({gainedPoint:n,order:s,description:i}){const e=n>0,t=n<0;return a.jsx("li",{className:$("ranking-board__gained-point",e&&"ranking-board__gained-point--plus",t&&"ranking-board__gained-point--minus",`ranking-board__gained-point--${s}`),children:a.jsxs(h,{title:i??a.jsx(k,{pt:"Pontos ganhos",en:"Gained Points"}),color:e?"gold":t?"red":"gray",children:[e?"+":"",n]})})}function R({gainedPoints:n,playerId:s,gainedPointsDescriptions:i=[]}){const e=Array.isArray(n)?n:[n];return a.jsx("ul",{className:"ranking-board__cell-gained-points",children:e.map((t,m)=>a.jsx(H,{gainedPoint:t,order:m,description:i[m]},`gained-point-${s}-${m}`))})}function U({players:n,ranking:s,gainedPointsDescriptions:i,hideGainedPoints:e=!1,delay:t=0,victoryIndex:m=0}){const[j,v]=g.useState(0),[N,A]=g.useState([]),[w,E]=g.useState(0),[B,{height:S}]=C(),M=g.useId(),O=g.useMemo(()=>F(s.map(l=>l.newScore).sort((l,c)=>c-l)),[s]),{seconds:_}=G({duration:5+t,autoStart:!0,onExpire:()=>{E(1),v(3)}});return z(()=>{const l={};let c=0,r=0;const x=y.orderBy(s,["newScore","name"],["desc","asc"]).reduce((d,p,o)=>(d[p.playerId]=o,(r===0||p.newScore<r)&&(r=p.newScore,c+=1),l[p.playerId]=[0,c],d),{}),b=y.orderBy(s,["previousScore","name"],["desc","asc"]);c=0,r=0;const u=b.map((d,p)=>{const o={...d};return o.order=[p,x[o.playerId]],o.position=l[o.playerId],(r===0||d.previousScore<r)&&(r=d.previousScore,c+=1),o.position[0]=c,o});A(u)}),g.useEffect(()=>{_===4+t?v(1):_===2+t&&v(2)},[_,t]),a.jsxs("div",{className:$("ranking-board",_>4&&"ranking-board--hidden",_===4&&D("fadeIn")),style:{height:`${(Math.max(60,S)+8)*N.length}px`},children:[a.jsxs("div",{className:"ranking-board__row",id:`ranking-row-${M}-placeholder`,style:{opacity:0},ref:B,children:[a.jsx("div",{className:"ranking-board__cell-crown",children:a.jsx(I,{className:"ranking-board__crown-icon"})}),a.jsx("div",{className:"ranking-board__cell-position",children:"#0"}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(P,{avatarId:"A"})}),a.jsx("div",{className:"ranking-board__name",children:"Placeholder"})]}),a.jsx(h,{title:a.jsx(k,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:"0"})}),a.jsx(R,{gainedPoints:0,playerId:"A"}),a.jsx(h,{title:"Total",color:"gold",children:a.jsx("span",{className:"ranking-board__cell-points-total",children:"0"})})]}),N.map((l,c)=>{const{playerId:r,newScore:x,previousScore:b,gainedPoints:u,order:d,position:p}=l,o=(Math.max(60,S)+8)*(d[w]??0);return a.jsxs("div",{className:`ranking-board__row ranking-board__row--${c}`,style:{top:`${o}px`},children:[a.jsx("div",{className:"ranking-board__cell-crown",children:O[m]===x&&j>=3&&a.jsx(I,{className:"ranking-board__crown-icon"})}),a.jsxs("div",{className:"ranking-board__cell-position",children:["#",p[w]??""]}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(P,{avatarId:n[r].avatarId})}),a.jsx("div",{className:"ranking-board__name",children:n[r].name})]}),a.jsx(h,{title:a.jsx(k,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:b})}),!e&&j>=1&&u!==void 0&&a.jsx(R,{gainedPoints:u,playerId:r,gainedPointsDescriptions:i}),a.jsx(h,{title:"Total",color:"gold",children:j>=2?a.jsx("span",{className:"ranking-board__cell-points-total",children:x}):a.jsx("span",{className:"ranking-board__cell-points-total-preliminary",children:x})})]},`ranking-${r}`)})]})}export{U as R,I as a};
