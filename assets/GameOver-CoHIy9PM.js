import{j as e,r as l,aH as S,h as w,aI as f,y as O,e as R,aL as T,T as s,K as B,B as g,b1 as M,aC as k,eV as E,aF as W,bw as H,b8 as P,s as _,b6 as L}from"./index-bBiYI0CQ.js";import{u as C}from"./useBlurCards-Dy8AUFyg.js";import{A as F}from"./Avatar-CqZ5pSdn.js";import{a as q}from"./GameBanner-B4VActZo.js";import{H as z,q as Y,u as D,S as V}from"./StepSwitcher-Bl_4V5a3.js";import{I as $}from"./Instruction-BzEemjcL.js";import{u as J}from"./Game-Bv4KSS2l.js";import{F as K}from"./speech-CHGnGlLE.js";import{R as U}from"./StarFilled-CCZISw9S.js";import{R as Q,a as X}from"./index-DxDqKiYi.js";import{P as N}from"./progress-CR0OdLRw.js";function Z({onClick:a,children:n,...o}){return e.jsx(z,{children:e.jsx(Y,{onClick:a,...o,children:n})})}const{TextArea:ee}=B;function ae({customText:a}){const[n,o]=l.useState(!1);return n?e.jsx(e.Fragment,{}):e.jsx(K,{content:e.jsx(se,{customText:a,hideWidget:n,setHideWidget:o}),type:"popover",icon:e.jsx(U,{}),position:3,open:!0})}function se({customText:a,hideWidget:n,setHideWidget:o}){const{gameId:x}=J(),{isLoading:c}=S(),{translate:t}=w(),[h]=f("userId"),{isAdmin:m}=O(),[p]=f("isAdminEnabled"),[i,j]=l.useState(0),[d,r]=l.useState(""),[v,y]=l.useState(!1),{start:b}=C({duration:3,onExpire:()=>o(!0),autoStart:!1}),A=D({actionName:"rating",successMessage:t("Obrigado por avaliar o jogo","Thanks for rating the game"),errorMessage:t("Envio de avaliação falhou","Rating submission has failed"),onBeforeCall:()=>y(!0),onAfterCall:b}),I=()=>{A({action:k.RATE_GAME,ratings:{comments:d,gameId:x,playerId:h,ratedAt:Date.now(),rating:i}})};return m&&!p?e.jsx(e.Fragment,{}):e.jsx("div",{className:R("rate-game-widget",v&&"rate-game-widget--thank-you",M(n?"bounceOut":"bounceIn")),children:v?e.jsx(T,{message:t("Obrigado","Thank you"),type:"success",showIcon:!0}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{children:e.jsx(s,{pt:"O que achou do jogo?",en:"Rate this game"})}),e.jsx(Q,{onChange:j}),e.jsx("p",{children:e.jsx(s,{pt:"Comentários",en:"Comments",custom:a})}),e.jsx(ee,{onChange:G=>r(G.target.value),disabled:c}),e.jsx(g,{type:"primary",disabled:!i||c,onClick:I,size:"small",children:e.jsx(s,{pt:"Enviar",en:"Send"})}),e.jsx("p",{style:{marginTop:"1rem"},children:e.jsx(g,{ghost:!0,onClick:()=>o(!0),size:"small",children:e.jsx(s,{pt:"Hide",en:"Hide"})})})]})})}const ne="/tardedivertida/assets/game-over-title-C-lDOW8G.svg",u=()=>e.jsx(s,{pt:"Jogo concluído",en:"The game is over"});function he({state:a,children:n,className:o,rateWidgetCustomText:x,announcement:c}){var d;const t=E(),{language:h}=w(),[m,p]=l.useState(!1),i=W();C({duration:15,onExpire:()=>p(!0)});const j=!!a.winners&&a.winners.length>0||!!a.group||!!a.team;return e.jsxs(V,{className:o,announcement:c,fullWidth:!0,children:[e.jsx("div",{className:"game-over__banner",children:e.jsx(q,{gameName:t.gameName,width:400,title:t.title,stripWidth:window.innerWidth-16,showLogo:m,children:!m&&e.jsx(H.img,{src:ne,alt:"Game Over",className:"game-over__title",style:{width:400,transform:"translate(-50%, -50%)"},initial:{opacity:0,scale:.5,transform:"translate(-50%, -50%)"},animate:{opacity:1,scale:1,transform:"translate(-50%, -50%)"},transition:{delay:4,duration:2},exit:{opacity:0,scale:0,transform:"translate(-50%, -50%)"}})})}),j&&((d=a==null?void 0:a.group)==null?void 0:d.outcome)!=="NON_WINNABLE_GAME"&&e.jsxs($,{contained:!0,children:[!!a.winners&&a.winners.length>0&&e.jsxs("div",{className:"game-over__winner-container",children:[e.jsxs("div",{className:"game-over__text",children:[e.jsx(u,{})," ",a.winners.length>1?e.jsx(s,{pt:"e os vencedores são",en:"and the winners are"}):e.jsx(s,{pt:"e o vencedor é",en:"and the winner is"}),":"]}),e.jsx("ul",{className:"game-over__winners",children:a.winners.map(r=>e.jsxs("li",{className:"game-over__winner",children:[e.jsx(F,{className:"game-over__avatar",id:r.avatarId??25}),e.jsxs("div",{className:"game-over__winner-name",children:[e.jsx("strong",{children:r.name??"?"}),","," ",P[r.avatarId].description[h]]})]},`winner-${r.name}`))})]}),!!a.group&&e.jsxs("div",{className:"game-over__winner",children:[e.jsx("div",{className:"game-over__text",children:e.jsx(u,{})}),e.jsx(N,{type:"circle",strokeColor:a.group.outcome==="WIN"?{"0%":"#4ba226","100%":"#87d068"}:{"0%":"#ff0000","70%":"#ff0000","100%":"#87d068"},percent:Math.round((a.group.score??0)*100/(a.group.goal??1))}),e.jsx("div",{className:"game-over__text",children:a.group.outcome==="WIN"?e.jsx(s,{pt:"Parabéns, vocês ganharam!",en:"Congratulations, you won!"}):e.jsx(s,{pt:"Não foi dessa vez, que vergonha heim!",en:"You lost! What a shame!"})})]}),!!a.team&&e.jsxs("div",{className:"game-over__winner",children:[e.jsx("div",{className:"game-over__text",children:e.jsx(u,{})}),e.jsx(N,{type:"circle",strokeColor:{"0%":"#ff0000","70%":"#ff0000","100%":"#87d068"},percent:a.team.score??0}),e.jsx("div",{className:"game-over__text",children:a.team.victory?e.jsx(s,{pt:"Parabéns, vocês ganharam!",en:"Congratulations, you won!"}):e.jsx(s,{pt:"Não foi dessa vez, que vergonha heim!",en:"You lost! What a shame!"})})]}),!a.winners&&!a.team&&!a.group&&e.jsx("div",{className:"game-over__text",children:e.jsx(u,{})})]}),e.jsx(ae,{customText:x}),n,e.jsxs(_,{align:"center",direction:"vertical",className:"full-width padding",style:{marginTop:"48px"},children:[e.jsxs(_.Compact,{children:[e.jsx(g,{onClick:()=>i("/"),children:e.jsx(s,{pt:"Página Inicial",en:"Home Page"})}),e.jsx(g,{children:e.jsxs(L,{to:"/me",target:"_blank",children:[e.jsx(s,{pt:"Meu Perfil",en:"My Profile"})," ",e.jsx(X,{style:{rotate:"-45deg"}})]})})]}),e.jsx(Z,{onClick:()=>i("/hub"),children:"Hub"})]})]})}export{he as G};
