import{j as e,r as d,aI as G,f as w,aJ as f,y as E,e as O,aK as T,T as n,M as R,B as j,b2 as M,aD as B,fS as k,aG as P,bC as W,bk as H,v as _,bi as F}from"./index-D0BhaS2b.js";import{H as L,n as q,u as z,S as D,P as Y,d as J,i as U,e as V}from"./StepSwitcher-BPc9cUeg.js";import{T as $}from"./TheEndIcon-CW1sfF5D.js";import{u as C}from"./useBlurCards-DsXPFWct.js";import{A as K}from"./Avatar-CzVOXExk.js";import{G as Q}from"./GameBanner-BAIEYEts.js";import{I as X}from"./Instruction-xp-_UA7l.js";import{u as Z}from"./Game-CBAsIsG-.js";import{F as ee}from"./speech-CUhi38s6.js";import{R as ae}from"./StarFilled-Bxg0rY4_.js";import{R as ne,a as se}from"./ArrowRightOutlined-tJeliEi6.js";import{P as N}from"./progress-vmXK0nnc.js";function oe({onClick:a,children:s,...o}){return e.jsx(L,{children:e.jsx(q,{onClick:a,...o,children:s})})}const{TextArea:re}=R;function te({customText:a}){const[s,o]=d.useState(!1);return s?e.jsx(e.Fragment,{}):e.jsx(ee,{content:e.jsx(ie,{customText:a,hideWidget:s,setHideWidget:o}),type:"popover",icon:e.jsx(ae,{}),position:3,open:!0})}function ie({customText:a,hideWidget:s,setHideWidget:o}){const{gameId:u}=Z(),{isLoading:i}=G(),{translate:r}=w(),[g]=f("userId"),{isAdmin:c}=E(),[x]=f("isAdminEnabled"),[t,l]=d.useState(0),[h,m]=d.useState(""),[v,y]=d.useState(!1),{start:A}=C({duration:3,onExpire:()=>o(!0),autoStart:!1}),S=z({actionName:"rating",successMessage:r("Obrigado por avaliar o jogo","Thanks for rating the game"),errorMessage:r("Envio de avaliação falhou","Rating submission has failed"),onBeforeCall:()=>y(!0),onAfterCall:A}),b=()=>{S({action:B.RATE_GAME,ratings:{comments:h,gameId:u,playerId:g,ratedAt:Date.now(),rating:t}})};return c&&!x?e.jsx(e.Fragment,{}):e.jsx("div",{className:O("rate-game-widget",v&&"rate-game-widget--thank-you",M(s?"bounceOut":"bounceIn")),children:v?e.jsx(T,{message:r("Obrigado","Thank you"),type:"success",showIcon:!0}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{children:e.jsx(n,{pt:"O que achou do jogo?",en:"Rate this game"})}),e.jsx(ne,{onChange:l}),e.jsx("p",{children:e.jsx(n,{pt:"Comentários",en:"Comments",custom:a})}),e.jsx(re,{onChange:I=>m(I.target.value),disabled:i}),e.jsx(j,{type:"primary",disabled:!t||i,onClick:b,size:"small",children:e.jsx(n,{pt:"Enviar",en:"Send"})}),e.jsx("p",{style:{marginTop:"1rem"},children:e.jsx(j,{ghost:!0,onClick:()=>o(!0),size:"small",children:e.jsx(n,{pt:"Hide",en:"Hide"})})})]})})}const ce="/tardedivertida/assets/game-over-title-C-lDOW8G.svg",p=()=>e.jsx(n,{pt:"Jogo concluído",en:"The game is over"});function le({state:a,children:s,className:o,rateWidgetCustomText:u,announcement:i}){var h;const r=k(),{language:g}=w(),[c,x]=d.useState(!1),t=P();C({duration:15,onExpire:()=>x(!0)});const l=!!a.winners&&a.winners.length>0||!!a.group||!!a.team;return e.jsxs(D,{className:o,announcement:i,fullWidth:!0,children:[e.jsx("div",{className:"game-over__banner",children:e.jsx(Q,{gameName:r.gameName,width:400,title:r.title,stripWidth:window.innerWidth-16,showLogo:c,children:!c&&e.jsx(W.img,{src:ce,alt:"Game Over",className:"game-over__title",style:{width:400,transform:"translate(-50%, -50%)"},initial:{opacity:0,scale:.5,transform:"translate(-50%, -50%)"},animate:{opacity:1,scale:1,transform:"translate(-50%, -50%)"},transition:{delay:4,duration:2},exit:{opacity:0,scale:0,transform:"translate(-50%, -50%)"}})})}),l&&((h=a==null?void 0:a.group)==null?void 0:h.outcome)!=="NON_WINNABLE_GAME"&&e.jsxs(X,{contained:!0,children:[!!a.winners&&a.winners.length>0&&e.jsxs("div",{className:"game-over__winner-container",children:[e.jsxs("div",{className:"game-over__text",children:[e.jsx(p,{})," ",a.winners.length>1?e.jsx(n,{pt:"e os vencedores são",en:"and the winners are"}):e.jsx(n,{pt:"e o vencedor é",en:"and the winner is"}),":"]}),e.jsx("ul",{className:"game-over__winners",children:a.winners.map(m=>e.jsxs("li",{className:"game-over__winner",children:[e.jsx(K,{className:"game-over__avatar",id:m.avatarId??25}),e.jsxs("div",{className:"game-over__winner-name",children:[e.jsx("strong",{children:m.name??"?"}),","," ",H[m.avatarId].description[g]]})]},`winner-${m.name}`))})]}),!!a.group&&e.jsxs("div",{className:"game-over__winner",children:[e.jsx("div",{className:"game-over__text",children:e.jsx(p,{})}),e.jsx(N,{type:"circle",strokeColor:a.group.outcome==="WIN"?{"0%":"#4ba226","100%":"#87d068"}:{"0%":"#ff0000","70%":"#ff0000","100%":"#87d068"},percent:Math.round((a.group.score??0)*100/(a.group.goal??1))}),e.jsx("div",{className:"game-over__text",children:a.group.outcome==="WIN"?e.jsx(n,{pt:"Parabéns, vocês ganharam!",en:"Congratulations, you won!"}):e.jsx(n,{pt:"Não foi dessa vez, que vergonha heim!",en:"You lost! What a shame!"})})]}),!!a.team&&e.jsxs("div",{className:"game-over__winner",children:[e.jsx("div",{className:"game-over__text",children:e.jsx(p,{})}),e.jsx(N,{type:"circle",strokeColor:{"0%":"#ff0000","70%":"#ff0000","100%":"#87d068"},percent:a.team.score??0}),e.jsx("div",{className:"game-over__text",children:a.team.victory?e.jsx(n,{pt:"Parabéns, vocês ganharam!",en:"Congratulations, you won!"}):e.jsx(n,{pt:"Não foi dessa vez, que vergonha heim!",en:"You lost! What a shame!"})})]}),!a.winners&&!a.team&&!a.group&&e.jsx("div",{className:"game-over__text",children:e.jsx(p,{})})]}),e.jsx(te,{customText:u}),s,e.jsxs(_,{align:"center",direction:"vertical",className:"full-width padding",style:{marginTop:"48px"},children:[e.jsxs(_.Compact,{children:[e.jsx(j,{onClick:()=>t("/"),children:e.jsx(n,{pt:"Página Inicial",en:"Home Page"})}),e.jsx(j,{children:e.jsxs(F,{to:"/me",target:"_blank",children:[e.jsx(n,{pt:"Meu Perfil",en:"My Profile"})," ",e.jsx(se,{style:{rotate:"-45deg"}})]})})]}),e.jsx(oe,{onClick:()=>t("/hub"),children:"Hub"})]})]})}function we({state:a,players:s,announcementIcon:o=e.jsx($,{}),announcementTitle:u,announcementDuration:i=3,announcementContent:r,children:g=e.jsx(e.Fragment,{}),rateWidgetCustomText:c}){var l;const[x]=d.useState(0),t=e.jsx(Y,{icon:o,title:e.jsx(n,{pt:"E o jogo chegou ao fim...",en:"And the game is over...",custom:u}),currentRound:(l=a==null?void 0:a.round)==null?void 0:l.current,duration:i,type:"overlay",children:!!r&&r});return e.jsx(J,{phase:a==null?void 0:a.phase,allowedPhase:U.DEFAULT.GAME_OVER,className:"game-over__container",children:e.jsx(V,{step:x,players:s,children:e.jsx(le,{state:a,rateWidgetCustomText:c,announcement:t,children:g})})})}export{we as G};
