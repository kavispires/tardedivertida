import{h as B,j as e,T as t,D as K,k as H,aP as re,o as be,b8 as ye,q as ae,cg as ve,n as T,b2 as Y,bI as y,bK as v,e as _,ch as Se,aM as oe,b6 as N,r as f,cp as Ie,ci as te,aQ as Pe,J as _e,bE as Q,x as Z,aO as Ne,b5 as Re,a_ as Te}from"./index-OIjP5zjb.js";import{u as $,a as k,P as W,S as we,f as ne,c as Ce,d as Ee,e as Oe}from"./Session-C_a63xpB.js";import{u as O}from"./useWhichPlayerIsThe-BQyGee7q.js";import{S as Ae,D as De,N as Be,L as ke}from"./SleepIcon-CFB4nocP.js";import{P as c}from"./PlayerAvatarName-DCHlAInW.js";import{S as w,a as F,P as R,W as We,u as ie}from"./StepSwitcher-Gu3IQd6S.js";import{I as j}from"./useDevFeatures-CrW7j0P1.js";import{R as Fe}from"./RoundAnnouncement-CtbWxFr8.js";import{V as Le}from"./ViewOr-Bx1kDirb.js";import{R as Me}from"./WritingIcon-Bdg43pXo.js";import{M as de}from"./MetricHighlight-BH8J33eI.js";import{C as I}from"./CardHighlight-BXdQQypL.js";import{P as qe}from"./PlayerIcon-ICj4w2O0.js";import{P as A}from"./PlayersHighlight-GMBgRxuI.js";import{P as x}from"./PointsHighlight-LcXFpMOx.js";import{R as P}from"./RuleInstruction-BHsw1IEw.js";import{C as le}from"./Card-DUGYAxNb.js";import{D as ze}from"./DreamIcon-BwLvRh0U.js";/* empty css                             */import{I as Ue}from"./ImageCardPreloadHand-jAsME5XL.js";import{I as Ve,a as U}from"./ImageCardHand-CUpJYtHH.js";import{u as Ge}from"./useBooleanDictionary-BfU0V7GK.js";import{u as He}from"./useMock-CHf60lS3.js";import{F as ce}from"./speech-D7Sc-R--.js";import{T as Ye}from"./TextHighlight-B9QvLWcY.js";import{P as me}from"./PopoverRule-D7uzpWfy.js";import{I as C}from"./ImageCard-p8prxAbq.js";import{R as $e}from"./CloseCircleOutlined-C9Iwju_o.js";import{R as he}from"./RobotOutlined-9vhc0EAV.js";import{P as M}from"./PhaseTimerReset-6HdJHA3X.js";import{T as ue}from"./TurnOrder-1nZAEMk_.js";import{m as Je}from"./messageContent-BEtebgzF.js";import{S as q}from"./StarIcon-CADmnGI1.js";import{I as Ke}from"./ImageCardBack-Ba71L7-M.js";import{P as Qe}from"./PlayerAvatar-DGhECgcu.js";import{T as Ze}from"./TimedButton-DernwYlQ.js";import{S as X}from"./StarPoints-CYhtTIPo.js";import{D as pe}from"./index-DyIyxFcy.js";import{R as Xe}from"./RankIcon-A1o3KKfn.js";import{R as es}from"./RoundsLeftInstruction-7gt2_Dbg.js";import{S as ss}from"./StepRankingWrapper-B1TrnF1l.js";import"./GameBanner-DtQTAP_g.js";import{G as rs}from"./GameOverWrapper-CI_1mUh6.js";import{A as as}from"./Achievements-CIfYybcE.js";import{a as os}from"./achievements-D36shYC1.js";import{I as ts}from"./ImageBlurButton-DjgkfIPo.js";import"./Game-PgE2Omjf.js";import"./useMutation-RhryTST9.js";import"./index-CmowX1V7.js";import"./index-BJ9Ja4x0.js";import"./Overflow-l6IdoBsR.js";import"./PurePanel-C7VXrEiM.js";import"./index-BdfDGWRZ.js";import"./index-CscYRTGh.js";import"./DebugOnly-DR7pFWkk.js";import"./RulesModal-BJfvHFid.js";import"./index-BSeIat3e.js";import"./useTDBaseUrl-BF9foKiS.js";import"./index-De9eLZax.js";import"./index-DDK24ygD.js";import"./useBubbleLock-BnfZHkH2.js";import"./InfoCircleOutlined-DYoYV0ML.js";import"./SignIn-D9vUZzL2.js";import"./GoogleIcon-qUxl7Mhc.js";import"./AnimatedGearIcon-ITjSidOr.js";import"./AnimatedClockIcon-C_1jFb0j.js";import"./Loading-BMPzfgkd.js";import"./AnimatedLoaderIcon-BD_61MhF.js";import"./WaitingRoomIcon-DDjbYOO7.js";import"./LikeFilled-DPCVhKRQ.js";import"./PlayersIcon--isszyGj.js";import"./StarFilled-DVFntwFB.js";import"./ImageBlurButtonContainer-sc7BTuuL.js";import"./UpCircleOutlined-K1dlyTWM.js";import"./VideoGameControllerIcon-H0xlYRTY.js";import"./RankingBoard-D4VSYcaz.js";import"./CaretUpOutlined-CyOzHuwu.js";import"./TheEndIcon-C5xWx8Pm.js";import"./ArrowRightOutlined-CWbwVg02.js";import"./progress-DKRDhNDi.js";import"./TitledContainer-Bh1jhVag.js";import"./Medal-z6hQFj3p.js";const g={WORD_SELECTION:"WORD_SELECTION",DREAMS_SELECTION:"DREAMS_SELECTION",CARD_PLAY:"CARD_PLAY",RESOLUTION:"RESOLUTION"},J={SUBMIT_WORD:"SUBMIT_WORD",SUBMIT_CARDS:"SUBMIT_CARDS",PLAY_CARD:"PLAY_CARD"},ns=1,ee=3,V=5,G=6;function is(s){const{translate:r}=B(),a=$({actionName:"submit-word",onBeforeCall:()=>s(3),onError:()=>s(2),successMessage:r("Palavra enviada com sucesso","Word submitted successfully"),errorMessage:r("Vixi, o aplicativo encontrou um erro ao tentar enviar sua palavra","Oops, the application failed to send your word")});return o=>{a({action:J.SUBMIT_WORD,...o})}}function ds(s){const{translate:r}=B(),a=$({actionName:"submit-cards",onBeforeCall:()=>s(2),onError:()=>s(1),successMessage:r("Cartas enviadas com sucesso","Cards submitted successfully"),errorMessage:r("Vixi, o aplicativo encontrou um erro ao tentar enviar suas cartas","Oops, the application failed to send your cards")});return o=>{a({action:J.SUBMIT_CARDS,...o})}}function ls(s){const{translate:r}=B(),a=$({actionName:"play-card",onError:()=>s(2),successMessage:r("Carta enviada com sucesso","Card submitted successfully"),errorMessage:r("Vixi, o aplicativo encontrou um erro ao tentar enviar sua carta","Oops, the application failed to send your card")});return o=>{a({action:J.PLAY_CARD,...o})}}function se({children:s,type:r,iconSize:a,className:o}){return e.jsx(de,{icon:e.jsx(Me,{}),type:r,iconSize:a,className:o,children:s})}function D({children:s,type:r,iconSize:a,className:o}){return e.jsx(de,{icon:e.jsx(qe,{}),type:r,iconSize:a,className:o,children:s})}function cs({scout:s}){return e.jsx(j,{children:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:["Cada rodada tem seu tema... uma palavra.",e.jsx("br",{}),"Para essa rodada, ",e.jsx(c,{player:s,addressUser:!0,size:"small"})," escolherá o tema."]}),en:e.jsxs(e.Fragment,{children:["Every round has a theme... a word.",e.jsx("br",{}),"For this round,",e.jsx(c,{player:s,addressUser:!0,size:"small"})," will choose the theme."]})})})}function ms(){return e.jsx(j,{contained:!0,children:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:["Somos caçadores de sonhos!",e.jsx("br",{}),"Dentro do tema escolhido, podemos visitar os sonhos de até 10 das 15 pessoas (cartas-imagens) disponíveis.",e.jsx("br",{}),"O objetivo é encontrar uns aos outros em cada sonho, então escolha apenas sonhos que você acredita que outros jogadores também irão escolher.",e.jsx("br",{}),"Parece fácil, mas se você escolher um sonho que ninguém mais escolheu... vixi..."]}),en:e.jsxs(e.Fragment,{children:["We are dream scouts!",e.jsx("br",{}),"Given the chosen theme, we can visit dreams of 10 of the 15 people (image cards) available.",e.jsx("br",{}),"The goal of the game is to match the same visited dreams of other players, therefore choose dreams that you think other players will also choose.",e.jsx("br",{}),"It seems easy, but if you choose a dream that nobody else has chosen... well..."]})})})}function xe({contained:s=!1,minimumSelection:r=1}){const a=e.jsx(t,{pt:e.jsxs(e.Fragment,{children:["Selecione sonhos (cartas) que você acha que se relacionam com a palavra-tema da rodada.",r>1&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{style:{fontWeight:"bold",color:"#6052a8"},children:"Uau! No modo surpresa, o mínimo de cartas é bem maior!"})]}),e.jsx("br",{}),"Você deve selecionar pelo menos ",e.jsx(I,{children:r})," e no máximo"," ",e.jsx(I,{children:"10"}),"."]}),en:e.jsxs(e.Fragment,{children:["Now select dreams (cards) that you think match the round's theme.",e.jsx("br",{}),r>1&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{style:{fontWeight:"bold",color:"#6052a8"},children:"Wow! In the surprise mode, the minimum selection is much higher!"})]}),e.jsx("br",{}),"You must select at least ",e.jsx(I,{children:r})," card and a maximum of"," ",e.jsx(I,{children:"10"}),"."]})});return s?e.jsx(P,{type:"action",children:a}):e.jsx(j,{children:a})}function hs(){return e.jsx(j,{contained:!0,children:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:["Na próxima fase, de um a um, cada jogador vai escolher um de seus sonhos visitados.",e.jsx("br",{}),"Se pelo menos um jogador visitou o mesmo sonho, eles ganham pontos. Se ninguém escolheu, o jogador está fora da rodada!",e.jsx("br",{}),"Dai passa-se a vez para o próximo jogador!",e.jsx("br",{}),"Sonhos só podem ser escolhidos uma vez por rodada..."]}),en:e.jsxs(e.Fragment,{children:["On the next phase, one by one, each player will select one of their visited dreams.",e.jsx("br",{}),"If at least one other player visited the same dream, they get points! If nobody visited the same dream, you are out of the round!",e.jsx("br",{}),"Each dream can be chosen once per round only..."]})})})}function je(){return e.jsx(j,{children:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:["De um em um, cada jogador vai escolher um de seus sonhos visitados se você ainda tem algum disponível.",e.jsx("br",{}),"Selecione o sonho que você mais acha que tem chance de outro jogador ter também visitado.",e.jsx("br",{}),"Você ganha ",e.jsx(x,{type:"positive",children:"3"})," pontos se apenas mais"," ",e.jsx(D,{children:"1"})," jogador visitou o mesmo sonho.",e.jsx("br",{}),"Você ganha ",e.jsx(x,{type:"positive",children:"2"})," pontos se mais de"," ",e.jsx(A,{children:"1+"})," jogador visitou o mesmo sonho.",e.jsx("br",{}),"Você está eliminado da rodada se ninguém mais visitou o sonho escolhido."]}),en:e.jsxs(e.Fragment,{children:["One by one, each player chooses one of their visited dreams, if you have any still available.",e.jsx("br",{}),"Select the dream you think you have the most chances of matching another player.",e.jsx("br",{}),"You get ",e.jsx(x,{type:"positive",children:"3"})," points if only"," ",e.jsx(D,{children:"1"})," player visited the same dream.",e.jsx("br",{}),"You get ",e.jsx(x,{type:"positive",children:"2"})," points if many"," ",e.jsx(A,{children:"1+"})," players have visited the same dream.",e.jsx("br",{}),"You are eliminated for this round if nobody else has visited the chosen dream."]})})})}function ge(){return e.jsx(j,{contained:!0,children:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:["Em um jogo com bots, ",e.jsx(se,{children:"3"})," jogadores-robôs são adicionados ao jogo.",e.jsx("br",{}),"Antes da fase do Bingo dos Sonhos, os três bots entram em ação e selecionam cartas segundo se seguinte lógica:",e.jsx("br",{}),"O bot A seleciona todas as cartas que foram mais selecionadas pelos jogadores.",e.jsx("br",{}),"O bot B seleciona cartas que foram selecionadas por apenas um jogador, mas apenas uma por jogador, e somente se mais de um jogador tiver essa carta extra.",e.jsx("br",{}),"O bot C simplesmente seleciona 4 cartas aleatórias."]}),en:e.jsxs(e.Fragment,{children:["In a game with bots, the ",e.jsx(se,{children:"3"})," bots are added to the game.",e.jsx("br",{}),"Before the Dream Bingo phase, the three bots select cards based on a pre-determined logic:",e.jsx("br",{}),"Bot A select all most visited cards.",e.jsx("br",{}),"Bot B select all cards that got a single player visiting them but only one per player and only if more than one player will have a match this way.",e.jsx("br",{}),"Bot C simply selects 4 random cards."]})})})}function us({round:s}){const r={1:{pt:"3ª",en:"3rd"},2:{pt:"2ª",en:"2nd"},3:{pt:"1ª",en:"1st"}};return s.current>3?null:e.jsx(P,{type:"event",children:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Atenção!"})," A ",e.jsx(K,{children:r[s.current]})," linha de cartas sera trocada para a próxima rodada."]}),en:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Attention!"})," The ",e.jsx(K,{children:r[s.current]})," row of cards will be swapped for the next round."]})})})}function ps({onSubmitWord:s,words:r}){return e.jsxs(w,{fullWidth:!0,children:[e.jsx(H,{children:e.jsx(t,{pt:"Selecione o tema da rodada",en:"Select the theme for the round"})}),e.jsx(P,{type:"rule",children:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Clique"})," em uma das palavras abaixo para selecionar.",e.jsx("br",{}),"A carta que você não escolher ficará para a próxima rodada."]}),en:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Click"})," on one of the words below to select.",e.jsx("br",{}),"The card you don't choose will stay in the pool for the next round."]})})}),e.jsx(re,{children:r.map((a,o)=>e.jsx(be,{onClick:()=>s({wordId:a.id}),children:e.jsx(le,{header:ye[o],color:"purple",children:a.text})},a.id))})]})}function xs({state:s,players:r}){const{step:a,goToNextStep:o,setStep:i}=k(),[d,n]=O("scoutId",s,r),l=is(i);return e.jsx(W,{phase:s?.phase,allowedPhase:g.WORD_SELECTION,children:e.jsxs(F,{step:a,players:r,waitingRoom:{type:"SERVER"},children:[e.jsx(Fe,{round:s?.round,onPressButton:o,buttonText:" ",time:5,children:e.jsx(j,{contained:!0,children:e.jsx(t,{pt:"Somos caçadores de sonhos tentando encontrar uns aos outros...",en:"We're dream scouts trying to find each other..."})})}),e.jsx(R,{icon:e.jsx(Ae,{}),title:e.jsx(t,{pt:"Tema dos Sonhos",en:"The Dream Theme"}),onClose:o,currentRound:s?.round?.current,type:"block",children:e.jsx(cs,{scout:d})}),e.jsxs(Le,{condition:n,children:[e.jsx(ps,{onSubmitWord:l,words:s.words}),e.jsx(We,{players:r,title:e.jsx(t,{pt:"Aguarde...",en:"Please wait..."}),instruction:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:d})," está escolhendo o tema."]}),en:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:d})," is choosing the theme."]})}),children:e.jsx(ms,{})})]})]})})}function js({user:s}){if(!s.cards)return null;const r=Object.values(s.cards??{}).map(a=>a.cardId);return e.jsx(Ve,{hand:r,sizeRatio:16})}const gs=(s,r)=>{const a=ae.sample([[2,11,6,8,9,3,13],[2,11,8,4,9,3,13],[2,6,1,5,9,3,13]]),i=ve(r===4?[4,4,4,4,5,6]:[2,3,3,3,3,4,4,5,6])[0];return a.slice(0,i).map(n=>s[n].id)};function fs({table:s,onSelectCard:r,selectedCards:a}){const o=T(5,{gap:8,minWidth:140,maxWidth:150});return e.jsx("div",{className:"g-table-container",children:e.jsx(Y.PreviewGroup,{children:e.jsx("ul",{className:"g-table",children:s.map((i,d)=>{const n=a[i.id];return e.jsx(y.li,{className:"g-table-item",style:{width:`${o+8}px`},...v("flipInY",{delay:d*.25}),children:e.jsx(U,{cardId:i.id,onClick:()=>r(i.id),throttle:!0,over:!0,buttonPosition:"bottom",icon:n?e.jsx($e,{}):void 0,buttonText:n?e.jsx(t,{pt:"Desmarcar",en:"Deselect"}):e.jsx(t,{pt:"Selecionar",en:"Select"}),children:e.jsx(C,{cardId:i.id,cardWidth:o-G,className:_("g-table-image",n&&"g-table-image--selected")})})},`g-table-${i.id}`)})})})})}const bs=s=>Object.keys(s).length<10;function ys({table:s,word:r,onSubmitCards:a,botEnabled:o,announcement:i,minimumSelection:d}){const{dict:n,updateDict:l,length:m}=Ge({},bs);return He(()=>{a({cardsIds:gs(s,d)})},[]),e.jsxs(w,{fullWidth:!0,announcement:i,children:[e.jsxs(H,{size:"medium",children:[e.jsx(t,{pt:"Visite sonhos relacionados a ",en:"Visit dreams related to "}),e.jsx(Ye,{children:r.text})]}),e.jsx(xe,{contained:!0,minimumSelection:d}),e.jsx(me,{content:e.jsx(hs,{})}),o&&e.jsx(ce,{type:"popover",position:1,icon:e.jsx(he,{}),content:e.jsx(ge,{}),label:e.jsx(t,{pt:" Bots",en:" Bots"})}),e.jsx(re,{children:e.jsx(Se,{size:"large",disabled:m<d||m>10,onClick:()=>a({cardsIds:Object.keys(n)}),children:e.jsx(t,{pt:`Visitar ${m} sonhos`,en:`Visit ${m} dreams`})})}),e.jsx(fs,{table:s,onSelectCard:l,selectedCards:n})]})}function vs({state:s,players:r,meta:a,user:o}){const{step:i,setStep:d}=k(),n=ds(d),l=e.jsxs(R,{icon:e.jsx(ze,{}),title:e.jsx(t,{pt:"Visite sonhos!",en:"Visit dreams!"}),currentRound:s?.round?.current,type:"overlay",children:[e.jsx(xe,{minimumSelection:s.minimumSelection}),e.jsx(Ue,{hand:s.table.map(m=>m.id)})]});return e.jsx(W,{phase:s?.phase,allowedPhase:g.DREAMS_SELECTION,children:e.jsx(F,{step:i,players:r,waitingRoom:{content:e.jsx(js,{user:o})},children:e.jsx(ys,{table:s.table,word:s.word,onSubmitCards:n,botEnabled:!!a.options?.withBots,minimumSelection:s.minimumSelection,announcement:l})})})}function Ss({table:s,onPlayCard:r,userCards:a,isPlayAvailable:o}){const{isLoading:i}=oe(),d=T(5,{gap:8,minWidth:140,maxWidth:150});return e.jsx(Y.PreviewGroup,{children:e.jsx("div",{className:"g-table-container",children:e.jsx("ul",{className:"g-table",children:s.map((n,l)=>{const m=!!a?.[n.id],u=a[n.id]??{};return n.used?e.jsx(y.li,{className:"g-table-item",style:{width:`${d+8}px`},...v("fadeIn",{delay:l*.1}),children:e.jsxs(U,{cardId:n.id,onClick:()=>r(n.id),over:!0,buttonPosition:"bottom",hideButton:!0,children:[e.jsx(Ke,{cardWidth:d-G,className:_("g-table-image",m&&"g-table-image--selected",N("zoomIn")),previewImageId:n.id}),u.used&&e.jsxs("div",{className:"g-star-points",children:[e.jsx(y.div,{...v("zoomIn",{delay:s.length*.1,duration:.4}),children:u.score===3&&e.jsx(q,{className:"g-star g-star--super-spark"})}),e.jsx(y.div,{...v("zoomIn",{delay:s.length*.1,duration:.3}),children:u.score>1&&e.jsx(q,{className:"g-star g-star--spark"})}),e.jsx(y.div,{...v("zoomIn",{delay:s.length*.1,duration:.2}),children:u.score>0&&e.jsx(q,{className:"g-star g-star--spark"})})]})]})},`g-table-${n.id}`):e.jsx(y.li,{className:"g-table-item",style:{width:`${d+8}px`},...v("fadeIn",{delay:l*.1}),children:e.jsx(U,{cardId:n.id,onClick:()=>r(n.id),over:!0,buttonPosition:"bottom",hideButton:!o||!a[n.id],buttonText:e.jsx(t,{pt:"Selecionar",en:"Select"}),disabled:i,throttle:!0,children:e.jsx(C,{cardId:n.id,cardWidth:d-G,className:_("g-table-image",m&&"g-table-image--selected")})})},`g-table-${n.id}`)})})})})}function Is({players:s,playerInNightmareId:r}){const a=f.useMemo(()=>Ie(s),[s]);return e.jsxs("div",{className:"g-players-dreams-count",children:[e.jsx("header",{className:"g-players-dreams-count__title",children:e.jsx(t,{en:"Player Dream Count",pt:"Sonhos por Jogador"})}),e.jsx("ul",{className:"g-players-dreams-count__players",children:a.map(o=>{const d=Object.values(o.cards).filter(m=>!m.used),n=o.id===r,l=n&&!o.fallen&&d.length>0;return e.jsx("span",{className:_("g-players-dreams-count__player",n&&!o.fallen&&`g-players-dreams-count__player--nightmare ${N("pulse",{speed:"faster",repeat:3})}`),style:{backgroundColor:te(o.avatarId)},children:e.jsxs(Pe,{title:l?e.jsxs("div",{className:N("tada",{speed:"fast",infinite:!0}),children:[o.name," ",e.jsx(t,{pt:"tá em pesadelo!",en:"is in a nightmare"})]}):void 0,color:"black",placement:"bottom",open:l,children:[e.jsx(Qe,{shape:"square",avatarId:o.avatarId,alt:o.name}),e.jsx("div",{className:_("g-players-dreams-count__count",o.fallen&&"g-players-dreams-count__count--fallen"),children:d.length})]})},`player-dream-count-${o.id}`)})})]})}function Ps({table:s,word:r,onPlayCard:a,user:o,activePlayer:i,isActivePlayer:d,isLoading:n,players:l,gameOrder:m,setLastTurnCount:u,playerInNightmareId:S,botEnabled:h=!1}){const{message:b}=_e.useApp();ie();const{translate:p}=B(),[E,L]=f.useState(!1);return f.useEffect(()=>{u(i.id)}),f.useEffect(()=>{d&&!n&&!E&&(b.info(Je(p("Você controla!","You control!"),p("Selecione a carta-sonho que você acha que vai dar match com pelo menos um jogador!","Select the dream card you think will match at least one player"),i.id,3)),L(!0))},[d,i.id,p,n,E,b]),e.jsxs(w,{fullWidth:!0,children:[e.jsx(we,{size:"small",children:e.jsx(t,{pt:"Bingo dos Sonhos",en:"Dream Bingo"})}),e.jsx(le,{header:p("Tema","Theme"),color:"purple",children:r.text}),e.jsx(Is,{players:l,playerInNightmareId:S}),!!o.fallen&&!!o.inNightmare&&e.jsx(P,{type:"event",children:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:["Você estava em apuros e não conseguiu dar match em uma de suas cartas, então perdeu"," ",e.jsx(x,{type:"negative",children:"1 ponto"})," por carta que você deu match."]}),en:e.jsxs(e.Fragment,{children:["You were in danger and didn't get a match in one of your cards. You lost"," ",e.jsx(x,{type:"negative",children:"1 point"})," per scored card."]})})}),!!o.fallen&&!o.inNightmare&&e.jsx(P,{type:"event",children:e.jsx(t,{pt:e.jsx(e.Fragment,{children:"Você não conseguiu dar match em uma de suas cartas, e está fora da rodada."}),en:e.jsx(e.Fragment,{children:"You didn't get a match in one of your cards, and you're out of the round."})})}),e.jsx(P,{type:d?"action":"wait",children:d?e.jsx(t,{pt:"Selecione a carta-sonho que você acha que vai dar match com pelo menos um jogador!",en:"Select the dream card you think will match at least one player"}):e.jsx(t,{pt:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:i,className:N("flash")})," está selecionando um sonho."]}),en:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:i,className:N("flash")})," is selecting a dream."]})})}),e.jsx(me,{content:e.jsx(je,{})}),h&&e.jsx(ce,{type:"popover",position:1,icon:e.jsx(he,{}),content:e.jsx(ge,{}),label:e.jsx(t,{pt:" Bots",en:" Bots"})}),e.jsx(Ss,{table:s,onPlayCard:fe=>a({cardId:fe}),userCards:o.cards??{},isPlayAvailable:d}),e.jsx(ue,{players:l,order:m,activePlayerId:i.id})]})}function z({listPlayers:s,className:r}){return e.jsx("ul",{className:r,children:s.map(a=>e.jsx("li",{children:e.jsx(c,{player:a,addressUser:!0})},`${r}-${a.id}`))})}function _s(){return e.jsxs("div",{className:"fireworks",children:[e.jsx("div",{className:"fireworks__before"}),e.jsx("div",{className:"fireworks__after"})]})}function Ns({matchCount:s,lastActivePlayer:r,playerInNightmare:a}){const o=s>0,i=s===1,d=a?.id===r.id;return e.jsx("div",{className:"match-count-container",children:o?e.jsx(t,{pt:e.jsxs("p",{children:["E encontrou"," ",s>1?e.jsx(A,{children:s}):e.jsx(D,{children:s})," ",Q(s,"jogador")," lá!",e.jsx("br",{}),i&&"Brilho total!",e.jsx(X,{keyPrefix:"dream-result",quantity:i?3:2})]}),en:e.jsxs("p",{children:["And met"," ",s>1?e.jsx(A,{children:s}):e.jsx(D,{children:s})," ",Q(s,"player")," there!",e.jsx("br",{}),i&&"Super Spark!",i&&e.jsx(_s,{}),e.jsx(X,{keyPrefix:"dream-result",quantity:i?3:2})]})}):e.jsx(t,{pt:e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"g-announce-title",children:"Vixi..."}),e.jsxs("p",{children:["Não sei o que dizer... Ninguém visitou esse sonho e"," ",e.jsx(c,{player:r,size:"small",addressUser:!0})," está fora da rodada.",e.jsx("br",{}),e.jsx("small",{children:"(as cartas restantes ainda contarão pontos para outros jogadores)"})," ",d&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"Para piorar, ",e.jsx(c,{player:r,size:"small",addressUser:!0})," vai perder ",e.jsx(x,{type:"negative",children:"1"}),"ponto por sonho usado até então."]})]})]}),en:e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"g-announce-title",children:"Oops..."}),e.jsxs("p",{children:["I don't know what to say... no one has visited this dream and"," ",e.jsx(c,{player:r,size:"small",addressUser:!0})," is/are out of the round.",e.jsx("br",{}),e.jsx("small",{children:"(the remaining cards will still count towards scoring for other players)"}),d&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"To make this worse,"," ",e.jsx(c,{player:r,size:"small",addressUser:!0})," will lose"," ",e.jsx(x,{type:"negative",children:"1"})," point for each scored dream."]})]})]})})})}function Rs({latest:s,lastActivePlayer:r,activePlayer:a,setStep:o,players:i,playerInNightmare:d,gameOrder:n}){ie();const l=T(5,{gap:8,minWidth:140,maxWidth:150}),{matchingPlayers:m,fallenMatchingPlayers:u}=f.useMemo(()=>(s?.matchedPlayers??[]).reduce((h,b)=>{const p=i[b];return p?.fallen?r.id!==b&&h.fallenMatchingPlayers.push(p):h.matchingPlayers.push(p),h},{matchingPlayers:[],fallenMatchingPlayers:[]}),[s?.matchedPlayers,i,r.id]),S=Object.values(i).filter(h=>h?.skip||h?.fallen);return e.jsxs(w,{fullWidth:!0,children:[e.jsxs(y.div,{className:"g-dream-result",...v("fadeIn",{speed:"slow"}),children:[e.jsxs("header",{className:"g-dream-result__header",style:{backgroundColor:te(r.avatarId)},children:[e.jsx(c,{player:r,size:"large"}),e.jsx(t,{pt:"escolheu visitar o sonho",en:"chose to visit the dream"}),":"]}),e.jsx("div",{className:"g-dream-result__card",children:e.jsx(C,{cardId:s.cardId,cardWidth:l})}),e.jsx("div",{className:"g-dream-result__match-result",children:e.jsx(Ns,{matchCount:s.matchCount,lastActivePlayer:r,playerInNightmare:d})}),e.jsx("div",{className:"g-dream-result__matching-players",children:m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx(t,{pt:"Ganharam pontos:",en:"Scored points:"})}),e.jsx(z,{listPlayers:m,className:"g-dream-result__matched-players-list"})]})}),e.jsx("div",{className:"g-dream-result__fallen-matching-players",children:u.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"g-dream-result__label",children:e.jsx(t,{pt:"Ganhariam pontos, mas já estão eliminados:",en:"Matched but are out of the round:"})}),e.jsx(z,{listPlayers:u,className:"g-dream-result__matched-players-list fallen"})]})}),e.jsxs("footer",{className:"g-dream-result__footer",children:[s.isPhaseOver||s.cardsLeft===0?e.jsxs(Z,{align:"center",className:"full-width padding",direction:"vertical",children:[e.jsx("p",{className:"center",children:e.jsx(t,{pt:"Todos jogadores já usaram seus sonhos ou não deram match com ninguém. Vamos para a próxima rodada?",en:"All players have used their dreams or didn't match anybody. Ready for the next round?"})}),n.length===1&&e.jsx(Ne,{className:"center",type:"error",message:d?.id===n[0]?e.jsx(t,{pt:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:d})," foi ganancioso(a) não conseguiu usar todos os sonhos."]}),en:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:d})," was too greedy and wasn't able to use of all their dreams."]})}):e.jsx(t,{pt:e.jsxs(e.Fragment,{children:["Não há mais jogadores pra dar match com"," ",e.jsx(c,{player:i[n[0]]})]}),en:e.jsxs(e.Fragment,{children:["There are no players to match anymore with"," ",e.jsx(c,{player:i[n[0]]})]})})})]}):e.jsxs(Z,{align:"center",className:"full-width padding",direction:"vertical",children:[e.jsxs("p",{className:"center",children:[e.jsx(t,{pt:"Próximo jogador:",en:"Next player:"}),e.jsx(c,{player:a,addressUser:!0})]}),e.jsx(Ze,{type:"primary",duration:12,disabled:!0,onExpire:()=>o(V),children:e.jsx(t,{pt:"Continuando em...",en:"Continuing in..."})})]}),S.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(pe,{}),e.jsxs("div",{className:"g-dream-result__completed-players",children:[e.jsxs("p",{className:"g-dream-result__label center",children:[e.jsx(t,{pt:"Jogadores fora do rodízio",en:"Players out of rotation"}),":"]}),e.jsx(z,{listPlayers:S,className:"g-dream-result__matched-players-list g-dream-result__matched-players-list--centered"})]})]})]})]}),n.length>1&&e.jsx(ue,{players:i,order:n,activePlayerId:a.id}),s.isPhaseOver&&e.jsx(ne,{autoTriggerTime:15,children:"Ranking"})]})}function Ts({state:s,players:r,meta:a,user:o}){const{isLoading:i}=oe(),{step:d,goToNextStep:n,setStep:l}=k(),[m,u]=O("activePlayerId",s,r),[S]=O("lastActivePlayerId",s,r),[h,b]=O("playerInNightmareId",s,r),[p,E]=f.useState(""),L=ls(l);return f.useEffect(()=>{p&&s.turnCount!==p&&l(ee)},[s.turnCount]),f.useEffect(()=>{s.activePlayerId||l(ee)},[s.activePlayerId,l]),e.jsx(W,{phase:s?.phase,allowedPhase:g.CARD_PLAY,children:e.jsxs(F,{step:d,players:r,children:[e.jsx(R,{icon:e.jsx(De,{}),title:e.jsx(t,{pt:"Hora do Bingo dos Sonhos!",en:"Time for the Dream Bingo!"}),onClose:()=>l(h.id?ns:V),duration:s.round.current<2?20:5,unskippable:!0,type:"block",children:e.jsx(je,{})}),e.jsx(M,{goToNextStep:n}),e.jsx(R,{icon:e.jsx(Be,{}),animationType:"tada",title:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:h,size:"large",addressUser:!0})," entrou em um pesadelo!"]}),en:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:h,size:"large",addressUser:!0})," ",b?"are":"is"," in a nightmare!"]})}),onClose:()=>l(V),currentRound:s?.round?.current,duration:s.round.current<3?10:5,unskippable:!0,type:"block",children:e.jsx(j,{children:e.jsx(t,{pt:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:h,addressUser:!0})," selecionou"," ",e.jsxs(I,{children:[Object.keys(h?.cards??{}).length," cartas"]}),", o maior número de cartas da rodada!",e.jsx("br",{}),"Se ele não conseguir achar outro jogador que marcou o mesmo sonho para cada uma das cartas selecionadas, ele perde ",e.jsx(x,{type:"negative",children:"1"})," ponto por carta que você ganhou ponto.",e.jsx("br",{})]}),en:e.jsxs(e.Fragment,{children:[e.jsx(c,{player:h,addressUser:!0})," selected"," ",e.jsxs(I,{children:[Object.keys(h?.cards??{}).length," cards"]}),", the largest number of cards for this round!",e.jsx("br",{}),"If they are not able to match every single dream, they will lose"," ",e.jsx(x,{type:"negative",children:"1"})," point per card you previously scored.",e.jsx("br",{})]})})})}),e.jsx(M,{goToNextStep:n}),e.jsx(Rs,{latest:s.latest,lastActivePlayer:S,setStep:l,players:r,activePlayer:m,playerInNightmare:h,gameOrder:s.gameOrder}),e.jsx(M,{goToNextStep:n}),e.jsx(Ps,{table:s.table,word:s.word,onPlayCard:L,user:o,activePlayer:m,isActivePlayer:u,players:r,gameOrder:s.gameOrder,isLoading:i,setLastTurnCount:E,playerInNightmareId:s.playerInNightmareId,botEnabled:!!a?.options?.withBots})]})})}function ws({state:s,players:r}){const{step:a,goToNextStep:o}=k();return e.jsx(W,{phase:s?.phase,allowedPhase:g.RESOLUTION,children:e.jsxs(F,{step:a,players:r,waitingRoom:{type:"SERVER"},children:[e.jsx(R,{icon:e.jsx(Xe,{}),title:e.jsx(t,{pt:"Ranking",en:"Ranking"}),onClose:o,currentRound:s?.round?.current,type:"block",duration:3,children:e.jsx(j,{children:e.jsx(t,{pt:"E quem deu mais matches foi...",en:"And who matched the most was..."})})}),e.jsxs(ss,{players:r,ranking:s.ranking,gainedPointsDescriptions:[e.jsx(t,{pt:"Pontos por encontrar só um jogador",en:"Points for matching only 1 player"},"1"),e.jsx(t,{pt:"Pontos por encontrar mais de um jogador",en:"Points for matching with more players"},"2"),e.jsx(t,{pt:"Pontos perdidos por não ter dado match e estar em um pesadelo",en:"Points lost for not matching any player while in a nightmare"},"3")],children:[e.jsx(us,{round:s.round}),e.jsx(es,{round:s.round}),e.jsx(ne,{round:s.round})]})]})})}function Cs({bestMatches:s}){const r=T(8,{gap:8,minWidth:100,maxWidth:150});return e.jsxs(w,{children:[e.jsx(pe,{}),e.jsx(H,{size:"x-small",level:3,children:e.jsx(t,{pt:"Sonhos mais visitados",en:"Most visited dreams"})}),e.jsx("ul",{className:"g-best-matches",children:ae.orderBy(s,"matchedPlayers.length","desc").map((a,o)=>e.jsxs("div",{className:"g-best-matches__entry",children:[e.jsxs("div",{className:"g-best-matches__label",children:[e.jsx(Re,{size:"small",children:a.matchedPlayers.length}),e.jsx("span",{children:a.text})]}),e.jsx(C,{cardId:a.id,cardWidth:r-6})]},`${a.id}-${o}`))})]})}function Es({table:s}){const r=T(12,{gap:8,minWidth:60,maxWidth:100});return e.jsx(Y.PreviewGroup,{children:e.jsx("ul",{className:"g-table g-table--game-over",children:s.map(a=>e.jsxs("li",{className:"g-table-item",style:{width:`${r+8}px`},children:[e.jsx(ts,{cardId:a.id}),e.jsx(C,{cardId:a.id,cardWidth:r-6,className:_("g-table-image",N("zoomIn"))})]},`g-table-${a.id}`))})})}function Os({state:s,players:r}){return e.jsxs(rs,{state:s,players:r,announcementIcon:e.jsx(ke,{}),children:[e.jsx(as,{players:r,achievements:s.achievements,reference:os}),e.jsx(Cs,{bestMatches:s.bestMatches}),e.jsx(Es,{table:s.table})]})}function As(s){switch(s.phase){case g.WORD_SELECTION:return xs;case g.DREAMS_SELECTION:return vs;case g.CARD_PLAY:return Ts;case g.RESOLUTION:return ws;case Oe.DEFAULT.GAME_OVER:return Os;default:return Ee}}function da(){return e.jsx(Ce,{gameCollection:Te.GALERIA_DE_SONHOS,getActiveComponent:As})}export{da as default};
