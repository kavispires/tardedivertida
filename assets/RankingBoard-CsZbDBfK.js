import{r as g,az as B,bp as O,aN as T,n as S,j as a,e as I,aM as h,T as b,b0 as z}from"./index-BHxstxRa.js";import{u as C}from"./useBlurCards-ByGlxzrY.js";import{A as y}from"./Avatar-c6A67G38.js";var F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zM512 734.2c-62.1 0-112.6-50.5-112.6-112.6S449.9 509 512 509s112.6 50.5 112.6 112.6S574.1 734.2 512 734.2zm0-160.9c-26.6 0-48.2 21.6-48.2 48.3 0 26.6 21.6 48.3 48.2 48.3s48.2-21.6 48.2-48.3c0-26.6-21.6-48.3-48.2-48.3z"}}]},name:"crown",theme:"filled"};function k(){return k=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var i=arguments[s];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},k.apply(this,arguments)}const G=(n,s)=>g.createElement(B,k({},n,{ref:s,icon:F})),P=g.forwardRef(G);function L({gainedPoint:n,order:s,description:i}){const r=n>0,t=n<0;return a.jsx("li",{className:I("ranking-board__gained-point",r&&"ranking-board__gained-point--plus",t&&"ranking-board__gained-point--minus",`ranking-board__gained-point--${s}`),children:a.jsxs(h,{title:i??a.jsx(b,{pt:"Pontos ganhos",en:"Gained Points"}),color:r?"gold":t?"red":"gray",children:[r?"+":"",n]})})}function R({gainedPoints:n,playerId:s,gainedPointsDescriptions:i=[]}){const r=Array.isArray(n)?n:[n];return a.jsx("ul",{className:"ranking-board__cell-gained-points",children:r.map((t,d)=>a.jsx(L,{gainedPoint:t,order:d,description:i[d]},`gained-point-${s}-${d}`))})}function J({players:n,ranking:s,gainedPointsDescriptions:i,hideGainedPoints:r=!1,delay:t=0}){const[d,j]=g.useState(0),[f,A]=g.useState([]),[N,E]=g.useState(0),[M,{height:w}]=O(),$=g.useMemo(()=>Math.max(...s.map(m=>m.newScore)),[s]),{seconds:x}=C({duration:5+t,autoStart:!0,onExpire:()=>{E(1),j(3)}});return T(()=>{const m={};let p=0,e=0;const _=S.orderBy(s,["newScore","name"],["desc","asc"]).reduce((c,l,o)=>(c[l.playerId]=o,(e===0||l.newScore<e)&&(e=l.newScore,p+=1),m[l.playerId]=[0,p],c),{}),v=S.orderBy(s,["previousScore","name"],["desc","asc"]);p=0,e=0;const u=v.map((c,l)=>{const o={...c};return o.order=[l,_[o.playerId]],o.position=m[o.playerId],(e===0||c.previousScore<e)&&(e=c.previousScore,p+=1),o.position[0]=p,o});A(u)}),g.useEffect(()=>{x===4+t?j(1):x===2+t&&j(2)},[x,t]),a.jsxs("div",{className:I("ranking-board",x>4&&"ranking-board--hidden",x===4&&z("fadeIn")),style:{height:`${(Math.max(60,w)+8)*f.length}px`},children:[a.jsxs("div",{className:"ranking-board__row",id:"ranking-row-placeholder",style:{opacity:0},ref:M,children:[a.jsx("div",{className:"ranking-board__cell-crown",children:a.jsx(P,{className:"ranking-board__crown-icon"})}),a.jsx("div",{className:"ranking-board__cell-position",children:"#0"}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(y,{id:"A"})}),a.jsx("div",{className:"ranking-board__name",children:"Placeholder"})]}),a.jsx(h,{title:a.jsx(b,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:"0"})}),a.jsx(R,{gainedPoints:0,playerId:"A"}),a.jsx(h,{title:"Total",color:"gold",children:a.jsx("span",{className:"ranking-board__cell-points-total",children:"0"})})]}),f.map((m,p)=>{const{playerId:e,newScore:_,previousScore:v,gainedPoints:u,order:c,position:l}=m,o=(Math.max(60,w)+8)*(c[N]??0);return a.jsxs("div",{className:`ranking-board__row ranking-board__row--${p}`,style:{top:`${o}px`},children:[a.jsx("div",{className:"ranking-board__cell-crown",children:_>0&&$===_&&d>=3&&a.jsx(P,{className:"ranking-board__crown-icon"})}),a.jsxs("div",{className:"ranking-board__cell-position",children:["#",l[N]??""]}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(y,{id:n[e].avatarId})}),a.jsx("div",{className:"ranking-board__name",children:n[e].name})]}),a.jsx(h,{title:a.jsx(b,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:v})}),!r&&d>=1&&u!==void 0&&a.jsx(R,{gainedPoints:u,playerId:e,gainedPointsDescriptions:i}),a.jsx(h,{title:"Total",color:"gold",children:d>=2?a.jsx("span",{className:"ranking-board__cell-points-total",children:_}):a.jsx("span",{className:"ranking-board__cell-points-total-preliminary",children:_})})]},`ranking-${e}`)})]})}export{J as R,P as a};
