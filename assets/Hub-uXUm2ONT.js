import{r as o,$ as zt,a0 as ns,a1 as bt,a2 as kt,a3 as rs,a4 as Je,a5 as os,a6 as Pt,g as ls,m as Wt,a7 as Vt,u as is,a8 as cs,a9 as us,aa as ds,ab as Mt,ac as ms,ad as ps,ae as hs,af as fs,b as gs,c as et,ag as Bt,ah as xs,ai as bs,aj as Rt,ak as Cs,K as Ut,H as ys,al as vs,am as Ss,an as Jt,ao as Xt,j as t,O as ke,T as O,w as js,B as Ct,ap as ws,aq as Ns,f as ct,ar as Is,as as Qe,J as Ts,z as Yt,at as lt,n as _s,au as Os,v as tt,l as qt,y as yt,t as Dt,av as Es,aw as Ls,ax as At,ay as Zt,E as ks,G as Qt,az as Ps,x as Vs,L as Ms,aA as Rs,k as Ds,C as As}from"./index-Dq-8BJP3.js";import{R as Fs,L as $s}from"./LogoutButton-ClZ77IMo.js";import{D as Hs}from"./DevHeader-W-ybbWav.js";import{G as es,R as Gs,a as Ks}from"./RulesModal-CxP5uQtU.js";import{u as zs}from"./useMutation-CURygG-N.js";import{L as Ws}from"./Loading-DfHBlKeA.js";import{I as gt,u as Bs}from"./useDevFeatures-PugzPHkc.js";import{R as Ft}from"./index-C-qhYUMf.js";import{g as Us,C as Js}from"./index-Bxm0NY2A.js";import{u as Xs}from"./useCopyToClipboard-BR-EZCrX.js";import{M as Ys,B as qs,T as Zs}from"./Popconfirm-D0mTG0ml.js";import{D as it}from"./index-DAnpDysA.js";import{C as Le}from"./index-1Bgmvrdz.js";import{u as Qs,B as ea,a as ta,b as sa,c as aa,d as na,D as ra,m as oa,S as la}from"./index-Dqvcpk0E.js";import{T as $t}from"./index-Dqs42mJ0.js";import{c as vt,a as ia,U as ca,T as ua,i as da,g as ma,S as pa}from"./iconUtil-CytQTruI.js";import{g as ha}from"./PurePanel-C1ER4F49.js";import"./index-DyMFGNsK.js";import"./extends-CF3RwP-h.js";import"./useId-BvBTPHfS.js";import"./WritingIcon-BLkiGI5i.js";import"./AnimatedLoaderIcon-YZmxFFPr.js";import"./useSetState-efBPSfPZ.js";import"./index-Dc87Ezdf.js";import"./EllipsisOutlined-DyWo9XZo.js";var fa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v224h704V96c0-17.7-14.3-32-32-32zM288 232c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40-17.9 40-40 40zM160 928c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V704H160v224zm128-136c22.1 0 40 17.9 40 40s-17.9 40-40 40-40-17.9-40-40 17.9-40 40-40zM160 640h704V384H160v256zm128-168c22.1 0 40 17.9 40 40s-17.9 40-40 40-40-17.9-40-40 17.9-40 40-40z"}}]},name:"database",theme:"filled"};function St(){return St=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},St.apply(this,arguments)}const ga=(e,s)=>o.createElement(zt,St({},e,{ref:s,icon:fa})),xa=o.forwardRef(ga);var ba={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"};function jt(){return jt=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},jt.apply(this,arguments)}const Ca=(e,s)=>o.createElement(zt,jt({},e,{ref:s,icon:ba})),ya=o.forwardRef(Ca),va=(e=>{const s=o.useRef({valueLabels:new Map});return o.useMemo(()=>{const{valueLabels:n}=s.current,a=new Map,r=e.map(c=>{const{value:l,label:i}=c,m=i??n.get(l);return a.set(l,m),{...c,label:m}});return s.current.valueLabels=a,[r]},[e])}),Sa=(e,s,n,a)=>o.useMemo(()=>{const r=d=>d.map(({value:g})=>g),c=r(e),l=r(s),i=c.filter(d=>!a[d]);let m=c,u=l;if(n){const d=vt(c,!0,a);m=d.checkedKeys,u=d.halfCheckedKeys}return[Array.from(new Set([...i,...m])),u]},[e,s,n,a]),ja=e=>Array.isArray(e)?e:e!==void 0?[e]:[],wa=e=>{const{label:s,value:n,children:a}=e||{};return{_title:s?[s]:["title","label"],value:n||"value",key:n||"value",children:a||"children"}},wt=e=>!e||e.disabled||e.disableCheckbox||e.checkable===!1,Na=(e,s)=>{const n=[],a=r=>{r.forEach(c=>{const l=c[s.children];l&&(n.push(c[s.value]),a(l))})};return a(e),n},Ht=e=>e==null,Ia=((e,s)=>o.useMemo(()=>ia(e,{fieldNames:s,initWrapper:a=>({...a,valueEntities:new Map}),processEntity:(a,r)=>{const c=a.node[s.value];r.valueEntities.set(c,a)}}),[e,s])),_t=()=>null;function ts(e){return ns(e).map(s=>{if(!o.isValidElement(s)||!s.type)return null;const{key:n,props:{children:a,value:r,...c}}=s,l={key:n,value:r,...c},i=ts(a);return i.length&&(l.children=i),l}).filter(s=>s)}function Nt(e){if(!e)return e;const s={...e};return"props"in s||Object.defineProperty(s,"props",{get(){return bt(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),s}}),s}function Ta(e,s,n,a,r,c){let l=null,i=null;function m(){function u(d,g="0",w=!1){return d.map((x,C)=>{const V=`${g}-${C}`,R=x[c.value],D=n.includes(R),J=u(x[c.children]||[],V,D),v=o.createElement(_t,x,J.map(T=>T.node));if(s===R&&(l=v),D){const T={pos:V,node:v,children:J};return w||i.push(T),T}return null}).filter(x=>x)}i||(i=[],u(a),i.sort(({node:{props:{value:d}}},{node:{props:{value:g}}})=>{const w=n.indexOf(d),x=n.indexOf(g);return w-x}))}Object.defineProperty(e,"triggerNode",{get(){return bt(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),m(),l}}),Object.defineProperty(e,"allCheckedNodes",{get(){return bt(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),m(),r?i:i.map(({node:u})=>u)}})}const _a=(e,s,n)=>{const{fieldNames:a,treeNodeFilterProp:r,filterTreeNode:c}=n,{children:l}=a;return o.useMemo(()=>{if(!s||c===!1)return e;const i=typeof c=="function"?c:(u,d)=>String(d[r]).toUpperCase().includes(s.toUpperCase()),m=(u,d=!1)=>u.reduce((g,w)=>{const x=w[l],C=d||i(s,Nt(w)),V=m(x||[],C);return(C||V.length)&&g.push({...w,isLeaf:void 0,[l]:V}),g},[]);return m(e)},[e,s,l,r,c])};function Gt(e){const s=o.useRef();return s.current=e,o.useCallback((...a)=>s.current(...a),[])}function Oa(e,s){const{id:n,pId:a,rootPId:r}=s,c=new Map,l=[];return e.forEach(i=>{const m=i[n],u={...i,key:i.key||m};c.set(m,u)}),c.forEach(i=>{const m=i[a],u=c.get(m);u?(u.children=u.children||[],u.children.push(i)):(m===r||r===null)&&l.push(i)}),l}function Ea(e,s,n){return o.useMemo(()=>{if(e){if(n){const a={id:"id",pId:"pId",rootPId:null,...typeof n=="object"?n:{}};return Oa(e,a)}return e}return ts(s)},[s,n,e])}const ss=o.createContext(null),as=o.createContext(null);function It(){return It=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},It.apply(this,arguments)}const La={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},ka=(e,s)=>{const{prefixCls:n,multiple:a,searchValue:r,toggleOpen:c,open:l,notFoundContent:i}=Qs(),{virtual:m,listHeight:u,listItemHeight:d,listItemScrollOffset:g,treeData:w,fieldNames:x,onSelect:C,popupMatchSelectWidth:V,treeExpandAction:R,treeTitleRender:D,onPopupScroll:J,leftMaxCount:v,leafCountOnly:T,valueEntities:te,classNames:A,styles:k}=o.useContext(as),{checkable:G,checkedKeys:_,halfCheckedKeys:se,treeExpandedKeys:K,treeDefaultExpandAll:ae,treeDefaultExpandedKeys:oe,onTreeExpand:E,treeIcon:X,showTreeIcon:le,switcherIcon:Pe,treeLine:Ve,treeNodeFilterProp:Me,loadData:ie,treeLoadedKeys:Y,treeMotion:ce,onTreeLoad:je,keyEntities:we}=o.useContext(ss),q=o.useRef(),z=kt(()=>w,[l,w],(b,p)=>p[0]&&b[1]!==p[1]),Re=o.useMemo(()=>G?{checked:_,halfChecked:se}:null,[G,_,se]);o.useEffect(()=>{l&&!a&&_.length&&q.current?.scrollTo({key:_[0]})},[l]);const W=b=>{b.preventDefault()},ue=(b,p)=>{const{node:h}=p;G&&wt(h)||(C(h.key,{selected:!_.includes(h.key)}),a||c(!1))},[B,De]=o.useState(oe),[de,me]=o.useState(null),Ae=o.useMemo(()=>K?[...K]:r?de:B,[B,de,K,r]),Xe=b=>{De(b),me(b),E&&E(b)},Z=String(r).toLowerCase(),ne=b=>Z?String(b[Me]).toLowerCase().includes(Z):!1;o.useEffect(()=>{r&&me(Na(w,x))},[r]);const[Q,S]=o.useState(()=>new Map);o.useEffect(()=>{v&&S(new Map)},[v]);function Fe(b){const p=b[x.value];if(!Q.has(p)){const h=te.get(p);if((h.children||[]).length===0)Q.set(p,!1);else{const re=h.children.filter(_e=>!_e.node.disabled&&!_e.node.disableCheckbox&&!_.includes(_e.node[x.value])).length;Q.set(p,re>v)}}return Q.get(p)}const ee=rs(b=>{const p=b[x.value];return _.includes(p)||v===null?!1:v<=0?!0:T&&v?Fe(b):!1}),$e=b=>{for(const p of b)if(!(p.disabled||p.selectable===!1)){if(r){if(ne(p))return p}else return p;if(p[x.children]){const h=$e(p[x.children]);if(h)return h}}return null},[Ne,pe]=o.useState(null),F=we[Ne];o.useEffect(()=>{if(!l)return;let b=null;const p=()=>{const h=$e(z);return h?h[x.value]:null};!a&&_.length&&!r?b=_[0]:b=p(),pe(b)},[l,r]),o.useImperativeHandle(s,()=>({scrollTo:q.current?.scrollTo,onKeyDown:b=>{const{which:p}=b;switch(p){case Je.UP:case Je.DOWN:case Je.LEFT:case Je.RIGHT:q.current?.onKeyDown(b);break;case Je.ENTER:{if(F){const h=ee(F.node),{selectable:Ie,value:Te,disabled:re}=F?.node||{};Ie!==!1&&!re&&!h&&ue(null,{node:{key:Ne},selected:!_.includes(Te)})}break}case Je.ESC:c(!1)}},onKeyUp:()=>{}}));const he=kt(()=>!r,[r,K||B],([b],[p,h])=>b!==p&&!!(p||h))?ie:null;if(z.length===0)return o.createElement("div",{role:"listbox",className:`${n}-empty`,onMouseDown:W},i);const $={fieldNames:x};return Y&&($.loadedKeys=Y),Ae&&($.expandedKeys=Ae),o.createElement("div",{onMouseDown:W},F&&l&&o.createElement("span",{style:La,"aria-live":"assertive"},F.node.value),o.createElement(ca.Provider,{value:{nodeDisabled:ee}},o.createElement(ua,It({classNames:A?.popup,styles:k?.popup,ref:q,focusable:!1,prefixCls:`${n}-tree`,treeData:z,height:u,itemHeight:d,itemScrollOffset:g,virtual:m!==!1&&V!==!1,multiple:a,icon:X,showIcon:le,switcherIcon:Pe,showLine:Ve,loadData:he,motion:ce,activeKey:Ne,checkable:G,checkStrictly:!0,checkedKeys:Re,selectedKeys:G?[]:_,defaultExpandAll:ae,titleRender:D},$,{onActiveChange:pe,onSelect:ue,onCheck:ue,onExpand:Xe,onLoad:je,filterTreeNode:ne,expandAction:R,onScroll:J}))))},Pa=o.forwardRef(ka),Ot="SHOW_ALL",Et="SHOW_PARENT",ut="SHOW_CHILD";function Kt(e,s,n,a){const r=new Set(e);return s===ut?e.filter(c=>{const l=n[c];return!l||!l.children||!l.children.some(({node:i})=>r.has(i[a.value]))||!l.children.every(({node:i})=>wt(i)||r.has(i[a.value]))}):s===Et?e.filter(c=>{const l=n[c],i=l?l.parent:null;return!i||wt(i.node)||!r.has(i.key)}):e}function Va(e,s){const{searchValue:n,inputValue:a,onSearch:r,autoClearSearchValue:c,filterTreeNode:l,treeNodeFilterProp:i}=s;return o.useMemo(()=>{const m=typeof e=="object",u={searchValue:n??a,onSearch:r,autoClearSearchValue:c,filterTreeNode:l,treeNodeFilterProp:i,...m?e:{}};return[m?!0:e,u]},[e,n,a,r,c,l,i])}function Tt(){return Tt=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Tt.apply(this,arguments)}function Ma(e){return!e||typeof e!="object"}const Ra=o.forwardRef((e,s)=>{const{id:n,prefixCls:a="rc-tree-select",value:r,defaultValue:c,onChange:l,onSelect:i,onDeselect:m,showSearch:u,searchValue:d,inputValue:g,onSearch:w,autoClearSearchValue:x,filterTreeNode:C,treeNodeFilterProp:V,showCheckedStrategy:R,treeNodeLabelProp:D,multiple:J,treeCheckable:v,treeCheckStrictly:T,labelInValue:te,maxCount:A,fieldNames:k,treeDataSimpleMode:G,treeData:_,children:se,loadData:K,treeLoadedKeys:ae,onTreeLoad:oe,treeDefaultExpandAll:E,treeExpandedKeys:X,treeDefaultExpandedKeys:le,onTreeExpand:Pe,treeExpandAction:Ve,virtual:Me,listHeight:ie=200,listItemHeight:Y=20,listItemScrollOffset:ce=0,onPopupVisibleChange:je,popupMatchSelectWidth:we=!0,treeLine:q,treeIcon:z,showTreeIcon:Re,switcherIcon:W,treeMotion:ue,treeTitleRender:B,onPopupScroll:De,classNames:de,styles:me,...Ae}=e,Xe=os(n),Z=v&&!T,ne=v||T,Q=T||te,S=ne||J,Fe={searchValue:d,inputValue:g,onSearch:w,autoClearSearchValue:x,filterTreeNode:C,treeNodeFilterProp:V},[ee,$e]=Va(u,Fe),{searchValue:Ne,onSearch:pe,autoClearSearchValue:F=!0,filterTreeNode:Ye,treeNodeFilterProp:he="value"}=$e,[$,b]=Pt(c,r),p=o.useMemo(()=>v?R||ut:Ot,[R,v]),h=o.useMemo(()=>wa(k),[JSON.stringify(k)]),[Ie,Te]=Pt("",Ne),re=Ie||"",_e=f=>{Te(f),pe?.(f)},He=Ea(_,se,G),{keyEntities:L,valueEntities:U}=Ia(He,h),Oe=o.useCallback(f=>{const N=[],y=[];return f.forEach(I=>{U.has(I)?y.push(I):N.push(I)}),{missingRawValues:N,existRawValues:y}},[U]),fe=_a(He,re,{fieldNames:h,treeNodeFilterProp:he,filterTreeNode:Ye}),at=o.useCallback(f=>{if(f){if(D)return f[D];const{_title:N}=h;for(let y=0;y<N.length;y+=1){const I=f[N[y]];if(I!==void 0)return I}}},[h,D]),Ee=o.useCallback(f=>ja(f).map(y=>Ma(y)?{value:y}:y),[]),Ge=o.useCallback(f=>Ee(f).map(y=>{let{label:I}=y;const{value:M,halfChecked:j}=y;let H;const P=U.get(M);return P?(I=B?B(P.node):I??at(P.node),H=P.node.disabled):I===void 0&&(I=Ee($).find(Ce=>Ce.value===M).label),{label:I,value:M,halfChecked:j,disabled:H}}),[U,at,Ee,$]),Ke=o.useMemo(()=>Ee($===null?[]:$),[Ee,$]),[ge,nt]=o.useMemo(()=>{const f=[],N=[];return Ke.forEach(y=>{y.halfChecked?N.push(y):f.push(y)}),[f,N]},[Ke]),rt=o.useMemo(()=>ge.map(f=>f.value),[ge]),[xe,ze]=Sa(ge,nt,Z,L),dt=o.useMemo(()=>{const y=Kt(xe,p,L,h).map(j=>L[j]?.node?.[h.value]??j).map(j=>{const H=ge.find(be=>be.value===j),P=te?H?.label:B?.(H);return{value:j,label:P}}),I=Ge(y),M=I[0];return!S&&M&&Ht(M.value)&&Ht(M.label)?[]:I.map(j=>({...j,label:j.label??j.value}))},[h,S,xe,ge,Ge,p,L]),[qe]=va(dt),We=o.useMemo(()=>S&&(p==="SHOW_CHILD"||T||!v)?A:null,[A,S,T,p,v]),Be=Gt((f,N,y)=>{const I=Kt(f,p,L,h);if(We&&I.length>We)return;const M=Ge(f);if(b(M),F&&Te(""),l){let j=f;Z&&(j=I.map(ve=>{const ot=U.get(ve);return ot?ot.node[h.value]:ve}));const{triggerValue:H,selected:P}=N||{triggerValue:void 0,selected:void 0};let be=j;if(T){const ve=nt.filter(ot=>!j.includes(ot.value));be=[...be,...ve]}const Ce=Ge(be),ye={preValue:ge,triggerValue:H};let Ue=!0;(T||y==="selection"&&!P)&&(Ue=!1),Ta(ye,H,f,He,Ue,h),ne?ye.checked=P:ye.selected=P;const Lt=Q?Ce:Ce.map(ve=>ve.value);l(S?Lt:Lt[0],Q?null:Ce.map(ve=>ve.label),ye)}}),Ze=o.useCallback((f,{selected:N,source:y})=>{const M=L[f]?.node,j=M?.[h.value]??f;if(!S)Be([j],{selected:!0,triggerValue:j},"option");else{let H=N?[...rt,j]:xe.filter(P=>P!==j);if(Z){const{missingRawValues:P,existRawValues:be}=Oe(H),Ce=be.map(Ue=>U.get(Ue).key);let ye;N?{checkedKeys:ye}=vt(Ce,!0,L):{checkedKeys:ye}=vt(Ce,{halfCheckedKeys:ze},L),H=[...P,...ye.map(Ue=>L[Ue].node[h.value])]}Be(H,{selected:N,triggerValue:j},y||"option")}N||!S?i?.(j,Nt(M)):m?.(j,Nt(M))},[Oe,U,L,h,S,rt,Be,Z,i,m,xe,ze,A]),mt=o.useCallback(f=>{je&&je(f)},[je]),pt=Gt((f,N)=>{const y=f.map(I=>I.value);if(N.type==="clear"){Be(y,{},"selection");return}N.values.length&&Ze(N.values[0].value,{selected:!1,source:"selection"})}),ht=o.useMemo(()=>({virtual:Me,popupMatchSelectWidth:we,listHeight:ie,listItemHeight:Y,listItemScrollOffset:ce,treeData:fe,fieldNames:h,onSelect:Ze,treeExpandAction:Ve,treeTitleRender:B,onPopupScroll:De,leftMaxCount:A===void 0?null:A-qe.length,leafCountOnly:p==="SHOW_CHILD"&&!T&&!!v,valueEntities:U,classNames:de,styles:me}),[Me,we,ie,Y,ce,fe,h,Ze,Ve,B,De,A,qe.length,p,T,v,U,de,me]),ft=o.useMemo(()=>({checkable:ne,loadData:K,treeLoadedKeys:ae,onTreeLoad:oe,checkedKeys:xe,halfCheckedKeys:ze,treeDefaultExpandAll:E,treeExpandedKeys:X,treeDefaultExpandedKeys:le,onTreeExpand:Pe,treeIcon:z,treeMotion:ue,showTreeIcon:Re,switcherIcon:W,treeLine:q,treeNodeFilterProp:he,keyEntities:L}),[ne,K,ae,oe,xe,ze,E,X,le,Pe,z,ue,Re,W,q,he,L]);return o.createElement(as.Provider,{value:ht},o.createElement(ss.Provider,{value:ft},o.createElement(ea,Tt({ref:s},Ae,{classNames:de,styles:me,id:Xe,prefixCls:a,mode:S?"multiple":void 0,displayValues:qe,onDisplayValuesChange:pt,autoClearSearchValue:F,showSearch:ee,searchValue:re,onSearch:_e,OptionList:Pa,emptyOptions:!He.length,onPopupVisibleChange:mt,popupMatchSelectWidth:we}))))}),st=Ra;st.TreeNode=_t;st.SHOW_ALL=Ot;st.SHOW_PARENT=Et;st.SHOW_CHILD=ut;const Da=e=>{const{componentCls:s,treePrefixCls:n,colorBgElevated:a}=e,r=`.${n}`;return[{[`${s}-dropdown`]:[{padding:`${Vt(e.paddingXS)} ${Vt(e.calc(e.paddingXS).div(2).equal())}`},ma(n,Wt(e,{colorBgContainer:a}),!1),{[r]:{borderRadius:0,[`${r}-list-holder-inner`]:{alignItems:"stretch",[`${r}-treenode`]:{[`${r}-node-content-wrapper`]:{flex:"auto"}}}}},Us(`${n}-checkbox`,e),{"&-rtl":{direction:"rtl",[`${r}-switcher${r}-switcher_close`]:{[`${r}-switcher-icon svg`]:{transform:"rotate(90deg)"}}}}]}]};function Aa(e,s,n){return ls("TreeSelect",a=>{const r=Wt(a,{treePrefixCls:s});return Da(r)},da,{resetFont:!1})(e,n)}const Fa=(e,s)=>{const{prefixCls:n,size:a,disabled:r,bordered:c=!0,style:l,className:i,rootClassName:m,treeCheckable:u,multiple:d,listHeight:g=256,listItemHeight:w,placement:x,notFoundContent:C,switcherIcon:V,treeLine:R,getPopupContainer:D,popupClassName:J,dropdownClassName:v,treeIcon:T=!1,transitionName:te,choiceTransitionName:A="",status:k,treeExpandAction:G,builtinPlacements:_,dropdownMatchSelectWidth:se,popupMatchSelectWidth:K,allowClear:ae,variant:oe,dropdownStyle:E,dropdownRender:X,popupRender:le,onDropdownVisibleChange:Pe,onOpenChange:Ve,tagRender:Me,maxCount:ie,showCheckedStrategy:Y,treeCheckStrictly:ce,styles:je,classNames:we,...q}=e,{getPrefixCls:z,getPopupContainer:Re,direction:W,styles:ue,classNames:B,switcherIcon:De}=is("treeSelect"),{renderEmpty:de,virtual:me,popupMatchSelectWidth:Ae,popupOverflow:Xe}=o.useContext(cs),[,Z]=us(),ne=w??Z?.controlHeightSM+Z?.paddingXXS,Q=z(),S=z("select",n),Fe=z("select-tree",n),ee=z("tree-select",n),{compactSize:$e,compactItemClassnames:Ne}=ds(S,W),pe=Mt(S),F=Mt(ee),[Ye,he]=ta(S,pe);Aa(ee,Fe,F);const[$,b]=ms("treeSelect",oe,c),p=ps(f=>a??$e??f),h=o.useContext(hs),Ie=r??h,{status:Te,hasFeedback:re,isFormItemInput:_e,feedbackIcon:He}=o.useContext(fs),L=Cs(Te,k),U={...e,size:p,disabled:Ie,status:L,variant:$},[Oe,fe]=gs([B,we],[ue,je],{props:U},{popup:{_default:"root"}}),at=et(J||v,`${ee}-dropdown`,{[`${ee}-dropdown-rtl`]:W==="rtl"},m,Oe.root,Oe.popup?.root,he,pe,F,Ye),Ee=sa(le||X),Ge=Ve||Pe,Ke=!!(u||d),ge=o.useMemo(()=>{if(!(ie&&(Y==="SHOW_ALL"&&!ce||Y==="SHOW_PARENT")))return ie},[ie,Y,ce]),nt=aa(e.suffixIcon,e.showArrow),rt=K??se??Ae,{suffixIcon:xe,removeIcon:ze,clearIcon:dt}=na({...q,multiple:Ke,showSuffixIcon:nt,hasFeedback:re,feedbackIcon:He,componentName:"TreeSelect"}),qe=ae===!0?{clearIcon:dt}:ae;let We;C!==void 0?We=C:We=de?.("Select")||o.createElement(ra,{componentName:"Select"});const Be=Bt(q,["suffixIcon","removeIcon","clearIcon","itemIcon","switcherIcon","style"]),Ze=o.useMemo(()=>x!==void 0?x:W==="rtl"?"bottomRight":"bottomLeft",[x,W]),mt=et(!n&&ee,{[`${S}-lg`]:p==="large",[`${S}-sm`]:p==="small",[`${S}-rtl`]:W==="rtl",[`${S}-${$}`]:b,[`${S}-in-form-item`]:_e},xs(S,L,re),Ne,i,m,Oe?.root,he,pe,F,Ye),pt=V??De,ht=f=>o.createElement(pa,{prefixCls:Fe,switcherIcon:pt,treeNodeProps:f,showLine:R}),[ft]=bs("SelectLike",fe.popup?.root?.zIndex);return o.createElement(st,{classNames:Oe,styles:fe,virtual:me,disabled:Ie,...Be,popupMatchSelectWidth:rt,builtinPlacements:oa(_,Xe),ref:s,prefixCls:S,className:mt,style:{...fe?.root,...l},listHeight:g,listItemHeight:ne,treeCheckable:u&&o.createElement("span",{className:`${S}-tree-checkbox-inner`}),treeLine:!!R,suffixIcon:xe,multiple:Ke,placement:Ze,removeIcon:ze,allowClear:qe,switcherIcon:ht,showTreeIcon:T,notFoundContent:We,getPopupContainer:D||Re,treeMotion:null,popupClassName:at,popupStyle:{...fe.root,...fe.popup?.root,zIndex:ft},popupRender:Ee,onPopupVisibleChange:Ge,choiceTransitionName:Rt(Q,"",A),transitionName:Rt(Q,"slide-up",te),treeExpandAction:G,tagRender:Ke?Me:void 0,maxCount:ge,showCheckedStrategy:Y,treeCheckStrictly:ce})},$a=o.forwardRef(Fa),Se=$a,Ha=ha(Se,"popupAlign",e=>Bt(e,["visible"]));Se.TreeNode=_t;Se.SHOW_ALL=Ot;Se.SHOW_PARENT=Et;Se.SHOW_CHILD=ut;Se._InternalPanelDoNotUseOrYouWillBeFired=Ha;function Ga(){const{notification:e}=Ut.useApp(),{currentUser:s}=ys(),[n,a]=o.useState(!1),[r,c]=o.useState({gameId:"",gameName:""}),l=zs({mutationKey:["oldState",r.gameId],mutationFn:async({prevGameId:m,payload:u})=>{const g=(await vs.run({action:Ss.LOAD_GAME,gameId:m})).data;return await Jt.run({gameId:m,gameName:g?.gameName??"",playerId:s.id,action:Xt.FORCE_STATE_PROPERTY,state:u})},onSuccess:async()=>{e.success({title:"Redirect successfully triggered"})},onError:m=>{console.error(m),e.error({title:"Failed to load previous game to continue the redirect",description:JSON.stringify(m.message)})}}),i=async(m,u,d)=>{if(n){e.error({title:"Redirect has failed to trigger"});return}c({gameId:u,gameName:d}),await l.mutateAsync({prevGameId:m,gameName:d,payload:{redirect:{redirectAt:Date.now(),gameId:u,gameName:d}}}),a(!0)};return{isSettingRedirect:l.isPending,startRedirect:i,wasRedirectSuccessful:l.isSuccess}}function Ka({options:e=[],disabled:s,onChangeOptions:n,selectedOptions:a}){return!e||e.length===0?t.jsx("div",{className:"create-game-modal-options create-game-modal-options__no-options",children:t.jsx(ke.Text,{children:t.jsx(O,{pt:"Este jogo não possui customizações",en:"This game does not support customizations"})})}):t.jsxs("div",{className:"create-game-modal-options",children:[t.jsx(ke.Title,{level:5,className:"create-game-modal-options__title",children:t.jsx(O,{pt:"Opções:",en:"Options:"})}),t.jsx("div",{className:"create-game-modal-options__list",children:(e??[]).map(r=>t.jsxs(ke.Paragraph,{className:et("create-game-modal-options__option",r.disabled&&"create-game-modal-options__option--disabled"),children:[t.jsxs("div",{className:"create-game-modal-options__label",children:[t.jsx("span",{children:r.label}),r.kind!=="switch"&&!!r.description&&t.jsx("div",{className:"create-game-modal-options__option-description",children:r.description})]}),r.kind==="switch"&&t.jsx(za,{option:r,disabled:s,onChangeOptions:n,selectedOptions:a}),r.kind==="radio"&&t.jsx(Wa,{option:r,disabled:s,onChangeOptions:n,selectedOptions:a}),r.kind==="checkbox"&&t.jsx(Ba,{option:r,disabled:s,onChangeOptions:n,selectedOptions:a}),r.kind==="switch"&&!!r.description&&t.jsx("span",{className:"create-game-modal-options__option-description",children:r.description})]},`option-${r.label}`))})]})}function za({option:e,disabled:s,onChangeOptions:n,selectedOptions:a}){return t.jsxs(t.Fragment,{children:[t.jsx("span",{className:et("create-game-modal-options__off",!a[e.key]&&"create-game-modal-options--selected"),children:e?.values[0].label??""}),t.jsx(js,{disabled:s||e.disabled,onChange:r=>n(e.key,r)}),t.jsx("span",{className:et("create-game-modal-options__on",a[e.key]&&"create-game-modal-options--selected"),children:e?.values[1].label??""})]})}function Wa({option:e,disabled:s,onChangeOptions:n}){return t.jsx(Ft.Group,{disabled:s||e.disabled,onChange:a=>n(e.key,a.target.value),defaultValue:e.values[0].value,className:"create-game-modal-options__selections",children:e.values.map(a=>t.jsx(Ft,{value:a.value,children:a.label},String(a.value)))})}function Ba({option:e,disabled:s,onChangeOptions:n}){return t.jsx(Js.Group,{disabled:s||e.disabled,onChange:a=>n(e.key,a),className:"create-game-modal-options__selections",options:e.values})}const Ua=(e,s)=>{const n=Date.now(),a=n-1e3*60*60*24;return{...Object.entries(e??{}).reduce((c,[l,i])=>(i>a&&(c[l]=i),c),{}),[s]:n}},Ja=e=>{const s=Object.entries(e).map(([c,l])=>({gameId:c,createdAt:l}));if(s.length<2)return null;const n=tt.orderBy(s,"createdAt","desc"),a=7200*1e3,r=Date.now();return n[1].createdAt-r>a?null:n[1].gameId},Xa=e=>e?.reduce((s,n)=>(n.kind==="switch"&&(s[n.key]=!1),n.kind==="radio"&&(s[n.key]=n.values[0].value),n.kind==="checkbox"&&(s[n.key]=[]),s),{})??{};function Ya({gameInfo:e}){const[s,n]=o.useState(!1);return t.jsxs(t.Fragment,{children:[t.jsx(Ct,{type:"primary",onClick:()=>n(!0),block:!0,disabled:!e.available,children:t.jsx(O,{pt:"Criar",en:"Create"})}),s&&t.jsx(qa,{gameInfo:e,open:s,setOpen:n})]})}function qa({gameInfo:e,open:s,setOpen:n}){const{message:a,notification:r}=Ut.useApp(),c=ws(),{pathname:l}=Ns(),[i,m]=Xs(),{language:u,translate:d}=ct(),{setLoader:g}=Is(),[w,x]=o.useState(!1),[C,V]=o.useState(null),[,R]=Qe("userId"),[,D]=Qe("username"),[,J]=Qe("userAvatarId"),[v,T]=o.useState(Xa(e.options)),[te,A]=Ts("latestGameIds"),k=Ja(te),{startRedirect:G,isSettingRedirect:_,wasRedirectSuccessful:se}=Ga();o.useEffect(()=>{i.value&&C&&a.info(`Copied to clipboard: ${i.value}`)},[i,C,a]);const K=(E,X)=>{T(le=>({...le,[E]:X}))},ae=async()=>{try{g("create",!0),x(!0);const E=await Jt.run({action:Xt.CREATE_GAME,gameName:e.gameName,language:u,options:v,version:e.version});if(E.data.gameId){V(E.data.gameId),R(null),D(""),J(""),A(Ua(te,E.data.gameId));const X=window.location.href.split(l)[0];m(`${X}/${E.data.gameId}`)}}catch(E){r.error({title:d("Aplicativo encontrou um erro ao tentar criar o jogo","The application found an error while trying to create a game",u),description:JSON.stringify(E.message),placement:"bottomLeft"}),console.error(E),n(!1)}finally{x(!1),g("create",!1)}},oe=async()=>{C?c(`/${C}`):a.info(d("Péra! O jogo ainda não foi inicializado.","Wait! The game has not been created"))};return t.jsxs(Ys,{title:`${d("Criando novo jogo","Creating new game")}: ${e.title[u]}`,open:s,onCancel:()=>n(!1),onOk:oe,okButtonProps:{disabled:!C||_},maskClosable:!1,children:[t.jsx(es,{title:e.title,gameName:e.gameName,className:"round-corners",width:256,static:!0}),!C&&t.jsxs(gt,{children:[t.jsx(O,{pt:"Você está criando um jogo em:",en:"You are creating a game in:"})," ",t.jsx(Yt,{})]}),t.jsx(Ka,{options:e.options,disabled:w||!!C,onChangeOptions:K,selectedOptions:v}),t.jsx(it,{}),w&&t.jsxs(t.Fragment,{children:[t.jsx(gt,{children:t.jsx(O,{pt:"O jogo está sendo criado...",en:"The game session is being created"})}),t.jsx(Ws,{message:d("Gerando...","Generating..."),margin:!0})]}),e.version.startsWith("alpha")&&t.jsx(lt,{type:"warning",showIcon:!0,title:t.jsx(O,{pt:"Este jogo está em alpha, não o jogue",en:"This game is still in alpha and shouldn't be played"})}),e.version.startsWith("beta")&&t.jsx(lt,{type:"warning",showIcon:!0,title:t.jsx(O,{pt:"Este jogo está em beta, prossiga com cuidado",en:"This game is in beta and bugs might be everywhere"})}),C?t.jsxs("div",{children:[t.jsxs(_s,{className:"center",children:[t.jsx(O,{pt:"Jogo inicializado",en:"Game Initialized"}),": ",C]}),t.jsxs(gt,{children:[k&&!se&&t.jsx(lt,{type:"info",showIcon:!0,title:t.jsxs(t.Fragment,{children:[t.jsx(O,{pt:t.jsxs(t.Fragment,{children:["Você quer redirecionar jogadores em ",k," para essa nova partida?"]}),en:t.jsxs(t.Fragment,{children:["Redirect players in ",k," to this new play?"]})}),t.jsx(Ct,{size:"large",onClick:()=>{G(k??"",C??"",e.gameName)},disabled:!C||!k,loading:_,children:t.jsx(O,{pt:"Redirecione-os",en:"Redirect them"})})]})}),se&&t.jsx(lt,{type:"info",showIcon:!0,title:t.jsx(O,{pt:t.jsxs(t.Fragment,{children:["Jogadores em ",k," foram convidados para o jogo ",C]}),en:t.jsxs(t.Fragment,{children:["Players in ",k," have been invited to ",C]})})})]})]}):t.jsx(Os,{align:"center",children:t.jsx(Ct,{type:"primary",size:"large",disabled:w,onClick:ae,children:t.jsx(O,{pt:"Criar Jogo",en:"Create Game"})})})]})}const Za=e=>{if(e.includes("dev"))return"#6cb3f6";if(e.includes("alpha"))return"#F97659";if(e.includes("beta"))return"#F9D859";const s=Number(e.split(".")[0]);return Number.isNaN(s)?"#96A0A3":s===0?"#F9D859":s===1?"#72D984":s===2||s>=3?"#7CBD51":"#96A0A3"};function Qa({game:e,isAdmin:s=!0}){const{language:n,translate:a}=ct(),r=qt(e);return t.jsxs(Le,{className:"game-card",cover:t.jsx(qs.Ribbon,{text:e.version,color:Za(e.version),children:t.jsxs("div",{className:"game-card__image",children:[t.jsx(es,{gameName:e.gameName,width:256,title:e.title}),t.jsxs("span",{className:"game-card__title",title:e.title[n],children:[t.jsx("span",{className:"game-card__title-text",children:e.title[n]})," ",t.jsx("span",{children:t.jsx(Es,{title:a("Código do jogo começará com","The game id will start with"),children:t.jsx(Zs,{children:e.gameCode})})})]})]})}),children:[t.jsx("div",{className:"game-card__contents",children:t.jsxs(yt,{orientation:"vertical",className:"full-width",children:[t.jsx(Le.Meta,{description:`${a("Inspirado por","Inspired by")} ${e.inspiredBy.split("").reverse().join("")}`}),t.jsx(Le.Meta,{className:"game-card__description",description:e.summary[n]}),e.rules?.[n]?.length>1&&t.jsx(Gs,{gameInfo:e,buttonProps:{size:"small",className:"game-card__margin-bottom"}}),t.jsx(Ks,{wrap:!0,size:[1,6],style:{display:"flex"},gameCode:e.gameCode,tags:e.tags})]})}),t.jsxs("div",{className:"game-card__actions",children:[e.duration&&t.jsx(Le.Meta,{description:t.jsxs(t.Fragment,{children:[t.jsx(Fs,{})," ",r.min," min - ",r.max," min (Avg: ",r.ideal," min)"]})}),t.jsx(it,{className:"game-card__divider"}),t.jsxs(yt,{orientation:"vertical",children:[t.jsx(Le.Meta,{description:a(`Para ${e.playerCount.min}-${e.playerCount.max} jogadores`,`For ${e.playerCount.min}-${e.playerCount.max} players`)}),t.jsx(Le.Meta,{className:"game-card__player-count",description:a(`Melhor com ${e.playerCount.best||"?"} jogadores`,`Best wih ${e.playerCount.best||"?"} players`)}),t.jsx(Le.Meta,{className:"game-card__player-count game-card__margin-bottom",description:a(`Recomendado jogar com ${Dt(e.playerCount.recommended)}`,`Recommended with ${Dt(e.playerCount.recommended)}`)})]}),s&&t.jsx("div",{style:{marginTop:"1rem"},children:["dev","beta","stable"].includes(e.release)&&t.jsx(Ya,{gameInfo:e})})]})]},e.gameName)}function en(){Bs();const[e,s]=o.useState(!1);return Qe("usingFirestoreEmulator"),Qe("usingFunctionsEmulator"),Ls(()=>{}),null}const{SHOW_PARENT:tn}=Se;function sn({availabilityCount:e,setTagFilters:s,setNumberFilters:n}){const a=(l,i)=>{n(m=>({...m,[l]:i}))},r=l=>{a("recommendedWith",+(l==="recommended")),a("bestWith",+(l==="best"))},c=[{label:"Playing with",value:""},{label:"Recommended with",value:"recommended"},{label:"Best with",value:"best"}];return t.jsxs(yt,{className:"hub-filters",wrap:!0,size:"middle",children:[t.jsxs("span",{children:[t.jsx(ya,{})," (",e,")"]}),t.jsx(la,{defaultValue:"",style:{minWidth:"20ch"},size:"small",onChange:r,options:c}),t.jsxs("div",{className:"hub-filters__entry",children:[t.jsx("label",{htmlFor:"players-input",children:"Players"}),t.jsx($t,{min:2,max:12,size:"small",className:"hub-filters__input-number",onChange:l=>a("players",l??0)})]}),t.jsxs("div",{className:"hub-filters__entry",children:[t.jsx("label",{htmlFor:"duration",children:"Duration"}),t.jsx($t,{min:15,step:15,size:"small",className:"hub-filters__input-number",onChange:l=>a("duration",l??0)})]}),t.jsxs("div",{className:"hub-filters__entry",children:[t.jsx("label",{htmlFor:"tags",children:"Tags"}),t.jsx(an,{value:void 0,onTreeSelectChange:s})]})]})}function an({value:e,onTreeSelectChange:s}){const{dualTranslate:n}=ct(),a=c=>{s(c)},r=o.useMemo(()=>Object.values(Object.keys(At).reduce((c,l)=>{const i=At[l];return c[i.group]===void 0&&(c[i.group]={title:tt.capitalize(i.group),value:i.group,children:[]}),c[i.group].children.push({title:tt.capitalize(n(i.label)),value:`${i.group}${Zt}${l}`}),c},{})),[n]);return t.jsx(Se,{treeData:r,value:e,onChange:a,treeCheckable:!0,showCheckedStrategy:tn,placeholder:"Select Game Tags",size:"small",style:{width:"100%",minWidth:"400px"}})}tt.orderBy(Object.entries(Object.values(Qt).reduce((e,s)=>(e[s.gameCode]===void 0&&(e[s.gameCode]=0),e[s.gameCode]++,e),{})).map(([e,s])=>`${e}: ${s}`));function En(){ks("Hub - Tarde Divertida");const{language:e}=ct(),[s,n]=o.useState([]),[a,r]=o.useState({}),c=o.useMemo(()=>Object.values(Qt).filter(u=>{const d=[];if(a.players&&(d.push(u.playerCount.min<=a.players&&u.playerCount.max>=a.players),a.bestWith&&d.push(a.players===u.playerCount.best),a.recommendedWith&&d.push(u.playerCount.recommended.includes(a.players))),s.forEach(g=>{const[w,x]=g.split(Zt);(w&&x&&Ps?.[w]==="exclusive"||x)&&d.push(u.tags.includes(x))}),a.duration){const g=qt(u,a.players??0);a.players?d.push(a.duration>=g.customTime-10&&a.duration<=g.customTime+10):d.push(a.duration>=g.min&&a.duration<=g.max)}return d.every(Boolean)}),[s,a]),{availableGames:l,comingSoonGames:i,devGames:m}=o.useMemo(()=>tt.orderBy(c,[`title.[${e}]`],["asc"]).reduce((d,g)=>(["stable"].includes(g.release)?d.availableGames.push(g):["dev","beta"].includes(g.release)?d.devGames.push(g):d.comingSoonGames.push(g),d),{availableGames:[],devGames:[],comingSoonGames:[]}),[c,e]);return t.jsxs(Vs,{className:"dev-layout",children:[t.jsx(Hs,{title:t.jsxs(t.Fragment,{children:[t.jsx(xa,{})," Hub"]}),subTitle:t.jsx(O,{pt:"Selecione um jogo para começar",en:"Select a game to start"}),extra:[t.jsx(Yt,{},"language-switch"),t.jsx($s,{danger:!0,ghost:!0,size:"small"},"logout-button")]}),t.jsx(en,{}),t.jsx(sn,{setTagFilters:n,setNumberFilters:r,availabilityCount:l.length}),t.jsxs(Ms.Content,{className:"container",id:"main-container",children:[Rs,t.jsx(ke.Title,{level:2,children:t.jsx(O,{pt:"Disponíveis",en:"Available"})}),t.jsx(xt,{games:l}),t.jsx(it,{}),t.jsxs(t.Fragment,{children:[t.jsx(ke.Title,{level:2,children:t.jsx(O,{pt:"Em Desenvolvimento",en:"Under Development"})}),t.jsx(xt,{games:m}),t.jsx(it,{})]}),t.jsx(ke.Title,{level:2,children:t.jsx(O,{pt:"Em Breve",en:"Coming Soon"})}),t.jsx(xt,{games:i})]})]})}function xt({games:e}){return e.length===0?t.jsx(ke.Text,{type:"secondary",children:t.jsx(O,{pt:"Nenhum jogo encontrado nessa categoria",en:"No games found in this category"})}):t.jsx(Ds,{gutter:[8,16],children:e.map(s=>t.jsx(As,{xs:24,sm:12,md:8,lg:8,xl:6,xxl:4,children:t.jsx(Qa,{game:s,isAdmin:["dev","beta","stable"].includes(s.release)})},s.gameName))})}export{En as default};
