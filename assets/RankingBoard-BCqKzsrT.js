import{r as g,az as O,bp as T,bw as z,aN as C,n as y,j as a,e as A,aM as h,T as k,b0 as D}from"./index-KhnDWtqd.js";import{u as F}from"./useBlurCards-DaCWG4D9.js";import{A as P}from"./Avatar-BS3hQk5-.js";var G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zM512 734.2c-62.1 0-112.6-50.5-112.6-112.6S449.9 509 512 509s112.6 50.5 112.6 112.6S574.1 734.2 512 734.2zm0-160.9c-26.6 0-48.2 21.6-48.2 48.3 0 26.6 21.6 48.3 48.2 48.3s48.2-21.6 48.2-48.3c0-26.6-21.6-48.3-48.2-48.3z"}}]},name:"crown",theme:"filled"};function f(){return f=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var i=arguments[s];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},f.apply(this,arguments)}const L=(n,s)=>g.createElement(O,f({},n,{ref:s,icon:G})),R=g.forwardRef(L);function q({gainedPoint:n,order:s,description:i}){const r=n>0,t=n<0;return a.jsx("li",{className:A("ranking-board__gained-point",r&&"ranking-board__gained-point--plus",t&&"ranking-board__gained-point--minus",`ranking-board__gained-point--${s}`),children:a.jsxs(h,{title:i??a.jsx(k,{pt:"Pontos ganhos",en:"Gained Points"}),color:r?"gold":t?"red":"gray",children:[r?"+":"",n]})})}function I({gainedPoints:n,playerId:s,gainedPointsDescriptions:i=[]}){const r=Array.isArray(n)?n:[n];return a.jsx("ul",{className:"ranking-board__cell-gained-points",children:r.map((t,m)=>a.jsx(q,{gainedPoint:t,order:m,description:i[m]},`gained-point-${s}-${m}`))})}function Q({players:n,ranking:s,gainedPointsDescriptions:i,hideGainedPoints:r=!1,delay:t=0,victoryIndex:m=0}){const[j,v]=g.useState(0),[N,E]=g.useState([]),[w,$]=g.useState(0),[M,{height:S}]=T(),B=g.useMemo(()=>z(s.map(l=>l.newScore).sort((l,c)=>c-l)),[s]),{seconds:_}=F({duration:5+t,autoStart:!0,onExpire:()=>{$(1),v(3)}});return C(()=>{const l={};let c=0,e=0;const x=y.orderBy(s,["newScore","name"],["desc","asc"]).reduce((d,p,o)=>(d[p.playerId]=o,(e===0||p.newScore<e)&&(e=p.newScore,c+=1),l[p.playerId]=[0,c],d),{}),b=y.orderBy(s,["previousScore","name"],["desc","asc"]);c=0,e=0;const u=b.map((d,p)=>{const o={...d};return o.order=[p,x[o.playerId]],o.position=l[o.playerId],(e===0||d.previousScore<e)&&(e=d.previousScore,c+=1),o.position[0]=c,o});E(u)}),g.useEffect(()=>{_===4+t?v(1):_===2+t&&v(2)},[_,t]),a.jsxs("div",{className:A("ranking-board",_>4&&"ranking-board--hidden",_===4&&D("fadeIn")),style:{height:`${(Math.max(60,S)+8)*N.length}px`},children:[a.jsxs("div",{className:"ranking-board__row",id:"ranking-row-placeholder",style:{opacity:0},ref:M,children:[a.jsx("div",{className:"ranking-board__cell-crown",children:a.jsx(R,{className:"ranking-board__crown-icon"})}),a.jsx("div",{className:"ranking-board__cell-position",children:"#0"}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(P,{id:"A"})}),a.jsx("div",{className:"ranking-board__name",children:"Placeholder"})]}),a.jsx(h,{title:a.jsx(k,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:"0"})}),a.jsx(I,{gainedPoints:0,playerId:"A"}),a.jsx(h,{title:"Total",color:"gold",children:a.jsx("span",{className:"ranking-board__cell-points-total",children:"0"})})]}),N.map((l,c)=>{const{playerId:e,newScore:x,previousScore:b,gainedPoints:u,order:d,position:p}=l,o=(Math.max(60,S)+8)*(d[w]??0);return a.jsxs("div",{className:`ranking-board__row ranking-board__row--${c}`,style:{top:`${o}px`},children:[a.jsx("div",{className:"ranking-board__cell-crown",children:B[m]===x&&j>=3&&a.jsx(R,{className:"ranking-board__crown-icon"})}),a.jsxs("div",{className:"ranking-board__cell-position",children:["#",p[w]??""]}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(P,{id:n[e].avatarId})}),a.jsx("div",{className:"ranking-board__name",children:n[e].name})]}),a.jsx(h,{title:a.jsx(k,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:b})}),!r&&j>=1&&u!==void 0&&a.jsx(I,{gainedPoints:u,playerId:e,gainedPointsDescriptions:i}),a.jsx(h,{title:"Total",color:"gold",children:j>=2?a.jsx("span",{className:"ranking-board__cell-points-total",children:x}):a.jsx("span",{className:"ranking-board__cell-points-total-preliminary",children:x})})]},`ranking-${e}`)})]})}export{Q as R,R as a};
