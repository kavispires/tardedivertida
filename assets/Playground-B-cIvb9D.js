import{r as I,$ as M,j as o,h as S,b1 as N,O as R,B as O,v as E,E as $,x as X,L as A}from"./index-BwXlJHSy.js";import{D as Y}from"./DevHeader-B1pOHcrw.js";import{D as _,u as B}from"./core.esm-xzljrT43.js";import{C as H}from"./index-Cpr7Cp1O.js";import{R as F}from"./CheckCircleOutlined-DirZ2_Np.js";import"./index-Dng6mrMp.js";import"./extends-CF3RwP-h.js";import"./useId-qzv95cVB.js";import"./index-BuI1RoVr.js";import"./EllipsisOutlined-BY5EKTun.js";import"./Overflow-Bmfb0t_l.js";import"./PlusOutlined-DNRyaLUR.js";var U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};function D(){return D=Object.assign?Object.assign.bind():function(e){for(var d=1;d<arguments.length;d++){var n=arguments[d];for(var b in n)Object.prototype.hasOwnProperty.call(n,b)&&(e[b]=n[b])}return e},D.apply(this,arguments)}const W=(e,d)=>I.createElement(M,D({},e,{ref:d,icon:U})),Z=I.forwardRef(W),y=50,q=25,K=({data:e,imageUrl:d,totalCols:n,totalRows:b,index:k})=>{const{attributes:v,listeners:l,setNodeRef:j,transform:h,isDragging:f}=B({id:e.id,disabled:e.isLocked,data:{...e}}),z={position:"absolute",left:e.currentPos.x,top:e.currentPos.y,transform:h?`translate3d(${h.x}px, ${h.y}px, 0)`:void 0,zIndex:f?999:e.isLocked?1:10,cursor:e.isLocked?"default":"grab",touchAction:"none"};return o.jsx("div",{ref:j,style:z,...l,...v,children:o.jsx(S.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:f?1.1:1,filter:e.isLocked?"brightness(1)":f?"brightness(1.1)":"brightness(1)"},transition:{duration:.3,delay:e.isLocked?0:k*.05,type:"spring",stiffness:300,damping:20},whileHover:e.isLocked?void 0:{scale:1.05,zIndex:100},whileTap:e.isLocked?void 0:{scale:.95},children:e.shape.map((c,x)=>{const w=-(e.correctPos.x+c.x)*y,t=-(e.correctPos.y+c.y)*y;return o.jsx(S.div,{style:{position:"absolute",left:c.x*y,top:c.y*y,width:y,height:y,backgroundImage:`url(${d})`,backgroundSize:`${n*y}px ${b*y}px`,backgroundPosition:`${w}px ${t}px`,boxSizing:"border-box"},animate:{border:e.isLocked?"0px solid rgba(255,255,255,0)":"1px solid rgba(255,255,255,0.6)",boxShadow:f?"0px 10px 20px rgba(0,0,0,0.3)":e.isLocked?"none":"0px 2px 4px rgba(0,0,0,0.2)"}},x)})})})},V=({data:e,onComplete:d})=>{const[n,b]=I.useState([]),k=I.useRef(null),v=()=>{const c=e.pieces.map(x=>({...x,currentPos:{...x.initialPos},isLocked:x.initialLocked}));b(c)};I.useEffect(()=>{v()},[e]);const l=c=>{const{active:x,delta:w}=c,t=x.id;b(g=>{const r=E.cloneDeep(g),a=r.find(p=>p.id===t);if(!a)return g;let i=a.currentPos.x+w.x,u=a.currentPos.y+w.y;const s=a.correctPos.x*y,m=a.correctPos.y*y;return Math.sqrt((i-s)**2+(u-m)**2)<q&&(i=s,u=m,a.isLocked=!0),a.currentPos={x:i,y:u},r.every(p=>p.isLocked)&&!g.every(p=>p.isLocked)&&d&&d(),r})},j=I.useMemo(()=>n.length>0&&n.every(c=>c.isLocked),[n]),h=e.gridCols*y,f=e.gridRows*y,z=h+300;return o.jsx(H,{title:o.jsx(R.Title,{level:4,style:{margin:0},children:"Puzzle Challenge"}),extra:o.jsx(O,{icon:o.jsx(Z,{}),onClick:v,children:"Reset"}),style:{width:"100%",overflow:"hidden"},bodyStyle:{padding:0,overflowX:"auto"},children:o.jsx(_,{onDragEnd:l,children:o.jsxs("div",{ref:k,style:{position:"relative",width:z,height:f+50,backgroundColor:"#f0f2f5",userSelect:"none",backgroundImage:"radial-gradient(#d9d9d9 1px, transparent 1px)",backgroundSize:"20px 20px"},children:[o.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},style:{position:"absolute",top:0,left:0,width:h,height:f,borderRight:"2px solid #1890ff",borderBottom:"2px solid #1890ff",backgroundColor:"rgba(255,255,255,0.5)",zIndex:0},children:o.jsx("div",{style:{position:"absolute",bottom:10,left:10,color:"#1890ff",opacity:.5,fontWeight:"bold",fontSize:"2rem"},children:"2:3"})}),n.map((c,x)=>o.jsx(K,{index:x,data:c,imageUrl:e.imageUrl,totalCols:e.gridCols,totalRows:e.gridRows},c.id)),o.jsx(N,{children:j&&o.jsxs(S.div,{initial:{opacity:0,backdropFilter:"blur(0px)"},animate:{opacity:1,backdropFilter:"blur(4px)"},exit:{opacity:0},style:{position:"absolute",top:0,left:0,width:h,height:f,backgroundColor:"rgba(255,255,255,0.4)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:1e3},children:[o.jsx(S.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200,damping:15},children:o.jsx(F,{style:{fontSize:80,color:"#52c41a",filter:"drop-shadow(0 4px 6px rgba(0,0,0,0.2))"}})}),o.jsx(S.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:o.jsx(R.Title,{level:2,style:{color:"#52c41a",marginTop:16,textShadow:"0 2px 0px white"},children:"Complete!"})})]})})]})})})},C=50,G=7,J=(e,d=12,n=6)=>{const b=Math.max(9,Math.min(24,d)),k=Math.round(n*1.5),v=[],l=[];let j=0;for(let t=0;t<k;t++){const g=[];for(let r=0;r<n;r++)g.push(j),l.push({id:j,blocks:[{x:r,y:t}]}),j++;v.push(g)}let h=0;for(;l.length>b&&!(h>50);){let t=Number.POSITIVE_INFINITY;l.forEach(i=>{i.blocks.length<t&&(t=i.blocks.length)});const g=l.filter(i=>i.blocks.length===t),r=E.shuffle(g);let a=!1;for(const i of r){const u=new Set;if(i.blocks.forEach(s=>{[{x:s.x+1,y:s.y},{x:s.x-1,y:s.y},{x:s.x,y:s.y+1},{x:s.x,y:s.y-1}].forEach(P=>{if(P.x>=0&&P.x<n&&P.y>=0&&P.y<k){const L=v[P.y][P.x];if(L!==i.id){const p=l.find(T=>T.id===L);p&&i.blocks.length+p.blocks.length<=G&&u.add(L)}}})}),u.size>0){const s=Array.from(u),m=s[E.random(0,s.length-1)],P=l.findIndex(p=>p.id===m),L=l[P];i.blocks=[...i.blocks,...L.blocks],L.blocks.forEach(p=>{v[p.y][p.x]=i.id}),l.splice(P,1),a=!0;break}}if(a)h=0;else if(h++,h>5){const i=E.shuffle(l);for(const u of i);}}const f=l.map((t,g)=>{t.blocks.sort((s,m)=>s.y-m.y||s.x-m.x);const r=t.blocks[0],a=t.blocks.map(s=>({x:s.x-r.x,y:s.y-r.y})),i=n*C+20,u=i+200;return{id:`piece-${g}`,shape:a,correctPos:{x:r.x,y:r.y},initialPos:{x:E.random(i,u),y:E.random(0,k*C-50)},initialLocked:!1}}),z=n/2,c=k/2;let x=-1,w=Number.POSITIVE_INFINITY;if(f.forEach((t,g)=>{let r=0,a=0;t.shape.forEach(m=>{r+=t.correctPos.x+m.x,a+=t.correctPos.y+m.y});const i=r/t.shape.length,u=a/t.shape.length,s=Math.sqrt((i-z)**2+(u-c)**2);s<w&&(w=s,x=g)}),x!==-1){const t=f[x];t.initialPos={x:t.correctPos.x*C,y:t.correctPos.y*C},t.initialLocked=!0}return{imageUrl:e,gridCols:n,gridRows:k,pieces:f}};function xe(){$("Playground | Dev | Tarde Divertida");const[e,d]=I.useState([]),n=I.useMemo(()=>J("https://www.kavispires.com/td-images/images/td/d12/03.jpg",12),[]);return o.jsxs(X,{children:[o.jsx(Y,{title:"Playground"}),o.jsxs(A.Content,{className:"dev-content",children:[o.jsx("div",{children:"playground content"}),o.jsx("div",{style:{padding:20},children:o.jsx(V,{data:n,onComplete:()=>console.log("User finished!")})})]})]})}export{xe as default};
