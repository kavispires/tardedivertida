import{r,$ as q,j as t,O as H,B as G,h as D,b2 as Q,v as O,E as _,x as J,L as K}from"./index-CoVhiA3v.js";import{D as V}from"./DevHeader-CnZPgEOB.js";import{u as Z,a as ee,D as te,P as se,b as oe}from"./core.esm-BIpn27-Z.js";import{t as ne}from"./index-BffssVcp.js";import{C as ie}from"./index-DL_9oK9N.js";import{S as re}from"./index-cxOg2Fuh.js";import{R as ae,g as ce}from"./puzzleUtils-DCOlMLP2.js";import"./index-OsRudsAh.js";import"./extends-CF3RwP-h.js";import"./useId-CS1ROYIv.js";import"./index-B6dJc5M8.js";import"./EllipsisOutlined-DNE0r0TO.js";import"./Overflow-CFbDCDwq.js";import"./PlusOutlined-DYep9iO2.js";var de={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};function T(){return T=Object.assign?Object.assign.bind():function(e){for(var u=1;u<arguments.length;u++){var a=arguments[u];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},T.apply(this,arguments)}const le=(e,u)=>r.createElement(q,T({},e,{ref:u,icon:de})),ge=r.forwardRef(le),he=({data:e,imageUrl:u,totalCols:a,totalRows:l,blockSize:g})=>{const{attributes:w,listeners:o,setNodeRef:$,transform:c,isDragging:k}=oe({id:e.id,disabled:e.isLocked,data:{...e}}),m=e.isLocked||k?1:.85,E=k?9999:e.isLocked?1:100,C={position:"absolute",left:e.currentPos.x,top:e.currentPos.y,transform:c?`translate3d(${c.x}px, ${c.y}px, 0)`:void 0,zIndex:E,cursor:e.isLocked?"default":"grab",touchAction:"none"};return t.jsx("div",{ref:$,style:C,...o,...w,children:t.jsx(D.div,{animate:{scale:m,opacity:1,filter:e.isLocked?"brightness(1)":k?"brightness(1.1)":"brightness(1)",boxShadow:e.isLocked?"none":"0 10px 15px -3px rgba(0, 0, 0, 0.3)"},transition:{duration:.4,type:"spring",stiffness:250,damping:25},whileHover:!e.isLocked&&!k?{scale:.9}:void 0,whileTap:e.isLocked?void 0:{cursor:"grabbing"},style:{transformOrigin:"0 0"},children:e.shape.map((j,L)=>{const X=-(e.gridX+j.x)*g,I=-(e.gridY+j.y)*g;return t.jsx(D.div,{style:{position:"absolute",left:j.x*g,top:j.y*g,width:g,height:g,backgroundImage:`url(${u})`,backgroundSize:`${a*g}px ${l*g}px`,backgroundPosition:`${X}px ${I}px`,boxSizing:"border-box"},animate:{border:e.isLocked?"0px solid transparent":"1px solid rgba(255,255,255,0.6)"}},L)})})})},ue=({data:e,imageUrl:u,onComplete:a})=>{const[l,g]=r.useState([]),w=r.useRef(null),[o,$]=r.useState(0),[c,k]=r.useState({width:0,height:0}),[m,E]=r.useState({x:0,y:20}),[C,j]=r.useState(!1),{token:L}=ne.useToken(),X=Z(ee(se,{activationConstraint:{distance:5}})),I=(s,f,n,d,x,h)=>{const i=e.gridRows*n,b=s.filter(p=>!p.isLocked).length,R=Math.max(200,b*60),M=Math.max(200,b*80);return s.map(p=>{if(p.isLocked)return{...p,currentPos:{x:h.x+p.gridX*n,y:h.y+p.gridY*n}};let P,z,v,S;f?(v=i+40,S=v+R,P=0,z=d-n*2):(P=h.x+e.gridCols*n+20,z=P+M,v=0,S=i-n);const y=P+Math.random()*Math.max(0,z-P),U=v+Math.random()*Math.max(0,S-v);return{...p,currentPos:{x:y,y:U}}})};r.useEffect(()=>{const s=()=>{if(!w.current)return;const n=w.current.offsetWidth,d=window.innerHeight-200,x=(n-32)/e.gridCols,h=Math.min(50,Math.floor(x)),i=e.gridCols*h,b=(n-i)/2;$(h),k({width:n,height:d}),E({x:b,y:20})};s();const f=new ResizeObserver(()=>s());return w.current&&f.observe(w.current),()=>f.disconnect()},[e.gridCols]),r.useEffect(()=>{if(o===0||c.width===0)return;const s=e.pieces.map(d=>{const x=d.correctPos%e.gridCols,h=Math.floor(d.correctPos/e.gridCols),i=d.id===e.startingPieceId;return{...d,gridX:x,gridY:h,currentPos:{x:0,y:0},isLocked:i}}),f=c.width<600,n=I(s,f,o,c.width,c.height,m);g(n),j(!0)},[e,o,c.width,m.x]);const A=s=>{const{active:f,delta:n}=s;g(d=>{const x=O.cloneDeep(d),h=x.findIndex(y=>y.id===f.id);if(h===-1)return d;const i=x[h];let b=i.currentPos.x+n.x,R=i.currentPos.y+n.y;const M=m.x+i.gridX*o,p=m.y+i.gridY*o,P=Math.sqrt((b-M)**2+(R-p)**2),z=o*.45;let v=!1;if(P<z&&(b=M,R=p,i.isLocked=!0,v=!0),i.currentPos={x:b,y:R},v){const y=c.width<600;return I(x,y,o,c.width,c.height,m)}return x.every(y=>y.isLocked)&&!d.every(y=>y.isLocked)&&a&&a(),x})},B=r.useMemo(()=>l.length>0&&l.every(s=>s.isLocked),[l]),Y=e.gridRows*o,W=e.gridCols*o,F=l.filter(s=>!s.isLocked).length,N=B?Y+100:Y+Math.max(300,F*70)+100;return t.jsxs(ie,{style:{width:"100%",maxWidth:900,margin:"0 auto",border:"none",background:"transparent"},styles:{body:{padding:0}},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:"0 10px"},children:[t.jsx(H.Title,{level:4,style:{margin:0},children:"Puzzle"}),t.jsx(G,{icon:t.jsx(ge,{}),onClick:()=>{j(!1),window.dispatchEvent(new Event("resize"))},children:"Reset"})]}),t.jsx(te,{sensors:X,onDragEnd:A,children:t.jsxs("div",{ref:w,style:{position:"relative",height:C?N:400,width:"100%",backgroundColor:L.colorFillAlter,borderRadius:L.borderRadiusLG,overflow:"hidden",touchAction:"none",border:`1px solid ${L.colorBorderSecondary}`,transition:"height 0.5s ease"},children:[!C&&t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:t.jsx(re,{tip:"Loading Puzzle..."})}),C&&o>0&&t.jsxs(t.Fragment,{children:[t.jsxs(D.div,{initial:{opacity:0},animate:{opacity:1},style:{position:"absolute",top:m.y,left:m.x,width:W,height:Y,boxShadow:"0 0 0 2px rgba(0,0,0,0.05)",backgroundColor:"rgba(255,255,255,0.5)",zIndex:0},children:[t.jsx("div",{style:{width:"100%",height:"100%",backgroundImage:`
                     linear-gradient(to right, rgba(0,0,0,0.1) 1px, transparent 1px),
                     linear-gradient(to bottom, rgba(0,0,0,0.1) 1px, transparent 1px)
                   `,backgroundSize:`${o}px ${o}px`}}),t.jsx("div",{style:{position:"absolute",bottom:-25,width:"100%",textAlign:"center",color:L.colorTextQuaternary,fontSize:12},children:"Place pieces here"})]}),l.map((s,f)=>t.jsx(he,{data:s,imageUrl:u,totalCols:e.gridCols,totalRows:e.gridRows,blockSize:o},s.id)),t.jsx(Q,{children:B&&t.jsxs(D.div,{initial:{opacity:0,backdropFilter:"blur(0px)"},animate:{opacity:1,backdropFilter:"blur(8px)"},style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255,255,255,0.6)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:2e3},children:[t.jsx(D.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:t.jsx(ae,{style:{fontSize:80,color:"#52c41a"}})}),t.jsx(H.Title,{level:2,style:{color:"#52c41a",marginTop:16},children:"Excellent!"})]})})]})]})})]})};function ze(){_("Playground | Dev | Tarde Divertida");const[e,u]=r.useState([]),a=r.useMemo(()=>ce(`https://www.kavispires.com/td-images/images/td/d${O.random(1,12)}/${O.random(10,252)}.jpg`,21),[]);return console.log("puzzleData",a),t.jsxs(J,{children:[t.jsx(V,{title:"Playground"}),t.jsxs(K.Content,{className:"dev-content",children:[t.jsx("div",{children:"playground content"}),t.jsx("div",{style:{padding:20},children:t.jsx(ue,{data:a,onComplete:()=>console.log("User finished!"),imageUrl:a.cardId})})]})]})}export{ze as default};
