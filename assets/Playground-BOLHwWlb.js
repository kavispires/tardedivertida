import{r as y,$ as Y,j as o,O,B as N,h as D,b1 as A,v as S,E as B,x as F,L as _}from"./index-BbyNXcvu.js";import{D as W}from"./DevHeader-Cg1PugCs.js";import{D as H,u as U}from"./core.esm-aWvMTzXX.js";import{t as q}from"./index-C40feK4O.js";import{C as V}from"./index-DnBIM6pc.js";import{S as Z}from"./index-Ocg0qt9k.js";import{R as G}from"./CheckCircleOutlined-vcvroi_v.js";import"./index-Bp3HGLdR.js";import"./extends-CF3RwP-h.js";import"./useId-bv_UeeQg.js";import"./index-Dg3HV2zj.js";import"./EllipsisOutlined-DQhwrUOB.js";import"./Overflow-jFQkCk2E.js";import"./PlusOutlined-BF5mSxwn.js";var K={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};function X(){return X=Object.assign?Object.assign.bind():function(e){for(var p=1;p<arguments.length;p++){var a=arguments[p];for(var v in a)Object.prototype.hasOwnProperty.call(a,v)&&(e[v]=a[v])}return e},X.apply(this,arguments)}const Q=(e,p)=>y.createElement(Y,X({},e,{ref:p,icon:K})),J=y.forwardRef(Q),ee=({data:e,imageUrl:p,totalCols:a,totalRows:v,blockSize:r,index:i})=>{const{attributes:f,listeners:b,setNodeRef:I,transform:u,isDragging:L}=U({id:e.id,disabled:e.isLocked,data:{...e}}),M={position:"absolute",left:e.currentPos.x,top:e.currentPos.y,transform:u?`translate3d(${u.x}px, ${u.y}px, 0)`:void 0,zIndex:L?9999:e.isLocked?1:100,cursor:e.isLocked?"default":"grab",touchAction:"none"};return o.jsx("div",{ref:I,style:M,...b,...f,children:o.jsx(D.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:L?1.1:1,filter:e.isLocked?"brightness(1)":L?"brightness(1.1)":"brightness(1)"},transition:{duration:.3,delay:e.isLocked?0:i*.05,type:"spring",stiffness:300,damping:20},whileTap:e.isLocked?void 0:{scale:.95},children:e.shape.map((P,j)=>{const n=-(e.correctPos.x+P.x)*r,m=-(e.correctPos.y+P.y)*r;return o.jsx(D.div,{style:{position:"absolute",left:P.x*r,top:P.y*r,width:r,height:r,backgroundImage:`url(${p})`,backgroundSize:`${a*r}px ${v*r}px`,backgroundPosition:`${n}px ${m}px`,boxSizing:"border-box"},animate:{border:e.isLocked?"0px solid transparent":"1px solid rgba(255,255,255,0.8)",boxShadow:L?"0px 10px 20px rgba(0,0,0,0.4)":e.isLocked?"none":"0px 2px 4px rgba(0,0,0,0.3)"}},j)})})})},te=({data:e,onComplete:p})=>{const[a,v]=y.useState([]),r=y.useRef(null),[i,f]=y.useState(0),[b,I]=y.useState({width:0,height:0}),[u,L]=y.useState({x:0,y:20}),[M,P]=y.useState(!1),{token:j}=q.useToken();y.useEffect(()=>{const t=()=>{if(!r.current)return;const s=r.current.offsetWidth,c=window.innerHeight-200,h=(s-32)/e.gridCols,l=Math.min(50,Math.floor(h)),g=e.gridCols*l,w=(s-g)/2;f(l),I({width:s,height:c}),L({x:w,y:20})};t();const d=new ResizeObserver(()=>t());return r.current&&d.observe(r.current),()=>d.disconnect()},[e.gridCols]),y.useEffect(()=>{if(i===0||b.width===0)return;const t=b.width<600,d=e.gridRows*i,s=e.pieces.map(c=>{const h=u.x+c.correctPos.x*i,l=u.y+c.correctPos.y*i;if(c.initialLocked)return{...c,currentPos:{x:h,y:l},isLocked:!0};let g,w;if(t){const z=b.width-i*2,E=d+40,C=Math.max(E+300,b.height);g=Math.random()*Math.max(0,z),w=E+Math.random()*(C-E)}else{const z=u.x+e.gridCols*i+20,E=b.width-i,C=d-i;g=z+Math.random()*Math.max(0,E-z),w=Math.random()*C}return{...c,currentPos:{x:g,y:w},isLocked:!1}});v(s),P(!0)},[e,i,b.width,u.x]);const n=t=>{const{active:d,delta:s}=t;v(c=>{const h=S.cloneDeep(c),l=h.find(R=>R.id===d.id);if(!l)return c;let g=l.currentPos.x+s.x,w=l.currentPos.y+s.y;const z=u.x+l.correctPos.x*i,E=u.y+l.correctPos.y*i,C=Math.sqrt((g-z)**2+(w-E)**2),$=i*.45;return C<$&&(g=z,w=E,l.isLocked=!0),l.currentPos={x:g,y:w},h.every(R=>R.isLocked)&&!c.every(R=>R.isLocked)&&p&&p(),h})},m=y.useMemo(()=>a.length>0&&a.every(t=>t.isLocked),[a]),x=e.gridRows*i,k=e.gridCols*i;return o.jsxs(V,{style:{width:"100%",maxWidth:900,margin:"0 auto",border:"none",background:"transparent"},bodyStyle:{padding:0},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:"0 10px"},children:[o.jsx(O.Title,{level:4,style:{margin:0},children:"Puzzle"}),o.jsx(N,{icon:o.jsx(J,{}),onClick:()=>{P(!1),window.dispatchEvent(new Event("resize"))},children:"Reset"})]}),o.jsx(H,{onDragEnd:n,children:o.jsxs("div",{ref:r,style:{position:"relative",height:M?m?x+100:Math.max(600,x+450):400,width:"100%",backgroundColor:j.colorFillAlter,borderRadius:j.borderRadiusLG,overflow:"hidden",touchAction:"none",border:`1px solid ${j.colorBorderSecondary}`,transition:"height 0.3s ease"},children:[!M&&o.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:o.jsx(Z,{tip:"Loading Puzzle..."})}),M&&i>0&&o.jsxs(o.Fragment,{children:[o.jsxs(D.div,{initial:{opacity:0},animate:{opacity:1},style:{position:"absolute",top:u.y,left:u.x,width:k,height:x,boxShadow:"0 0 0 2px rgba(0,0,0,0.05)",backgroundColor:"rgba(255,255,255,0.5)",zIndex:0},children:[o.jsx("div",{style:{width:"100%",height:"100%",backgroundImage:`
                     linear-gradient(to right, rgba(0,0,0,0.1) 1px, transparent 1px),
                     linear-gradient(to bottom, rgba(0,0,0,0.1) 1px, transparent 1px)
                   `,backgroundSize:`${i}px ${i}px`}}),o.jsx("div",{style:{position:"absolute",bottom:-25,width:"100%",textAlign:"center",color:j.colorTextQuaternary,fontSize:12},children:"Place pieces here"})]}),a.map((t,d)=>o.jsx(ee,{index:d,data:t,imageUrl:e.imageUrl,totalCols:e.gridCols,totalRows:e.gridRows,blockSize:i},t.id)),o.jsx(A,{children:m&&o.jsxs(D.div,{initial:{opacity:0,backdropFilter:"blur(0px)"},animate:{opacity:1,backdropFilter:"blur(8px)"},style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255,255,255,0.6)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:2e3},children:[o.jsx(D.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:o.jsx(G,{style:{fontSize:80,color:"#52c41a"}})}),o.jsx(O.Title,{level:2,style:{color:"#52c41a",marginTop:16},children:"Excellent!"})]})})]})]})})]})},T=50,se=7,oe=(e,p=12,a=6)=>{const v=Math.max(9,Math.min(24,p)),r=Math.round(a*1.5),i=[],f=[];let b=0;for(let n=0;n<r;n++){const m=[];for(let x=0;x<a;x++)m.push(b),f.push({id:b,blocks:[{x,y:n}]}),b++;i.push(m)}let I=0;for(;f.length>v&&!(I>50);){let n=Number.POSITIVE_INFINITY;f.forEach(t=>{t.blocks.length<n&&(n=t.blocks.length)});const m=f.filter(t=>t.blocks.length===n),x=S.shuffle(m);let k=!1;for(const t of x){const d=new Set;if(t.blocks.forEach(s=>{[{x:s.x+1,y:s.y},{x:s.x-1,y:s.y},{x:s.x,y:s.y+1},{x:s.x,y:s.y-1}].forEach(h=>{if(h.x>=0&&h.x<a&&h.y>=0&&h.y<r){const l=i[h.y][h.x];if(l!==t.id){const g=f.find(w=>w.id===l);g&&t.blocks.length+g.blocks.length<=se&&d.add(l)}}})}),d.size>0){const s=Array.from(d),c=s[S.random(0,s.length-1)],h=f.findIndex(g=>g.id===c),l=f[h];t.blocks=[...t.blocks,...l.blocks],l.blocks.forEach(g=>{i[g.y][g.x]=t.id}),f.splice(h,1),k=!0;break}}if(k)I=0;else if(I++,I>5){const t=S.shuffle(f);for(const d of t);}}const u=f.map((n,m)=>{n.blocks.sort((s,c)=>s.y-c.y||s.x-c.x);const x=n.blocks[0],k=n.blocks.map(s=>({x:s.x-x.x,y:s.y-x.y})),t=a*T+20,d=t+200;return{id:`piece-${m}`,shape:k,correctPos:{x:x.x,y:x.y},initialPos:{x:S.random(t,d),y:S.random(0,r*T-50)},initialLocked:!1}}),L=a/2,M=r/2;let P=-1,j=Number.POSITIVE_INFINITY;if(u.forEach((n,m)=>{let x=0,k=0;n.shape.forEach(c=>{x+=n.correctPos.x+c.x,k+=n.correctPos.y+c.y});const t=x/n.shape.length,d=k/n.shape.length,s=Math.sqrt((t-L)**2+(d-M)**2);s<j&&(j=s,P=m)}),P!==-1){const n=u[P];n.initialPos={x:n.correctPos.x*T,y:n.correctPos.y*T},n.initialLocked=!0}return{imageUrl:e,gridCols:a,gridRows:r,pieces:u}};function be(){B("Playground | Dev | Tarde Divertida");const[e,p]=y.useState([]),a=y.useMemo(()=>oe("https://www.kavispires.com/td-images/images/td/d12/06.jpg",12),[]);return o.jsxs(F,{children:[o.jsx(W,{title:"Playground"}),o.jsxs(_.Content,{className:"dev-content",children:[o.jsx("div",{children:"playground content"}),o.jsx("div",{style:{padding:20},children:o.jsx(te,{data:a,onComplete:()=>console.log("User finished!")})})]})]})}export{be as default};
