import{r as d,aF as C,a7 as F,bM as T,c0 as z,aR as D,q as S,j as a,e as R,aQ as h,T as b,b6 as G}from"./index-DvppfgRv.js";import{u as L}from"./DebugOnly-f-8UdT-g.js";import{P as y}from"./PlayerAvatar-4I-LnJ6Z.js";var q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zM512 734.2c-62.1 0-112.6-50.5-112.6-112.6S449.9 509 512 509s112.6 50.5 112.6 112.6S574.1 734.2 512 734.2zm0-160.9c-26.6 0-48.2 21.6-48.2 48.3 0 26.6 21.6 48.3 48.2 48.3s48.2-21.6 48.2-48.3c0-26.6-21.6-48.3-48.2-48.3z"}}]},name:"crown",theme:"filled"},O=function(n,p){return d.createElement(C,F({},n,{ref:p,icon:q}))},P=d.forwardRef(O);function Q({gainedPoint:e,order:n,description:p}){const _=e>0,o=e<0;return a.jsx("li",{className:R("ranking-board__gained-point",_&&"ranking-board__gained-point--plus",o&&"ranking-board__gained-point--minus",`ranking-board__gained-point--${n}`),children:a.jsxs(h,{title:p??a.jsx(b,{pt:"Pontos ganhos",en:"Gained Points"}),color:_?"gold":o?"red":"gray",children:[_?"+":"",e]})})}function I({gainedPoints:e,playerId:n,gainedPointsDescriptions:p=[]}){const _=Array.isArray(e)?e:[e];return a.jsx("ul",{className:"ranking-board__cell-gained-points",children:_.map((o,m)=>a.jsx(Q,{gainedPoint:o,order:m,description:p[m]},`gained-point-${n}-${m}`))})}function U({players:e,ranking:n,gainedPointsDescriptions:p,hideGainedPoints:_=!1,delay:o=0,victoryIndex:m=0}){const[j,v]=d.useState(0),[f,$]=d.useState([]),[N,A]=d.useState(0),[E,{height:w}]=T(),M=d.useId(),B=d.useMemo(()=>z(n.map(t=>t.newScore).sort((t,i)=>i-t)),[n]),{seconds:g}=L({duration:5+o,autoStart:!0,onExpire:()=>{A(1),v(3)}});return D(()=>{const t={};let i=0,s=0;const x=S.orderBy(n,["newScore","name"],["desc","asc"]).reduce((l,c,r)=>(l[c.playerId]=r,(s===0||c.newScore<s)&&(s=c.newScore,i+=1),t[c.playerId]=[0,i],l),{}),k=S.orderBy(n,["previousScore","name"],["desc","asc"]);i=0,s=0;const u=k.map((l,c)=>{const r={...l};return r.order=[c,x[r.playerId]],r.position=t[r.playerId],(s===0||l.previousScore<s)&&(s=l.previousScore,i+=1),r.position[0]=i,r});$(u)}),d.useEffect(()=>{g===4+o?v(1):g===2+o&&v(2)},[g,o]),a.jsxs("div",{className:R("ranking-board",g>4&&"ranking-board--hidden",g===4&&G("fadeIn")),style:{height:`${(Math.max(60,w)+8)*f.length}px`},children:[a.jsxs("div",{className:"ranking-board__row",id:`ranking-row-${M}-placeholder`,style:{opacity:0},ref:E,children:[a.jsx("div",{className:"ranking-board__cell-crown",children:a.jsx(P,{className:"ranking-board__crown-icon"})}),a.jsx("div",{className:"ranking-board__cell-position",children:"#0"}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(y,{avatarId:"A"})}),a.jsx("div",{className:"ranking-board__name",children:"Placeholder"})]}),a.jsx(h,{title:a.jsx(b,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:"0"})}),a.jsx(I,{gainedPoints:0,playerId:"A"}),a.jsx(h,{title:"Total",color:"gold",children:a.jsx("span",{className:"ranking-board__cell-points-total",children:"0"})})]}),f.map((t,i)=>{const{playerId:s,newScore:x,previousScore:k,gainedPoints:u,order:l,position:c}=t,r=(Math.max(60,w)+8)*(l[N]??0);return a.jsxs("div",{className:`ranking-board__row ranking-board__row--${i}`,style:{top:`${r}px`},children:[a.jsx("div",{className:"ranking-board__cell-crown",children:B[m]===x&&j>=3&&a.jsx(P,{className:"ranking-board__crown-icon"})}),a.jsxs("div",{className:"ranking-board__cell-position",children:["#",c[N]??""]}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(y,{avatarId:e[s].avatarId})}),a.jsx("div",{className:"ranking-board__name",children:e[s].name})]}),a.jsx(h,{title:a.jsx(b,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:k})}),!_&&j>=1&&u!==void 0&&a.jsx(I,{gainedPoints:u,playerId:s,gainedPointsDescriptions:p}),a.jsx(h,{title:"Total",color:"gold",children:j>=2?a.jsx("span",{className:"ranking-board__cell-points-total",children:x}):a.jsx("span",{className:"ranking-board__cell-points-total-preliminary",children:x})})]},`ranking-${s}`)})]})}export{U as R,P as a};
