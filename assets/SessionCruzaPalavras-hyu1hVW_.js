import{r as m,ay as O,f as $,j as e,T as d,aK as E,i as fe,bm as Y,aL as le,aH as Ce,aI as ve,e as T,q as be,J as Se,bE as K,P as ye,B as A,aF as Re,aO as ue,bK as Ae,aM as Ie,bD as we,n as de,b4 as Pe,bL as Te,l as Ee,aX as Le,aV as Oe,aW as Ne}from"./index-CQUMMVDG.js";import{u as J,a as me,S as B,b as W,d as U,c as M,P as k,e as G,f as v,g as _,R as $e,m as Be,n as We,i as Ue,j as Me,k as ke,l as Ge}from"./StepSwitcher-Cltrlngp.js";import{G as _e}from"./GridIcon-3E9O0Lau.js";import{R as Ve}from"./RoundAnnouncement-CT9R_Rw9.js";import{P as b}from"./PointsHighlight-CG875ZZp.js";import{I as Q}from"./Instruction-BcmUACq2.js";import{T as F}from"./TextHighlight-RzvVEwxu.js";import{R as V}from"./RuleInstruction-DN3QIpN4.js";import{P as X}from"./PopoverRule-Dv8WsaLM.js";import{b as Fe}from"./useBlurCards-BNBaHpYL.js";import{u as qe}from"./useTDBaseUrl-BF9foKiS.js";import{I as ze}from"./ItemCard-CflSsGvY.js";/* empty css                             */import{I as pe}from"./ImageBlurButtonContainer-0igmRsBa.js";import{I as De}from"./ImageCard-DSHAVMIq.js";import{G as He}from"./GuessIcon-BedXVQUp.js";import{A as Ze}from"./Avatar-CmeCW0wX.js";import{R as xe}from"./PlusCircleFilled-CEa-WgcQ.js";import{M as Ye}from"./iconUtil-CJfzjpEk.js";import{R as Ke}from"./ThunderboltOutlined-CEayxIqi.js";import{R as Je}from"./RankIcon-C3wzJi-3.js";import{T as Qe}from"./speech-DcZj5YcT.js";import{C as Xe}from"./Container-B97coqBy.js";import{A as ee}from"./AvatarName-DIZJIZlp.js";import{F as er}from"./Table-BflFT9Dr.js";import{R as rr}from"./TrophyOutlined-E7m2_2ZB.js";import{S as nr}from"./StepRankingWrapper-4deGJVFu.js";import{V as sr}from"./VerifyListIcon-lsHS4a7-.js";import{u as tr}from"./useBooleanDictionary-BH3jDeVQ.js";import{C as or}from"./Card-CVNI8OKP.js";import{B as ar}from"./index-igwYyNuM.js";import{T as ir}from"./TrophyIcon-Cu2z3dlk.js";import"./GameOver-Dfoeq1n2.js";import{G as cr}from"./GameOverWrapper-T3rdZG_8.js";import{A as lr}from"./Achievements-BAyv2Mp4.js";import{a as ur}from"./achievements-B2fypp9m.js";import"./RulesModal-CyiumakY.js";import"./WritingIcon-D_CabSBO.js";import"./DoubleRightOutlined-_thKMvXL.js";import"./PurePanel-DkMXBX4K.js";import"./useMutation-CNFCaVbz.js";import"./Game-DMEYRr-s.js";import"./WaitingRoomIcon-DaW3uofA.js";import"./AnimatedClockIcon-Cr0gLJd3.js";import"./index-D9a1HKEb.js";import"./useBubbleLock-Dck5kWPv.js";import"./index-SVYsEjXI.js";import"./Overflow-3IsHxuZJ.js";import"./useEvent-DBQOYUIG.js";import"./index-DjhFmCe7.js";import"./GameBanner-DY8t2G9E.js";import"./useDevFeatures-NUd8DDqp.js";import"./index-DM0bH6ac.js";import"./InfoCircleOutlined-tNBm2eLt.js";import"./index-CnGqfOjc.js";import"./SignIn-Cqng2M16.js";import"./GoogleIcon-QYeWCHdD.js";import"./Loading-BcJgtUMy.js";import"./AnimatedLoaderIcon-T0eGRTHJ.js";import"./LikeFilled-Clhf1Kqr.js";import"./StarIcon-Bltqe6k8.js";import"./MetricHighlight-BMAOLpuw.js";import"./StarFilled-D0W2b4Hd.js";import"./StarFilled-CNctUIhy.js";import"./Sprite-C1udt0Hk.js";import"./WarningOutlined-CclWfmT_.js";import"./ImageBlurButton-BnRq3atq.js";import"./EllipsisOutlined-B6_2mSqc.js";import"./index-De6wMb-w.js";import"./useId-0-OfsZou.js";import"./scrollTo-KRbcs74W.js";import"./FilterFilled-B9EqEaba.js";import"./CaretDownOutlined-Dv3U9ShB.js";import"./CaretUpOutlined-CTN4lzvm.js";import"./RankingBoard-CgjHi8vO.js";import"./ArrowRightOutlined-CQllJ8az.js";import"./useMergedState-D5RTwnQi.js";import"./progress-2u_7ipfX.js";import"./TheEndIcon-UcvM5_Bv.js";import"./Medal-DKUNn8kV.js";import"./QuestionCircleOutlined-DVgZxFlY.js";var dr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM695.5 365.7l-210.6 292a31.8 31.8 0 01-51.7 0L308.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H689c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-square",theme:"filled"},mr={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112c17.7 0 32 14.3 32 32v736c0 17.7-14.3 32-32 32H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32zM639.98 338.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-square",theme:"filled"},pr={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112c17.7 0 32 14.3 32 32v736c0 17.7-14.3 32-32 32H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32zm-40 72H184v656h656V184zM640.01 338.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-square",theme:"outlined"},xr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"};function q(){return q=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(r[t]=s[t])}return r},q.apply(this,arguments)}const hr=(r,n)=>m.createElement(O,q({},r,{ref:n,icon:dr})),jr=m.forwardRef(hr);function z(){return z=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(r[t]=s[t])}return r},z.apply(this,arguments)}const gr=(r,n)=>m.createElement(O,z({},r,{ref:n,icon:mr})),fr=m.forwardRef(gr);function D(){return D=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(r[t]=s[t])}return r},D.apply(this,arguments)}const Cr=(r,n)=>m.createElement(O,D({},r,{ref:n,icon:pr})),vr=m.forwardRef(Cr);function H(){return H=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(r[t]=s[t])}return r},H.apply(this,arguments)}const br=(r,n)=>m.createElement(O,H({},r,{ref:n,icon:xr})),Sr=m.forwardRef(br);function Z(){return Z=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(r[t]=s[t])}return r},Z.apply(this,arguments)}const yr=(r,n)=>m.createElement(O,Z({},r,{ref:n,icon:Ye})),Rr=m.forwardRef(yr),re={SUBMIT_WORDS:"SUBMIT_WORDS",SUBMIT_CLUE:"SUBMIT_CLUE",SUBMIT_GUESSES:"SUBMIT_GUESSES"};function Ar(r){const{translate:n}=$(),s=J({actionName:"submit-words",onBeforeCall:()=>r(2),onError:()=>r(0),successMessage:n("Palavras enviadas com sucesso","Words submitted successfully"),errorMessage:n("Vixi, o aplicativo encontrou um erro ao tentar enviar suas palavras","Oops, the application failed to send your words")});return t=>{s({action:re.SUBMIT_WORDS,...t})}}function Ir(r){const{translate:n}=$(),s=J({actionName:"submit-clue",onBeforeCall:()=>r(3),onError:()=>r(1),successMessage:n("Dica enviada com sucesso","Clue submitted successfully"),errorMessage:n("Vixi, o aplicativo encontrou um erro ao tentar enviar sua dica","Oops, the application failed to send your clue")});return t=>{s({action:re.SUBMIT_CLUE,...t})}}function wr(r){const{translate:n}=$(),s=J({actionName:"submit-guesses",onBeforeCall:()=>r(2),onError:()=>r(1),successMessage:n("Respostas enviadas com sucesso","Guesses submitted successfully"),errorMessage:n("Vixi, o aplicativo encontrou um erro ao tentar enviar suas respostas","Oops, the application failed to send your guesses")});return t=>{s({action:re.SUBMIT_GUESSES,...t})}}function he({playerCount:r}){return e.jsx(Q,{children:e.jsx(d,{pt:e.jsxs(e.Fragment,{children:["Você tem uma coordenada específica e única na grade de palavras.",e.jsx("br",{}),"Escreva uma dica (palavra única) que conecte as palavras da linha e da coluna assinalada a você.",e.jsx("br",{}),"Escreva algo bem simples e óbvio porque se ninguém entender você perderá"," ",e.jsxs(b,{type:"negative",children:["- ",r]})," pontos."]}),en:e.jsxs(e.Fragment,{children:["You will get an unique coordinate in the word grid.",e.jsx("br",{}),"You must write a single word clue that connects the word in the column and in the row of your coordinate.",e.jsx("br",{}),"Write something simple and obvious because if nobody gets your clue you will lose"," ",e.jsxs(b,{type:"negative",children:["- ",r]}),"points."]})})})}function ne({playerCount:r}){return e.jsx(Q,{children:e.jsx(d,{pt:e.jsxs(e.Fragment,{children:["Você ganha ",e.jsx(b,{children:"+2"})," pontos para cada célula com uma resposta correta sua.",e.jsx("br",{}),e.jsx(b,{children:"+1"})," ponto para cada célula com uma dica mas uma resposta errada sua.",e.jsx("br",{}),e.jsx(b,{children:"+1"})," ponto para cada voto correto que sua dica recebeu.",e.jsx("br",{}),"Mas se ninguém acertar sua dica, você perde"," ",e.jsxs(b,{type:"negative",children:["- ",r]})," pontos."]}),en:e.jsxs(e.Fragment,{children:["You get ",e.jsx(b,{children:"+2"})," points for each cell with your correct answer.",e.jsx("br",{}),e.jsx(b,{children:"+1"})," point for each cell with a clue but with a wrong answer of yours.",e.jsx("br",{}),e.jsx(b,{children:"+1"})," point for each correct vote your clue received.",e.jsx("br",{}),"But if nobody gets your clue correctly, you lose"," ",e.jsxs(b,{type:"negative",children:["- ",r]})," points."]})})})}function Pr({user:r,grid:n}){const s=n[r.coordinate];return!r.clue||!s?e.jsx(e.Fragment,{}):e.jsxs(E,{direction:"vertical",children:[e.jsx(fe,{size:"xx-small",children:e.jsx(d,{pt:"Sua dica",en:"Your clue"})}),e.jsxs("span",{children:[e.jsx(F,{children:s.xText})," + ",e.jsx(F,{children:s.yText})," ="," ",e.jsx(F,{children:r.clue})]})]})}function Tr(r){return r.gridType==="contenders"?e.jsx(Er,{...r}):r.gridType==="images"?e.jsx(Lr,{...r}):r.gridType==="items"?e.jsx(Or,{...r}):e.jsx(e.Fragment,{children:r.cell.text})}function Er({cell:r}){var o;const{shouldBeBlurred:n}=Fe(),s=qe("images"),t=Y(8,{gap:16,minWidth:30,maxWidth:100}),i=(o=r.id)==null?void 0:o.replace(/-/g,"/"),c=n(r.id);return e.jsxs("div",{className:"w-contender",style:{width:`${t}px`},children:[e.jsx(le,{title:r.text,children:e.jsx("span",{className:"w-contender-name",children:r.text})}),e.jsx(Ce,{src:`${s}/${i}.jpg`,width:t,className:T("w-contender-image",c&&"w-contender-image--blur"),fallback:`${ve.IN_GAME}/w-no-image.jpg`,alt:r.text})]})}function Lr({cell:r}){const n=Y(8,{gap:16,minWidth:30,maxWidth:100});return e.jsx("div",{className:"w-contender",style:{width:`${n}px`},children:e.jsx(pe,{cardId:r.id??"",children:e.jsx(De,{id:r.id??"",cardWidth:n})})})}function Or({cell:r}){const n=Y(8,{gap:16,minWidth:30,maxWidth:100});return e.jsx("div",{className:"w-contender",style:{width:`${n}px`},children:e.jsx(pe,{cardId:r.id??"",children:e.jsx(ze,{id:r.id??"",text:{pt:r.text,en:r.text},width:n,className:"transparent-gradient"})})})}function se({grid:r,user:n,CellComponent:s,gridType:t,cellComponentProps:i={}}){const c=Math.sqrt(r.length),o={gridTemplateColumns:`repeat(${c}, 1fr)`,gridTemplateRows:`repeat(${c}, auto)`};return e.jsx("div",{className:"x-grid",style:o,children:r.map(a=>e.jsxs("div",{className:T("x-grid-cell",`x-grid-cell--${a.kind}`),children:[a.kind==="header"&&e.jsx(Tr,{cell:a,gridType:t}),a.kind==="cell"&&e.jsx(s,{...i,cell:a,user:n})]},`${a.index}-${a.kind}`))})}function te({clue:r}){return e.jsx("div",{className:"x-previous-clue",children:r})}function Nr({x:r,y:n,onSubmit:s,disabled:t,index:i}){const[c,o]=m.useState(""),a=m.useRef(null),l=u=>{o(u.target.value)};return m.useEffect(()=>{var u;return(u=a==null?void 0:a.current)==null?void 0:u.focus()},[]),me(()=>{s({clue:`${r.substring(0,r.length/2)}${n.substring(n.length/2)}`,currentClueCoordinate:i})},[]),e.jsxs(be,{direction:"vertical",children:[e.jsx(Se,{ref:a,placeholder:`${r} + ${n}`,onChange:l,onPressEnter:()=>s({clue:c,currentClueCoordinate:i})}),e.jsx(K,{onClick:()=>s({clue:c,currentClueCoordinate:i}),disabled:t||!c.length,children:e.jsx(d,{pt:"Enviar",en:"Submit"})})]})}function $r({onSubmitClue:r,cell:n,user:s,disabled:t}){return n.writable&&s.id===n.playerId?e.jsx(ye,{content:e.jsx(Nr,{x:n.xText??"",y:n.yText??"",index:n.index,onSubmit:r}),title:e.jsx(d,{pt:"Escreva",en:"Write"}),trigger:"click",children:e.jsx(A,{shape:"circle",type:"primary",disabled:t,children:e.jsx(Sr,{})})}):n.text?e.jsx(te,{clue:n.text}):e.jsx(e.Fragment,{})}function Br({grid:r,gridType:n,user:s,onSubmitClue:t,players:i,announcement:c}){const{isLoading:o}=Re(),a=l=>{t({clue:l.clue.trim().toLowerCase(),currentClueCoordinate:l.currentClueCoordinate})};return e.jsxs(B,{fullWidth:!0,announcement:c,children:[e.jsx(W,{children:e.jsx(d,{pt:"Escreva sua dica",en:"Write your clue"})}),e.jsx(X,{content:e.jsx(he,{playerCount:Object.keys(i).length})}),e.jsx(V,{type:"action",children:e.jsx(d,{pt:e.jsxs(e.Fragment,{children:["Clique em um dos ícones na grade e escreva sua dica.",e.jsx("br",{}),"Você só precisa escrever a dica para uma das coordenadas.",e.jsx("br",{}),"Sua dica deve conter apenas ",e.jsx("strong",{children:"uma palavra única"}),".",e.jsx("br",{}),"Você ",e.jsx("strong",{children:"NÃO"})," pode usar nenhuma palavra que esteja na grade."]}),en:e.jsxs(e.Fragment,{children:["Click on the icon on either of the table cell and write your clue.",e.jsx("br",{}),"You only need to write the clue for one of the coordinates.",e.jsx("br",{}),"Your clue must be a ",e.jsx("strong",{children:"single-word"})," clue.",e.jsx("br",{}),"You can ",e.jsx("strong",{children:"NOT"})," use any words already in the table."]})})}),e.jsx(se,{grid:r,user:s,CellComponent:$r,cellComponentProps:{onSubmitClue:a,disabled:o},gridType:n})]})}function Wr({players:r,state:n}){var l;const{step:s,goToNextStep:t,setStep:i}=U(0),c=M(r,n),o=Ir(i),a=e.jsx(k,{icon:e.jsx(_e,{}),title:e.jsx(d,{pt:"Escreva!",en:"Write!"}),currentRound:(l=n==null?void 0:n.round)==null?void 0:l.current,type:"overlay",children:e.jsx(he,{playerCount:Object.keys(r).length})});return e.jsx(G,{phase:n==null?void 0:n.phase,allowedPhase:v.CRUZA_PALAVRAS.CLUE_WRITING,children:e.jsxs(_,{step:s,players:r,waitingRoom:{content:e.jsx(Pr,{grid:n.grid,user:c})},children:[e.jsx(Ve,{round:n==null?void 0:n.round,onPressButton:t,buttonText:" ",time:5}),e.jsx(Br,{user:c,grid:n.grid,gridType:n.gameType,onSubmitClue:o,players:r,announcement:a})]})})}const ae=r=>!!(r!=null&&r.clue),R=r=>`${r==null?void 0:r.clue}${ue}${r==null?void 0:r.playerId}`,je=r=>r.split(ue)??["",""];function oe({isMatched:r,isSelected:n,clue:s,indexColor:t=0,color:i,player:c,strikeMatches:o=!1}){const a=Ae(t);return e.jsxs("div",{className:T("x-clue-card",n&&"x-clue-card--selected",!i&&`color-border--${a}`),style:{borderColor:i},children:[e.jsx("span",{className:T("x-clue-card__icon",!i&&`color-background--${a}`),style:{backgroundColor:i},children:r?c?e.jsx(Ze,{id:c==null?void 0:c.avatarId}):e.jsx($e,{}):e.jsx(xe,{style:n?{color:"gold"}:{color:"white"}})}),e.jsx("span",{className:T("x-clue-card__clue",r&&o&&"x-clue-card__clue--matched"),children:s})]})}function Ur({onSelectCell:r,onClearCell:n,cell:s,active:t,guesses:i,clues:c,user:o}){const a=s.index===t,l=Object.entries(i).find(x=>x[1]===s.index),[u,g]=l??[],[f,I]=je(u??""),p=g===s.index;if(p){const x=c.findIndex(y=>y.clue===f&&y.playerId===I);return e.jsx(A,{onClick:o.id!==I&&u?()=>n(u):()=>{},type:"text",style:{height:"auto"},children:e.jsx(oe,{isMatched:p,isSelected:a,clue:f,indexColor:x})})}return s.text?e.jsx(te,{clue:s.text}):s.playerId===o.id?e.jsx(le,{title:e.jsx(d,{pt:"Essa célula pertence a uma de duas outras dicas, então não pode ser essa",en:"This cell belongs to one of two other clues, so it can't be this one"}),children:e.jsx(A,{shape:"circle",ghost:!0,children:e.jsx(Rr,{})})}):e.jsx(A,{onClick:()=>r(s.index),shape:"circle",children:e.jsx(xe,{style:a?{color:"gold"}:{}})})}function Mr({clues:r,onActivateClue:n,active:s,guesses:t}){return e.jsx("ul",{className:"x-clue-cards",children:r.map((i,c)=>{const o=typeof s!="number"&&i.coordinate===(s==null?void 0:s.coordinate),a=!!t[R(i)];return e.jsx("li",{className:"x-clue-card-li",children:e.jsx("button",{type:"button",className:"x-clue-card-button",onClick:()=>n(i),children:e.jsx(oe,{isMatched:a,isSelected:o,clue:i.clue,indexColor:c,strikeMatches:!0})})},`${i.coordinate}-${i.clue}`)})})}function kr({grid:r,gridType:n,user:s,clues:t,onSubmitGuesses:i,announcement:c}){const[o,a]=m.useState(null),[l,u]=m.useState({}),[g,f]=m.useState(!1),I=m.useCallback(h=>{if(!o||ae(o)){a(h);return}typeof o=="number"&&(u(C=>({...C,[R(h)]:o})),a(null))},[o]),p=m.useCallback(h=>{ae(o)?u(C=>{const S=Object.entries(C).reduce((L,[P,j])=>(P&&j&&j!==h&&(L[P]=j),L),{});return o&&typeof o!="number"&&(S[R(o)]=h),a(null),S}):a(h)},[o]),x=h=>{u(C=>{const S={...C};return delete S[h],S})},y=m.useCallback(()=>{const h=Object.entries(l).reduce((C,[S,L])=>{const[,P]=je(S);return C[P]=L,C},{});i({guesses:h,choseRandomly:g})},[l,i,g]);Ie(()=>{const h=t.find(C=>C.playerId===s.id);u({[R(h)]:(h==null?void 0:h.coordinate)??-1})});const w=()=>{const h=Object.values(l),C=Object.keys(l);f(!0);const S=we(r.filter(j=>j.available&&j.playerId!==s.id&&!h.includes(j.index))),P=t.filter(j=>!C.includes(R(j))).reduce((j,N,ge)=>(N.playerId===s.id?j[R(N)]=N.coordinate:j[R(N)]=S[ge].index,j),{});u({...P,...l})};return e.jsxs(B,{fullWidth:!0,announcement:c,children:[e.jsx(W,{children:e.jsx(d,{pt:"Decifre as dicas!",en:"Guess the cells!"})}),e.jsx(Mr,{clues:t,onActivateClue:I,active:o,guesses:l}),e.jsx(V,{type:"action",children:e.jsx(d,{pt:"Clique em uma dica acima e em uma célula abaixo, ou vice-versa para posicionar as dicas nas células corretas.",en:"Click on a clue above then on a cell below, or vice-versa, to position the clues in their correct cells."})}),e.jsxs(E,{align:"center",children:[e.jsx(A,{size:"large",type:"dashed",onClick:w,icon:e.jsx(Ke,{}),children:e.jsx(d,{pt:"Desistir",en:"Give up"})}),e.jsx(K,{size:"large",onClick:y,disabled:Object.keys(l).length!==t.length,children:e.jsx(d,{pt:"Enviar respostas",en:"Send guesses"})})]}),e.jsx(se,{grid:r,gridType:n,user:s,CellComponent:Ur,cellComponentProps:{onSelectCell:p,onClearCell:x,active:o,guesses:l,clues:t,user:s}})]})}function Gr({players:r,state:n}){var a;const{step:s,setStep:t}=U(0),i=M(r,n),c=wr(t),o=e.jsx(k,{icon:e.jsx(He,{}),title:e.jsx(d,{pt:"Match!",en:"Combine!"}),currentRound:(a=n==null?void 0:n.round)==null?void 0:a.current,type:"overlay",children:e.jsx(Q,{children:e.jsx(d,{pt:e.jsxs(e.Fragment,{children:["Agora combine as dicas de cada jogador com as coordenadas corretas!",e.jsx("br",{}),"Basta clicar em uma das dicas no topo e então em uma das células da grade."]}),en:e.jsxs(e.Fragment,{children:["Now match the clues from each player with the correct coordinates",e.jsx("br",{}),"Just click on one of the clues on top then in one of the cells in the grid."]})})})});return e.jsx(G,{phase:n==null?void 0:n.phase,allowedPhase:v.CRUZA_PALAVRAS.GUESSING,children:e.jsx(_,{step:s,players:r,children:e.jsx(kr,{user:i,grid:n.grid,gridType:n.gameType,clues:n.clues,onSubmitGuesses:c,announcement:o})})})}function ie({badCluesPlayersList:r}){return e.jsx("span",{children:r.map((n,s)=>e.jsxs("span",{children:[e.jsx(ee,{player:n,size:"small"},`bad-clue-${n.id}`),r.length>0&&s<r.length-1?", ":""]},`bad-clue-${n.id}-${s}`))})}function _r({players:r,grid:n,correctCoordinatesPerPlayer:s}){const{translate:t}=$(),i=[{title:t("Jogador","Player"),dataIndex:"player",key:"player",render:o=>e.jsx(ee,{player:o}),sorter:(o,a)=>o.playerName.localeCompare(a.playerName)},{title:t("Achou que","Thought that"),dataIndex:"guess",key:"guess",render:o=>o.toUpperCase(),sorter:(o,a)=>o.guess.localeCompare(a.guess)},{title:t("Era","Was"),dataIndex:"clue",key:"clue",render:o=>o.toUpperCase(),sorter:(o,a)=>o.clue.localeCompare(a.clue)},{title:t("Resultado","Result"),dataIndex:"result",key:"result",render:o=>o?e.jsx(jr,{style:{color:"green"}}):e.jsx(fr,{style:{color:"red"}}),sorter:o=>o.result===!0?1:-1}],c=m.useMemo(()=>{const o=Object.values(r).map(a=>Object.entries((a==null?void 0:a.guesses)??{}).reduce((l,[u,g])=>{if(u===a.id)return l;const f=n[g];return l.push({playerName:a.name,player:a,clue:`${f.yText} + ${f.xText}`,guess:r[u].clue,result:(s==null?void 0:s[g])===u}),l},[]));return de.orderBy(o.flat(),["playerName","guess"],["asc","asc"])},[r,n,s]);return e.jsx(er,{size:"small",columns:i,dataSource:c,pagination:!1})}function ce({cellPlayers:r,players:n}){return e.jsx("ul",{children:r.map(({playerId:s,isCorrect:t})=>t?e.jsx("li",{className:T(t&&"x-players-in-cell-player--correct"),children:e.jsx(ee,{player:n[s],size:"small"})},`players-in-cell-${s}`):void 0)})}function Vr({cell:r,clues:n,players:s,playerPerVotedCell:t,colorCodedCluesPerPlayer:i}){const c=n.find(a=>a.coordinate===r.index),o=(t[r.index]??[]).filter(a=>a.isCorrect);return c!=null&&c.playerId?e.jsxs("div",{className:"center",children:[e.jsx(oe,{isMatched:!0,clue:c.clue,color:i[c.playerId],player:s[c.playerId]}),o.length?e.jsx(ce,{cellPlayers:o,players:s}):e.jsx(vr,{})]}):r.text?e.jsx(te,{clue:r.text}):e.jsx("span",{children:!!o.length&&e.jsx(ce,{cellPlayers:o,players:s})})}const Fr=Pe;function qr({grid:r,gridType:n,user:s,players:t,clues:i,goToNextStep:c,whoGotNoPoints:o,announcement:a}){Be();const{correctCoordinatesPerPlayer:l,colorCodedCluesPerPlayer:u,whoGotNoPointsNames:g,playerCount:f}=m.useMemo(()=>({correctCoordinatesPerPlayer:i.reduce((p,x)=>(x.playerId&&(p[x.coordinate]=x.playerId),p),{}),colorCodedCluesPerPlayer:i.reduce((p,x)=>(x.playerId&&(p[x.playerId]=Fr[t[x.playerId].avatarId].color),p),{}),whoGotNoPointsNames:o.map(p=>t[p]),playerCount:Object.keys(t).length}),[t,i,o]),I=m.useMemo(()=>Object.values(t).reduce((p,x)=>(Object.entries(x.guesses??{}).forEach(([y,w])=>{y!==x.id&&(p[w]===void 0&&(p[w]=[]),p[w].push({playerId:x.id,color:u[y],isCorrect:l[w]===y}))}),p),{}),[t,l,u]);return e.jsxs(B,{fullWidth:!0,announcement:a,children:[e.jsx(W,{children:e.jsx(d,{pt:"Resultado",en:"Results"})}),e.jsx(X,{content:e.jsx(ne,{playerCount:f})}),!!o.length&&e.jsx(V,{type:"alert",children:e.jsx(d,{pt:e.jsxs(e.Fragment,{children:["Ninguém acertou a(s) dica(s) dadas por",e.jsx(ie,{badCluesPlayersList:g}),", então ele(s) perde(m)"," ",e.jsxs(b,{type:"negative",children:["- ",f]})," pontos."]}),en:e.jsxs(e.Fragment,{children:["Nobody got the clues given by",e.jsx(ie,{badCluesPlayersList:g}),", so they lose"," ",e.jsxs(b,{type:"negative",children:["- ",f]})," points."]})})}),e.jsx(se,{grid:r,gridType:n,user:s,CellComponent:Vr,cellComponentProps:{clues:i,players:t,playerPerVotedCell:I,colorCodedCluesPerPlayer:u}}),e.jsx(E,{align:"center",children:e.jsx(Qe,{duration:Te(f,6,40,15)+5,icon:e.jsx(rr,{}),onExpire:c,onClick:c,children:e.jsx(d,{pt:"Ver Ranking",en:"See Ranking"})})}),e.jsx(Xe,{title:e.jsx(d,{pt:"Todas as respostas",en:"All Answers"}),children:e.jsx(_r,{correctCoordinatesPerPlayer:l,players:t,grid:r})})]})}function zr({players:r,playerCount:n,ranking:s,goToPreviousStep:t,round:i}){return e.jsxs(nr,{players:r,ranking:s,gainedPointsDescriptions:[e.jsx(d,{pt:"Palpites corretos",en:"Correct guesses"},"1"),e.jsx(d,{pt:"Palpites que acertaram a célula de outra dica",en:"Guesses that were placed in a cell for a different clue"},"2"),e.jsx(d,{pt:"Palpites recebidos corretamente",en:"Received correct guesses"},"3"),e.jsx(d,{pt:"Penalidade se ninguém acertou a sua dica",en:"Penalty for nobody getting your clue correctly"},"4")],children:[e.jsx(X,{content:e.jsx(ne,{playerCount:n})}),e.jsx(E,{align:"center",children:e.jsx(A,{onClick:t,children:e.jsx(d,{pt:"Ver resultado novamente",en:"See results again"})})}),e.jsx(We,{round:i})]})}function Dr({players:r,state:n}){var l;const{step:s,goToNextStep:t,goToPreviousStep:i}=U(0),c=M(r,n),o=Object.keys(r).length,a=e.jsx(k,{icon:e.jsx(Je,{}),title:e.jsx(d,{pt:"Resultado",en:"Results"}),currentRound:(l=n==null?void 0:n.round)==null?void 0:l.current,type:"overlay",children:e.jsx(ne,{playerCount:o})});return e.jsx(G,{phase:n==null?void 0:n.phase,allowedPhase:v.CRUZA_PALAVRAS.REVEAL,children:e.jsxs(_,{step:s,players:r,children:[e.jsx(qr,{user:c,grid:n.grid,gridType:n.gameType,clues:n.clues,goToNextStep:t,players:r,whoGotNoPoints:n.whoGotNoPoints??[],announcement:a}),e.jsx(zr,{players:r,playerCount:o,round:n.round,ranking:n.ranking,goToPreviousStep:i})]})})}function Hr({deck:r,onSubmitWords:n,user:s,announcement:t}){const{updateDict:i,length:c,keys:o,setDict:a}=tr({});me();const l=()=>{a(de.sampleSize(r,10).reduce((u,g)=>(u[g.id]=!0,u),{}))};return e.jsxs(B,{fullWidth:!0,announcement:t,children:[e.jsx(W,{children:e.jsx(d,{pt:"Quais cartas deveriam estar no jogo?",en:"What cards should be in the game?"})}),e.jsx(V,{type:"action",children:e.jsx(d,{pt:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Selecione"})," pelo menos 10 cartas para estar no jogo.",e.jsx("br",{}),"Quanto mais melhor!"]}),en:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Select"})," at least 10 cards to be in the game.",e.jsx("br",{}),"The more the merrier!"]})})}),e.jsxs(E,{children:[e.jsx(A,{onClick:l,size:"large",children:e.jsx(d,{pt:"Selecione pra mim",en:"Select for me"})}),e.jsx(ar,{count:c,children:e.jsx(K,{onClick:()=>n({words:o}),size:"large",disabled:c<10||s.ready,children:e.jsx(d,{pt:"Enviar cartas",en:"Submit cards"})})})]}),e.jsx(E,{className:"max-width",wrap:!0,children:r.map(u=>e.jsx(Ee,{onClick:()=>i(u.id),active:o.includes(u.id),children:e.jsx(or,{hideHeader:!0,children:u.text})},u.id))})]})}function Zr({players:r,state:n}){var a;const{step:s,setStep:t}=U(0),i=M(r,n),c=Ar(t),o=e.jsx(k,{icon:e.jsx(sr,{}),title:e.jsx(d,{pt:"Preparação da Grade",en:"Grid Setup"}),currentRound:(a=n==null?void 0:n.round)==null?void 0:a.current,type:"overlay"});return e.jsx(G,{phase:n==null?void 0:n.phase,allowedPhase:v.CRUZA_PALAVRAS.WORDS_SELECTION,children:e.jsx(_,{step:s,players:r,children:e.jsx(Hr,{deck:n.deck,onSubmitWords:c,user:i,announcement:o})})})}function Yr({state:r,players:n}){return e.jsx(cr,{state:r,players:n,announcementIcon:e.jsx(ir,{}),children:e.jsx(lr,{players:n,achievements:r.achievements,reference:ur})})}function Kr(r){if(r&&!r.phase)return Oe;switch(r.phase){case v.DEFAULT.LOBBY:return Ge;case v.DEFAULT.RULES:return ke;case v.DEFAULT.SETUP:return Me;case v.CRUZA_PALAVRAS.WORDS_SELECTION:return Zr;case v.CRUZA_PALAVRAS.CLUE_WRITING:return Wr;case v.CRUZA_PALAVRAS.GUESSING:return Gr;case v.CRUZA_PALAVRAS.REVEAL:return Dr;case v.DEFAULT.GAME_OVER:return Yr;default:return Ne}}function As(){return e.jsx(Ue,{gameCollection:Le.CRUZA_PALAVRAS,getActiveComponent:Kr})}export{As as default};
