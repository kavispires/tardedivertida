import{r as m,ae as M,af as B,bp as C,aO as T,o as w,j as a,e as R,aN as h,T as v,b1 as F}from"./index-DKlzj-i0.js";import{u as z}from"./useBlurCards-NOAAN_hI.js";import{A as S}from"./Avatar-CVH_NEgJ.js";var G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zM512 734.2c-62.1 0-112.6-50.5-112.6-112.6S449.9 509 512 509s112.6 50.5 112.6 112.6S574.1 734.2 512 734.2zm0-160.9c-26.6 0-48.2 21.6-48.2 48.3 0 26.6 21.6 48.3 48.2 48.3s48.2-21.6 48.2-48.3c0-26.6-21.6-48.3-48.2-48.3z"}}]},name:"crown",theme:"filled"},L=function(e,l){return m.createElement(M,B({},e,{ref:l,icon:G}))},y=m.forwardRef(L);function D({gainedPoint:n,order:e,description:l}){const c=n>0,o=n<0;return a.jsx("li",{className:R("ranking-board__gained-point",c&&"ranking-board__gained-point--plus",o&&"ranking-board__gained-point--minus",`ranking-board__gained-point--${e}`),children:a.jsxs(h,{title:l??a.jsx(v,{pt:"Pontos ganhos",en:"Gained Points"}),color:c?"gold":o?"red":"gray",children:[c?"+":"",n]})})}function P({gainedPoints:n,playerId:e,gainedPointsDescriptions:l=[]}){const c=Array.isArray(n)?n:[n];return a.jsx("ul",{className:"ranking-board__cell-gained-points",children:c.map((o,d)=>a.jsx(D,{gainedPoint:o,order:d,description:l[d]},`gained-point-${e}-${d}`))})}function J({players:n,ranking:e,gainedPointsDescriptions:l,hideGainedPoints:c=!1,delay:o=0}){const[d,j]=m.useState(0),[b,I]=m.useState([]),[f,A]=m.useState(0),[E,{height:N}]=C(),$=m.useMemo(()=>Math.max(...e.map(_=>_.newScore)),[e]),{seconds:x}=z({duration:5+o,autoStart:!0,onExpire:()=>{A(1),j(3)}});return T(()=>{const _={};let p=0,s=0;const g=w.orderBy(e,["newScore","name"],["desc","asc"]).reduce((i,t,r)=>(i[t.playerId]=r,(s===0||t.newScore<s)&&(s=t.newScore,p+=1),_[t.playerId]=[0,p],i),{}),k=w.orderBy(e,["previousScore","name"],["desc","asc"]);p=0,s=0;const u=k.map((i,t)=>{const r={...i};return r.order=[t,g[r.playerId]],r.position=_[r.playerId],(s===0||i.previousScore<s)&&(s=i.previousScore,p+=1),r.position[0]=p,r});I(u)}),m.useEffect(()=>{x===4+o?j(1):x===2+o&&j(2)},[x,o]),a.jsxs("div",{className:R("ranking-board",x>4&&"ranking-board--hidden",x===4&&F("fadeIn")),style:{height:`${(Math.max(60,N)+8)*b.length}px`},children:[a.jsxs("div",{className:"ranking-board__row",id:"ranking-row-placeholder",style:{opacity:0},ref:E,children:[a.jsx("div",{className:"ranking-board__cell-crown",children:a.jsx(y,{className:"ranking-board__crown-icon"})}),a.jsx("div",{className:"ranking-board__cell-position",children:"#0"}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(S,{id:"A"})}),a.jsx("div",{className:"ranking-board__name",children:"Placeholder"})]}),a.jsx(h,{title:a.jsx(v,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:"0"})}),a.jsx(P,{gainedPoints:0,playerId:"A"}),a.jsx(h,{title:"Total",color:"gold",children:a.jsx("span",{className:"ranking-board__cell-points-total",children:"0"})})]}),b.map((_,p)=>{const{playerId:s,newScore:g,previousScore:k,gainedPoints:u,order:i,position:t}=_,r=(Math.max(60,N)+8)*(i[f]??0);return a.jsxs("div",{className:`ranking-board__row ranking-board__row--${p}`,style:{top:`${r}px`},children:[a.jsx("div",{className:"ranking-board__cell-crown",children:g>0&&$===g&&d>=3&&a.jsx(y,{className:"ranking-board__crown-icon"})}),a.jsxs("div",{className:"ranking-board__cell-position",children:["#",t[f]??""]}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(S,{id:n[s].avatarId})}),a.jsx("div",{className:"ranking-board__name",children:n[s].name})]}),a.jsx(h,{title:a.jsx(v,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:k})}),!c&&d>=1&&u!==void 0&&a.jsx(P,{gainedPoints:u,playerId:s,gainedPointsDescriptions:l}),a.jsx(h,{title:"Total",color:"gold",children:d>=2?a.jsx("span",{className:"ranking-board__cell-points-total",children:g}):a.jsx("span",{className:"ranking-board__cell-points-total-preliminary",children:g})})]},`ranking-${s}`)})]})}export{J as R,y as a};
