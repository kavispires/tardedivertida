import{r as h,aF as f,a7 as v,h as ne,j as e,T as c,q as te,b8 as ye,n as E,e as w,x as we,aQ as H,B as F,cY as be,cZ as Se,b3 as Ie,N as Ce,D as Pe,l as re,F as N,k as Ne,ch as se,bM as Te,I as V,aP as Fe,a_ as Me}from"./index-DvppfgRv.js";import{u as oe,S as L,a as $,P as W,f as Re,c as Ae,d as Ee,e as Le}from"./Session-X-N4hf4T.js";import{u as G}from"./useWhichPlayerIsThe-0rWO1mLA.js";import{B as ae,C as y,M as Oe,b as ze,a as ke}from"./MapCityZonesIcon-Dzn8JX1K.js";import{P as b}from"./PlayerAvatarName-DErJPECv.js";import{S as O,P as _,a as q,u as Be}from"./StepSwitcher-GRRK4efZ.js";import{I as M}from"./useDevFeatures-w3W2BPgK.js";import{R as He}from"./RoundAnnouncement-Cy0tFB_F.js";import{V as Ve}from"./ViewOr-Bx1kDirb.js";import{u as ie}from"./useMock-Dswnhv6P.js";import{D as ce}from"./DevButton-CBSInJNz.js";import{T as U}from"./TurnOrder-vsaDFCJg.js";import{c as De,d as $e,R as z}from"./RuleInstruction-Ce3WP52S.js";import{M as le}from"./MetricHighlight-g7-kGe_z.js";import{a as We,u as Ge,b as _e,c as qe,D as Ue,P as Ze}from"./DragAndDrop-BIsX7cBA.js";import{T as Je,a as Qe,u as de,R as Xe}from"./index.esm-51n1qmoB.js";import{R as Ye}from"./QuestionCircleFilled-B_m4Rgvy.js";import{R as Ke}from"./StarFilled-ux0NNX7L.js";import{T as J}from"./index-qRlSqIqu.js";import{V as Q}from"./ViewIf-qgMpzyEs.js";import{u as en}from"./SlideShowControls-BdwCSiMn.js";import{P as I}from"./PointsHighlight-Bs0aLT2D.js";import{A as nn}from"./ArrowIcon-Dd25FytS.js";import{C as tn}from"./CrownIcon-Cjo0U_sz.js";import{X as rn}from"./XIcon-DuLKtO6M.js";import{S as X}from"./StarPoints-Dx2IGpJe.js";import{S as sn}from"./SlideShow-DyLLJosC.js";import{S as D,a as Y,b as K,c as on}from"./SlideShowComposableComponents-DuisViol.js";import{S as an}from"./StepRankingWrapper-D5F24iM0.js";import{F as cn}from"./FlagIcon-BhODe2S6.js";import"./GameBanner-sa2yhoJA.js";import{G as ln}from"./GameOverWrapper-BPyd_8y0.js";import{A as dn}from"./Achievements-D9TRJ4BY.js";import{T as hn}from"./TitledContainer-C0jb369F.js";import{a as mn}from"./achievements-_n9E3c3J.js";import"./Game-Ch5JUYDX.js";import"./useMutation-CdsDiU7r.js";import"./speech-DB2TJQrk.js";import"./index-B6lvJW0z.js";import"./index-Bk4RdLjp.js";import"./Overflow-CZZSli7j.js";import"./PurePanel-C9S70P0-.js";import"./index-JzbJh84j.js";import"./index-nROAR8Mh.js";import"./PlayerAvatar-4I-LnJ6Z.js";import"./DebugOnly-f-8UdT-g.js";import"./RulesModal-BupD63Bo.js";import"./WritingIcon-DQQLo40-.js";import"./useTDBaseUrl-BF9foKiS.js";import"./index-DF_wMmXU.js";import"./index-BsP26atl.js";import"./useBubbleLock-CKJopiFI.js";import"./InfoCircleOutlined-BXVUvu-2.js";import"./useToggle-DTgQq2Yy.js";import"./index-Dpp6_Nt0.js";import"./SignIn-DdSI9y1n.js";import"./GoogleIcon-3W4a7kM5.js";import"./AnimatedGearIcon-B24Zs_ID.js";import"./AnimatedClockIcon-D32Srta7.js";import"./TimedButton-CI7WX-Lk.js";import"./Loading-BIZ_exdO.js";import"./AnimatedLoaderIcon-D7DW2oqt.js";import"./WaitingRoomIcon-Cr_Gt9Nn.js";import"./LikeFilled-B_cr3hlL.js";import"./StepBackwardOutlined-Bk-ZPjeh.js";import"./TrophyOutlined-GJ8W9mNT.js";import"./StarIcon-BiKTXYQ2.js";import"./GarbageIcon-mj8kw1c5.js";import"./RankingBoard-DS2XfLZ2.js";import"./CaretUpOutlined-TvuZELu9.js";import"./TheEndIcon-Cr396Q8e.js";import"./ArrowRightOutlined-B_l1V0lD.js";import"./progress-DAcelAuX.js";import"./Medal-CrePrlMI.js";var un={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M894 462c30.9 0 43.8-39.7 18.7-58L530.8 126.2a31.81 31.81 0 00-37.6 0L111.3 404c-25.1 18.2-12.2 58 18.8 58H192v374h-72c-4.4 0-8 3.6-8 8v52c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-52c0-4.4-3.6-8-8-8h-72V462h62zM381 836H264V462h117v374zm189 0H453V462h117v374zm190 0H642V462h118v374z"}}]},name:"bank",theme:"filled"},pn=function(t,r){return h.createElement(f,v({},t,{ref:r,icon:un}))},jn=h.forwardRef(pn),xn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M811.4 418.7C765.6 297.9 648.9 212 512.2 212S258.8 297.8 213 418.6C127.3 441.1 64 519.1 64 612c0 110.5 89.5 200 199.9 200h496.2C870.5 812 960 722.5 960 612c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud",theme:"filled"},gn=function(t,r){return h.createElement(f,v({},t,{ref:r,icon:xn}))},fn=h.forwardRef(gn),vn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 128c-212.1 0-384 171.9-384 384v360c0 13.3 10.7 24 24 24h184c35.3 0 64-28.7 64-64V624c0-35.3-28.7-64-64-64H200v-48c0-172.3 139.7-312 312-312s312 139.7 312 312v48H688c-35.3 0-64 28.7-64 64v208c0 35.3 28.7 64 64 64h184c13.3 0 24-10.7 24-24V512c0-212.1-171.9-384-384-384z"}}]},name:"customer-service",theme:"filled"},yn=function(t,r){return h.createElement(f,v({},t,{ref:r,icon:vn}))},wn=h.forwardRef(yn),bn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M218.9 636.3l42.6 26.6c.1.1.3.2.4.3l12.7 8 .3.3a186.9 186.9 0 0094.1 25.1c44.9 0 87.2-15.7 121-43.8a256.27 256.27 0 01164.9-59.9c52.3 0 102.2 15.7 144.6 44.5l7.9 5-111.6-289V179.8h63.5c4.4 0 8-3.6 8-8V120c0-4.4-3.6-8-8-8H264.7c-4.4 0-8 3.6-8 8v51.9c0 4.4 3.6 8 8 8h63.5v173.6L218.9 636.3zm333-203.1c22 0 39.9 17.9 39.9 39.9S573.9 513 551.9 513 512 495.1 512 473.1s17.9-39.9 39.9-39.9zM878 825.1l-29.9-77.4-85.7-53.5-.1.1c-.7-.5-1.5-1-2.2-1.5l-8.1-5-.3-.3c-29-17.5-62.3-26.8-97-26.8-44.9 0-87.2 15.7-121 43.8a256.27 256.27 0 01-164.9 59.9c-53 0-103.5-16.1-146.2-45.6l-28.9-18.1L146 825.1c-2.8 7.4-4.3 15.2-4.3 23 0 35.2 28.6 63.8 63.8 63.8h612.9c7.9 0 15.7-1.5 23-4.3a63.6 63.6 0 0036.6-82.5z"}}]},name:"experiment",theme:"filled"},Sn=function(t,r){return h.createElement(f,v({},t,{ref:r,icon:bn}))},In=h.forwardRef(Sn),Cn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M160 894c0 17.7 14.3 32 32 32h286V550H160v344zm386 32h286c17.7 0 32-14.3 32-32V550H546v376zm334-616H732.4c13.6-21.4 21.6-46.8 21.6-74 0-76.1-61.9-138-138-138-41.4 0-78.7 18.4-104 47.4-25.3-29-62.6-47.4-104-47.4-76.1 0-138 61.9-138 138 0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v140h366V310h68v172h366V342c0-17.7-14.3-32-32-32zm-402-4h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70 70 31.4 70 70v70zm138 0h-70v-70c0-38.6 31.4-70 70-70s70 31.4 70 70-31.4 70-70 70z"}}]},name:"gift",theme:"filled"},Pn=function(t,r){return h.createElement(f,v({},t,{ref:r,icon:Cn}))},Nn=h.forwardRef(Pn),Tn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M946.5 505L534.6 93.4a31.93 31.93 0 00-45.2 0L77.5 505c-12 12-18.8 28.3-18.8 45.3 0 35.3 28.7 64 64 64h43.4V908c0 17.7 14.3 32 32 32H448V716h112v224h265.9c17.7 0 32-14.3 32-32V614.3h43.4c17 0 33.3-6.7 45.3-18.8 24.9-25 24.9-65.5-.1-90.5z"}}]},name:"home",theme:"filled"},Fn=function(t,r){return h.createElement(f,v({},t,{ref:r,icon:Tn}))},Mn=h.forwardRef(Fn),Rn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M839.2 278.1a32 32 0 00-30.4-22.1H736V144c0-17.7-14.3-32-32-32H320c-17.7 0-32 14.3-32 32v112h-72.8a31.9 31.9 0 00-30.4 22.1L112 502v378c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V502l-72.8-223.9zM660 628c0 4.4-3.6 8-8 8H544v108c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V636H372c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h108V464c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v108h108c4.4 0 8 3.6 8 8v48zm4-372H360v-72h304v72z"}}]},name:"medicine-box",theme:"filled"},An=function(t,r){return h.createElement(f,v({},t,{ref:r,icon:Rn}))},En=h.forwardRef(An),Ln={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M882 272.1V144c0-17.7-14.3-32-32-32H174c-17.7 0-32 14.3-32 32v128.1c-16.7 1-30 14.9-30 31.9v131.7a177 177 0 0014.4 70.4c4.3 10.2 9.6 19.8 15.6 28.9v345c0 17.6 14.3 32 32 32h274V736h128v176h274c17.7 0 32-14.3 32-32V535a175 175 0 0015.6-28.9c9.5-22.3 14.4-46 14.4-70.4V304c0-17-13.3-30.9-30-31.9zm-72 568H640V704c0-17.7-14.3-32-32-32H416c-17.7 0-32 14.3-32 32v136.1H214V597.9c2.9 1.4 5.9 2.8 9 4 22.3 9.4 46 14.1 70.4 14.1s48-4.7 70.4-14.1c13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 3-1.3 6-2.6 9-4v242.2zm0-568.1H214v-88h596v88z"}}]},name:"shop",theme:"filled"},On=function(t,r){return h.createElement(f,v({},t,{ref:r,icon:Ln}))},zn=h.forwardRef(On),kn={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 192a32 32 0 0132 32v160h174.81a32 32 0 0126.68 14.33l113.19 170.84a32 32 0 015.32 17.68V672a32 32 0 01-32 32h-96c0 70.7-57.3 128-128 128s-128-57.3-128-128H384c0 70.7-57.3 128-128 128s-128-57.3-128-128H96a32 32 0 01-32-32V224a32 32 0 0132-32zM256 640a64 64 0 000 128h1.06A64 64 0 00256 640m448 0a64 64 0 000 128h1.06A64 64 0 00704 640m93.63-192H640v145.12A127.43 127.43 0 01704 576c47.38 0 88.75 25.74 110.88 64H896v-43.52zM500 448H332a12 12 0 00-12 12v40a12 12 0 0012 12h168a12 12 0 0012-12v-40a12 12 0 00-12-12M308 320H204a12 12 0 00-12 12v40a12 12 0 0012 12h104a12 12 0 0012-12v-40a12 12 0 00-12-12"}}]},name:"truck",theme:"filled"},Bn=function(t,r){return h.createElement(f,v({},t,{ref:r,icon:kn}))},Hn=h.forwardRef(Bn);const C={PLANNING:"PLANNING",PLACING:"PLACING",RESOLUTION:"RESOLUTION"},he={SUBMIT_PLANNING:"SUBMIT_PLANNING",SUBMIT_PLACEMENTS:"SUBMIT_PLACEMENTS"},Vn=8;function Dn(n){const{translate:t}=ne(),r=oe({actionName:"submit-planning",onSuccess:()=>n(2),onError:()=>n(0),successMessage:t("Planejamento submetido com sucesso","Planning submitted successfully"),errorMessage:t("Vixi, o aplicativo encontrou um erro ao tentar enviar seu planejamento","Oops, the application found an error while trying to submit your planning")});return a=>{r({action:he.SUBMIT_PLANNING,...a})}}function $n(n){const{translate:t}=ne(),r=oe({actionName:"submit-placing",onSuccess:()=>n(2),onError:()=>n(0),successMessage:t("Construção submetida com sucesso","Construction submitted successfully"),errorMessage:t("Vixi, o aplicativo encontrou um erro ao tentar enviar sua construção","Oops, the application found an error while trying to submit your construction")});return a=>{r({action:he.SUBMIT_PLACEMENTS,...a})}}function Wn(){return e.jsx(c,{pt:e.jsx(e.Fragment,{children:"Fazemos parte do comitê de planejamento urbano da cidade e somos responsáveis por decidir onde novos prédios e estabelecimentos serão construídos. Em cada rodada, um jogador assumirá o papel de engenheiro-chefe, encarregado de planejar as melhores localizações para as novas construções."}),en:e.jsx(e.Fragment,{children:"We are part of the city's urban planning committee and are responsible for deciding where new buildings and establishments will be built. In each round, a player will take on the role of lead engineer, responsible for planning the best locations for new constructions"})})}function me(n,t){const r=te.shuffle(Array.from({length:n},(a,s)=>ye[s]));return t.reduce((a,s,o)=>(a[s]=r[o],a),{})}const ue=n=>E(n+2,{maxWidth:300,gap:16}),pe=n=>{const[t,r]=h.useState({}),a=o=>{r(i=>{const l={...i},d=new Set(Object.values(l));for(const[j,u]of Object.entries(o))if(d.has(u)){const m=Object.keys(l).find(p=>l[p]===u);m&&delete l[m]}return{...l,...o}})},s=Object.keys(t).length===n.length&&new Set(Object.values(t)).size===n.length;return{playerSelections:t,updatePlayerSelections:a,setPlayerSelections:r,isComplete:s}};function R({children:n}){return e.jsx(le,{icon:e.jsx(ae,{}),children:n})}function P({children:n}){return e.jsx(le,{icon:e.jsx(y,{}),children:n})}const A=n=>({A:"green",B:"red",C:"yellow",D:"purple"})[n]??"gray";function je({maxWidth:n,maxHeight:t,grid:r,cellComponent:a,className:s,contentClassName:o,contentStyle:i={},cellProps:l,transformWrapperProps:d,hideControls:j=!1,additionalContent:u}){const m=a,{initialScale:p=1,minScale:g=.25,maxScale:x=4,wheel:S={step:.5},centerOnInit:B=!0,centerZoomedOut:fe=!0,...ve}=d??{};return e.jsx("div",{className:w("grid-map-container"),children:e.jsx(Je,{initialScale:p,minScale:g,maxScale:x,wheel:S,centerOnInit:B,centerZoomedOut:fe,...ve,children:e.jsxs(h.Fragment,{children:[!j&&e.jsx(ee,{position:"top"}),u,e.jsx(Qe,{wrapperClass:w("grid-map-wrapper",s),wrapperStyle:{maxWidth:n,maxHeight:t},contentClass:w("grid-map",o),contentStyle:{display:"grid",gridTemplateColumns:`repeat(${r.width}, 1fr)`,gridTemplateRows:`repeat(${r.height}, 1fr)`,...i},children:r.cells.map(Z=>e.jsx(m,{cell:Z,grid:r,cellProps:l},Z.id))}),!j&&e.jsx(ee,{position:"bottom"})]})})})}function ee({position:n}){const{zoomIn:t,zoomOut:r,resetTransform:a,centerView:s}=de();return e.jsxs(we.Compact,{size:"small",className:w("grid-map-controls",`grid-map-controls--${n}`),children:[e.jsx(H,{title:"Zoom In",placement:n,children:e.jsx(F,{onClick:()=>t(),children:e.jsx(be,{})})}),e.jsx(H,{title:"Zoom Out",placement:n,children:e.jsx(F,{onClick:()=>r(),children:e.jsx(Se,{})})}),e.jsx(H,{title:"Reset",placement:n,children:e.jsx(F,{onClick:()=>{a(),setTimeout(()=>{s()},200)},children:e.jsx(Xe,{})})})]})}function T({locationId:n,cityLocationsDict:t,width:r,className:a,fontSize:s}){const o=t?.[n];return e.jsx("div",{className:w("city-site city-site--constructed",a),style:{width:r,height:r,backgroundImage:`url('${Ie.IN_GAME}city-image.jpg')`},children:e.jsxs("span",{children:[e.jsx("div",{className:"city-site-category",children:Gn(o.category)}),e.jsx(Ce.Text,{className:w("city-site-name",`city-site-name--${s}`),children:e.jsx(Pe,{children:o.name})})]})})}const Gn=n=>{switch(n){case"Accommodation":return e.jsx(Nn,{});case"Government":return e.jsx(jn,{});case"Commercial":return e.jsx(zn,{});case"Cultural":return e.jsx($e,{});case"Education":return e.jsx(De,{});case"Entertainment":return e.jsx(wn,{});case"Industrial":return e.jsx(In,{});case"Infrastructure":return e.jsx(En,{});case"Natural":return e.jsx(fn,{});case"Residential":return e.jsx(Mn,{});case"Transportation":return e.jsx(Hn,{});case"Special":return e.jsx(Ke,{});default:return e.jsx(Ye,{})}};function xe({cell:n,cellProps:t}){const{cityLocationsDict:r={},mapEvaluations:a={},dragAndDropEnabled:s=!1}=t??{},o={width:t?.cellWidth,height:t?.cellWidth},i=h.useMemo(()=>te.invert(a),[a]);if(!n.data)return e.jsx("div",{style:o,className:"city-site city-site--unavailable",children:e.jsx("span",{style:{opacity:0},children:"."})});if(n.data?.locationId)return e.jsx("div",{style:o,id:`cell-${n.id}`,children:e.jsx(T,{locationId:n.data.locationId,cityLocationsDict:r,width:Number(o.width??75)})});if(n.data?.coneId){const l=n.data.coneId,d=A(l),j=i[l];return s?e.jsx(We,{id:n.data.coneId,options:{withTransition:!0},className:"city-site--droppable-area",children:e.jsxs("div",{style:o,className:"city-site",id:`cell-${n.id}`,children:[j&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"city-site--temp-construction-cone",children:e.jsx(y,{color:d,width:32})}),e.jsx(T,{locationId:j,cityLocationsDict:r,width:Number(o.width??75),className:w("city-site--temp-construction",`city-site--temp-construction-${n.data?.coneId}`)})]}),e.jsxs("div",{className:"city-site-available",children:[e.jsx(y,{color:d,width:64}),e.jsx(J,{color:d,children:n.data.coneId??"U"})]})]})}):e.jsxs("div",{style:o,className:"city-site",id:`cell-${n.id}`,children:[j&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"city-site--temp-construction-cone",children:e.jsx(y,{color:d,width:32})}),e.jsx(T,{locationId:j,cityLocationsDict:r,width:Number(o.width??75),className:w("city-site--temp-construction",`city-site--temp-construction-${n.data?.coneId}`)})]}),e.jsxs("div",{className:"city-site-available",children:[e.jsx(y,{color:d,width:64}),e.jsx(J,{color:d,children:n.data.coneId??"U"})]})]})}return e.jsx("div",{style:o,id:`cell-${n.id}`,className:"city-site city-site--unavailable",children:e.jsx("span",{style:{opacity:0},children:"."})})}function k({city:n,cityLocationsDict:t,mapEvaluations:r,dragAndDropEnabled:a}){const s=re(),o=ue(n.width),i=Math.min(s.width,s.height)*.85;return e.jsx(je,{maxWidth:i,maxHeight:i,grid:n,transformWrapperProps:{initialScale:.5},cellComponent:xe,cellProps:{cellWidth:o,cityLocationsDict:t,mapEvaluations:r,dragAndDropEnabled:a}})}function ge({city:n,cityLocationsDict:t,availableProjectsIds:r,constructionWidth:a,playerSelections:s,updatePlayerSelections:o,title:i,children:l}){const d=Ge(_e(Ze,{activationConstraint:{distance:8}})),j=h.useCallback(u=>{const{active:m,over:p}=u;if(p&&m.id!==p.id){const g=String(m.id),x=String(p.id);o({[g]:x})}},[o]);return e.jsx(qe,{sensors:d,onDragEnd:j,children:e.jsxs("div",{className:"city-map-actions-container",children:[e.jsx(k,{city:n,cityLocationsDict:t,mapEvaluations:s,dragAndDropEnabled:!0}),e.jsxs(N,{className:"contained",vertical:!0,children:[e.jsx(Ne,{level:5,size:"xx-small",icon:e.jsx(ae,{}),children:i}),e.jsx(N,{justify:"center",vertical:!0,className:"my-2",gap:6,children:l}),e.jsx(N,{justify:"center",className:"mt-2",gap:6,vertical:!0,children:r.map(u=>{const m=s[u],p=A(m);return e.jsxs(N,{vertical:!0,align:"center",className:"u-location-card-draggable-container",children:[!!m&&e.jsx("span",{className:"u-location-card-selected-cone",children:e.jsx(y,{color:p,width:32})}),e.jsx(Ue,{id:u,className:"u-location-card-draggable",options:{dragOpacity:.8,dragScale:.85,dragRotate:-6,withTransition:!0},children:e.jsx(T,{locationId:u,cityLocationsDict:t,width:a})})]},u)})})]})]})})}function _n({players:n,announcement:t,gameOrder:r,architectId:a,availableProjectsIds:s,city:o,cityLocationsDict:i,placements:l,onSubmitPlanning:d}){const j=E(l+5,{maxWidth:128}),{playerSelections:u,setPlayerSelections:m,updatePlayerSelections:p,isComplete:g}=pe(s);ie();const x=()=>{m(me(l,s))};return e.jsxs(O,{fullWidth:!0,announcement:t,children:[e.jsx(L,{size:"small",children:e.jsx(c,{pt:e.jsxs(e.Fragment,{children:["Decida onde as ",s.length," novos projetos devem ser construídos"]}),en:e.jsxs(e.Fragment,{children:["Decide where the ",s.length," new projects should be built"]})})}),e.jsx(z,{type:"action",children:e.jsx(c,{pt:e.jsxs(e.Fragment,{children:["No mapa, existem ",e.jsxs(P,{children:[l," cones"]})," representando onde as terrenos onde os projetos podem ser feitos.",e.jsx("br",{}),"À direita, você tem os"," ",e.jsxs(R,{children:[s.length," projetos"]}),", em segredo, decida qual projeto vai para qual cone.",e.jsx("br",{}),"Arraste o projeto para o cone desejado. Para remove um projeto de um cone, baste clicar nele."]}),en:e.jsxs(e.Fragment,{children:["On the map, there are ",e.jsxs(P,{children:[l," cones"]})," representing the land where the projects can be built.",e.jsx("br",{}),"On the right of the screen, you have"," ",e.jsxs(R,{children:[s.length," projects"]}),", in secret, decide which project goes to which cone.",e.jsx("br",{})," Drag the project to the desired cone. To remove a project from a cone, just click on it."]})})}),e.jsxs(ge,{city:o,cityLocationsDict:i,availableProjectsIds:s,constructionWidth:j,playerSelections:u,updatePlayerSelections:p,title:e.jsx(c,{pt:"Novos Projetos",en:"New Projects"}),children:[e.jsx(se,{type:"primary",size:"large",disabled:!g,onClick:()=>d({planning:u}),children:e.jsx(c,{pt:"Confirmar",en:"Confirm"})}),e.jsx(ce,{size:"small",onClick:x,children:"Mock"})]}),e.jsx(U,{players:n,activePlayerId:a,order:r})]})}function qn({announcement:n,players:t,gameOrder:r,architect:a,city:s,cityLocationsDict:o,placements:i}){return e.jsxs(O,{fullWidth:!0,announcement:n,children:[e.jsx(L,{size:"small",wait:!0,children:e.jsx(c,{pt:e.jsxs(e.Fragment,{children:[e.jsx(b,{player:a})," está planejando a cidade."]}),en:e.jsxs(e.Fragment,{children:[e.jsx(b,{player:a})," is planning the city."]})})}),e.jsx(z,{type:"wait",children:e.jsx(c,{pt:e.jsxs(e.Fragment,{children:["No mapa, existem ",e.jsxs(P,{children:[i," cones"]})," representando onde as terrenos onde projetos podem ser construídos.",e.jsx("br",{}),"Aguarde enquanto o engenheiro chefe planeja a cidade."]}),en:e.jsxs(e.Fragment,{children:["On the map, there are ",e.jsxs(P,{children:[i," cones"]})," representing the land where projects can be built.",e.jsx("br",{}),"Wait while the lead engineer plans the city."]})})}),e.jsx(k,{city:s,cityLocationsDict:o}),e.jsx(U,{players:t,activePlayerId:a.id,order:r})]})}function Un({state:n,players:t}){const{step:r,goToNextStep:a,setStep:s}=$(),[o,i]=G("architectId",n,t),l=Dn(s),d=e.jsx(_,{icon:e.jsx(Oe,{}),title:e.jsx(c,{pt:"Planejamento",en:"Planning"}),currentRound:n?.round?.current,type:"overlay",children:e.jsxs(M,{children:[e.jsx(Wn,{}),e.jsx("br",{}),e.jsx(c,{pt:e.jsxs(e.Fragment,{children:["Para essa rodada, ",e.jsx(b,{player:o,addressUser:!0})," é o engenheiro chefe."]}),en:e.jsxs(e.Fragment,{children:["In this round, ",e.jsx(b,{player:o,addressUser:!0})," is the lead engineer."]})})]})});return e.jsx(W,{phase:n?.phase,allowedPhase:C.PLANNING,children:e.jsxs(q,{step:r,players:t,children:[e.jsx(He,{round:n.round,onPressButton:a,time:3,children:e.jsx(M,{contained:!0,children:e.jsx(c,{pt:"Somos arquitetos e urbanistas, e estamos planejando a cidade!",en:"We are architects and urban planners, and we are planning a city!"})})}),e.jsxs(Ve,{condition:i,children:[e.jsx(_n,{announcement:d,players:t,architectId:n.architectId,gameOrder:n.gameOrder,city:n.city,cityLocationsDict:n.cityLocationsDict,placements:Object.keys(n.coneCellIds).length,availableProjectsIds:n.availableProjectsIds,onSubmitPlanning:l}),e.jsx(qn,{announcement:d,players:t,gameOrder:n.gameOrder,architect:o,city:n.city,cityLocationsDict:n.cityLocationsDict,placements:Object.keys(n.coneCellIds).length})]})]})})}function Zn({players:n,announcement:t,gameOrder:r,availableProjectsIds:a,isTheArchitect:s,architect:o,city:i,cityLocationsDict:l,placements:d,planning:j,onSubmitConstruction:u}){const m=E(d+5,{maxWidth:128}),{playerSelections:p,setPlayerSelections:g,updatePlayerSelections:x,isComplete:S}=pe(a),B=()=>{g(me(d,a))};return ie(),e.jsxs(O,{fullWidth:!0,announcement:t,children:[e.jsx(L,{size:"small",wait:s,children:s?e.jsx(c,{en:e.jsx(e.Fragment,{children:"Wait while the players try to match where each project should go with your planning."}),pt:e.jsx(e.Fragment,{children:"Aguarde enquanto os jogadores tentam fazer cada projeto deve ir de acordo com seu planejamento."})}):e.jsx(c,{pt:e.jsx(e.Fragment,{children:"Decida onde cada projeto deve ir"}),en:e.jsx(e.Fragment,{children:"Decide where each project should go"})})}),e.jsx(z,{type:s?"wait":"action",children:e.jsx(c,{pt:e.jsxs(e.Fragment,{children:["No mapa, existem ",e.jsxs(P,{children:[d," cones"]})," representando onde as terrenos onde os projetos podem ser feitos. ",e.jsx("br",{}),"O objetivo é fazer as construções de acordo com o que",e.jsx(b,{player:o})," planejou."]}),en:e.jsxs(e.Fragment,{children:["On the map, there are ",e.jsxs(P,{children:[d," cones"]})," representing the land where the projects can be built. ",e.jsx("br",{}),"The goal is to make the constructions according to what",e.jsx(b,{player:o})," planned."]})})}),e.jsx(Q,{condition:s,children:e.jsx(k,{city:i,cityLocationsDict:l,mapEvaluations:j})}),e.jsx(Q,{condition:!s,children:e.jsxs(ge,{city:i,cityLocationsDict:l,availableProjectsIds:a,constructionWidth:m,playerSelections:p,updatePlayerSelections:x,title:e.jsx(c,{pt:"Projetos",en:"Projects"}),children:[e.jsx(se,{type:"primary",size:"large",disabled:!S,onClick:()=>u({evaluations:p}),children:e.jsx(c,{pt:"Confirmar",en:"Confirm"})}),e.jsx(ce,{size:"small",onClick:B,children:"Mock"})]})}),e.jsx(U,{players:n,activePlayerId:o.id,order:r})]})}function Jn({state:n,players:t}){const{step:r,setStep:a}=$(),[s,o]=G("architectId",n,t),i=$n(a),l=e.jsx(_,{icon:e.jsx(ze,{}),title:e.jsx(c,{pt:"Construção",en:"Construction"}),currentRound:n?.round?.current,type:"overlay",children:e.jsx(M,{children:e.jsx(c,{pt:e.jsx(e.Fragment,{children:"Agora, é hora de colocar as construções de acordo com o planejamento do engenheiro chefe."}),en:e.jsx(e.Fragment,{children:"Now, it's time to place the buildings according to the lead engineer's planning."})})})});return e.jsx(W,{phase:n?.phase,allowedPhase:C.PLACING,children:e.jsx(q,{step:r,players:t,children:e.jsx(Zn,{announcement:l,players:t,architect:s,gameOrder:n.gameOrder,city:n.city,cityLocationsDict:n.cityLocationsDict,placements:Object.keys(n.coneCellIds).length,availableProjectsIds:n.availableProjectsIds,onSubmitConstruction:i,planning:n.planning??{},isTheArchitect:o})})})}function Qn({city:n,cityLocationsDict:t,mapEvaluations:r,height:a,width:s,focusedCellId:o}){const i=re(),l=ue(n.width);return e.jsx(je,{maxWidth:Math.min(a,i.width/2),maxHeight:Math.min(s,i.height/2),grid:n,cellComponent:xe,cellProps:{cellWidth:l,cityLocationsDict:t,mapEvaluations:r},additionalContent:e.jsx(Xn,{focusedCellId:o})})}function Xn({focusedCellId:n}){const{zoomToElement:t}=de();return h.useEffect(()=>{n&&t(`cell-${n}`,1.1)},[n]),null}function Yn({architect:n,city:t,cityLocationsDict:r,placements:a,gallery:s,slideShowConfig:o,players:i}){Be();const[l,{width:d,height:j}]=Te(),u=E(a+5,{maxWidth:256}),m=s[o.slideIndex],p=A(m.coneId);return e.jsxs(O,{fullWidth:!0,children:[e.jsx(L,{size:"small",children:e.jsx(c,{pt:"Construções",en:"Constructions"})}),e.jsxs(sn,{config:o,barColor:p,leftClassName:"pu-gallery__map",rightClassName:"pu-gallery__info",nextButtonProps:{children:e.jsx(c,{pt:"Ver Resultado",en:"See Results"})},children:[e.jsx("div",{style:{height:"100%"},ref:l,children:e.jsx(Qn,{city:t,cityLocationsDict:r,width:Math.max(d,200),height:Math.max(j,200),focusedCellId:m.correctCellId})}),e.jsxs("div",{children:[e.jsxs(D,{children:[e.jsx(c,{pt:"Projeto para o engenheiro chefe",en:"Project for the lead engineer"}),e.jsx(b,{player:n})]}),e.jsxs(N,{gap:12,align:"center",children:[e.jsx(T,{locationId:m.locationId,cityLocationsDict:r,width:u,fontSize:"small"}),e.jsx(V,{icon:e.jsx(nn,{}),size:48}),e.jsx(y,{color:p,width:u/2})]}),m.correctPlayersIds.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(D,{children:[e.jsx(V,{icon:e.jsx(tn,{}),size:"small"})," ",e.jsx(c,{pt:"Pedreiros Corretos",en:"Correct Builders"})]}),e.jsxs(Y,{winner:!0,extra:e.jsx(X,{quantity:2,hideText:!0,keyPrefix:"correct"}),children:[e.jsx(c,{pt:"A gente sabe o que tá fazendo!",en:"We know what we're doing!"})," "]}),e.jsx(K,{players:i,playersIds:m.correctPlayersIds})]}),Object.keys(m.playersSay).length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(D,{style:{marginTop:"1em"},children:[e.jsx(V,{icon:e.jsx(rn,{}),size:"small"})," ",e.jsx(c,{pt:"Decisão Erradas dos Pedreiros",en:"Builders' Wrong Decisions"})]}),Object.entries(m.playersSay).map(([g,x])=>{const S=A(g);return e.jsxs("div",{className:"mb-2",children:[e.jsxs(Y,{color:S,extra:x.length>1&&e.jsx(X,{quantity:x.length-1,hideText:!0,keyPrefix:"bonus"}),children:[e.jsx(c,{pt:"Prefiro construir no local",en:"I prefer building in the site"}),":"," ",e.jsx(y,{color:S,width:16})]}),e.jsx(K,{players:i,playersIds:x})]},g)})]}),m.architectPoints===0&&e.jsx(on,{children:e.jsx(c,{pt:"O prefeito apelou e vai colocar essa construção num local aleatório.",en:"The mayor overruled and will place this construction in a random location."})})]})]})]})}function Kn({players:n,ranking:t,goToPreviousStep:r,round:a,gallery:s}){const o=h.useMemo(()=>s.filter(i=>i.correctPlayersIds.length===0).length,[s]);return e.jsxs(an,{players:n,ranking:t,gainedPointsDescriptions:[e.jsx(c,{pt:"Acertou o planejamento do arquiteto",en:"Match the architect's plan"},"1"),e.jsx(c,{pt:"Pontos do Arquiteto para cada jogador que acertou o planejamento",en:"Architect points for each player who matched the plan"},"2"),e.jsx(c,{pt:"Pontos por dar match com outros jogadores no cone errado",en:"Points for matching with other players on the wrong cone"},"3")],children:[e.jsx(Fe,{children:e.jsx(F,{onClick:r,children:e.jsx(c,{pt:"Ver resultado novamente",en:"See results again"})})}),o>0&&e.jsx(z,{type:"event",children:e.jsx(c,{pt:e.jsxs(e.Fragment,{children:["O prefeito não gosta quando seus funcionários não sabem o que estão fazendo!"," ",e.jsxs(R,{children:[o," construções"]})," não tiveram um consenso com o engenheiro-chefe, então o prefeito vai colocá-las em lugares aleatórios da cidade para a próxima rodada."]}),en:e.jsxs(e.Fragment,{children:["The mayor doesn't like it when his employees don't know what they're doing!"," ",e.jsxs(R,{children:[o," constructions"]})," had no consensus with the lead engineer, so the mayor will place them in random locations in the city for the next round."]})})}),e.jsx(Re,{round:a})]})}function et({state:n,players:t}){const{step:r,goToNextStep:a,goToPreviousStep:s}=$(0),[o]=G("architectId",n,t),i=en({length:n.gallery.length,slideDuration:Vn,onExpire:a}),l=()=>{i.reset(),s()};return e.jsx(W,{phase:n?.phase,allowedPhase:C.RESOLUTION,children:e.jsxs(q,{step:r,players:t,children:[e.jsx(_,{icon:e.jsx(ke,{}),title:e.jsx(c,{pt:"Resultado",en:"Results"}),currentRound:n?.round?.current,type:"block",unskippable:!0,duration:[10,5,3][n.round.current-1]??3,onClose:a,children:e.jsx(M,{children:e.jsx(c,{pt:e.jsxs(e.Fragment,{children:["Vamos ver se você, pedreiro, pensou como o engenheiro chefe.",e.jsx("br",{}),"Você ganha ",e.jsx(I,{children:"2 pontos"})," se acertar o planejamento!",e.jsx("br",{}),"O engenheiro chefe ganha ",e.jsx(I,{children:"1 ponto"})," para cada jogador que acertar!",e.jsx("br",{}),"Quem errar, ganha ",e.jsx(I,{children:"1 ponto"})," para cada jogador que pensou igual!"]}),en:e.jsxs(e.Fragment,{children:["Let's see if you, builder, thought like the lead engineer.",e.jsx("br",{})," You earn ",e.jsx(I,{children:"2 points"})," if you match the plan!",e.jsx("br",{}),"The lead engineer earns ",e.jsx(I,{children:"1 point"})," for each player who matches!",e.jsx("br",{}),"Those who miss earn ",e.jsx(I,{children:"1 point"})," for each player who thought the same!"]})})})}),e.jsx(Yn,{architect:o,city:n.city,cityLocationsDict:n.cityLocationsDict,gallery:n.gallery,slideShowConfig:i,placements:Object.keys(n.coneCellIds).length,players:t}),e.jsx(Kn,{players:t,round:n.round,ranking:n.ranking,goToPreviousStep:l,gallery:n.gallery})]})})}function nt({state:n,players:t}){return e.jsxs(ln,{state:n,players:t,announcementIcon:e.jsx(cn,{}),children:[e.jsx(dn,{achievements:n.achievements,players:t,reference:mn}),e.jsx(hn,{title:e.jsx(c,{pt:"Cidade Inaugurada",en:"Final City"}),children:n.city&&n.cityLocationsDict&&e.jsx(k,{city:n.city,cityLocationsDict:n.cityLocationsDict})})]})}function tt(n){switch(n.phase){case C.PLANNING:return Un;case C.PLACING:return Jn;case C.RESOLUTION:return et;case Le.DEFAULT.GAME_OVER:return nt;default:return Ee}}function Sr(){return e.jsx(Ae,{gameCollection:Me.PLANEJAMENTO_URBANO,getActiveComponent:tt})}export{Sr as default};
