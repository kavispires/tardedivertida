import{r as f,aF as se,a7 as ne,j as e,h as p,T as a,aQ as q,B as g,e as v,aP as F,co as oe,aM as E,x as $,ct as Y,aN as te,cp as ae,c4 as ie,cu as re,J as G,k as ce,cv as ue,b0 as le}from"./index-B7FVv3jX.js";import{i as O,S as N,a as P,j as me,b as T,c as y,d as A,P as x,u as w,k as de,R as pe,H as he,l as W,f as xe,g as je,h as fe}from"./StepSwitcher-Cjzlfjh5.js";import{u as S}from"./useWhichPlayerIsThe-i6TcPHiR.js";import{P as ge}from"./PassportIcon-CkNvL2ju.js";import{S as Se}from"./SecretIcon-3BLmKh4F.js";import{S as Ne,A as Te,M as ye,H as Ae}from"./SpyNewspaperIcon-B69c0Opv.js";import{I as d}from"./useDevFeatures-D0Hwj-2g.js";import{P as k}from"./PhaseTimerReset-BoYdxHJQ.js";import{R as be}from"./RoundAnnouncement-DLrPANcF.js";import{C as ve}from"./Card-Bvn8Jwmm.js";import{R as Ie}from"./QuestionCircleFilled-Dp7EpKBH.js";import{u as z}from"./useCache-D2v8Srzc.js";import{R as Ee}from"./EnvironmentOutlined-fJX-5rYV.js";import{R as B}from"./ClearOutlined-CETV2ipo.js";import{L as Oe}from"./LoupeIcon-CrgSyqF_.js";import{O as H}from"./OpinionsIcon-B44DkfE5.js";import{d as Pe}from"./WritingIcon-DfPFfAV8.js";import{M as Q}from"./index-DKRItngE.js";import{S as I}from"./index-DF-Pwyr9.js";import{P as D}from"./index-CLDDIIez.js";import{R as we}from"./AimOutlined-CEO4AFbi.js";import{V as Ce}from"./ViewSwitch-BbBpgean.js";import{N as _e}from"./NuclearExplosionIcon-BZdWBtct.js";import{T as Le}from"./ThiefIcon-nTWQOtnl.js";import{V as Re}from"./ViewOr-Bx1kDirb.js";import{P as Ve}from"./PeopleAssessmentIcon-Cf3JKF_H.js";import{T as Me}from"./TrophyIcon-DFI5Ueq2.js";import"./GameBanner-D9_pxv_t.js";import{G as qe}from"./GameOverWrapper-BCXtkRNm.js";import"./DebugOnly-D9y-BwkJ.js";import"./speech-BuvO9BqZ.js";import"./RulesModal-8Q6zwIFD.js";import"./Game-DSpJno7T.js";import"./useMutation-CjtsXZ3j.js";import"./index-CmMHabpk.js";import"./PurePanel-B386D80u.js";import"./index-B8iX5lxe.js";import"./PlayerAvatar-BGUT8Cak.js";import"./useTDBaseUrl-BF9foKiS.js";import"./index-Cl-caKpr.js";import"./Loading-D8DTCUWd.js";import"./useBubbleLock-B5zd9kpx.js";import"./AnimatedLoaderIcon-B0Gxb3ma.js";import"./InfoCircleOutlined-DFq3paBE.js";import"./index-DBnF44WP.js";import"./SignIn-Opysd4zt.js";import"./GoogleIcon-ChltZFxq.js";import"./WaitingRoomIcon-CUwP4iTB.js";import"./AnimatedClockIcon-GycZWL2V.js";import"./LikeFilled-Dgprn6aX.js";import"./Overflow-31jpmjeX.js";import"./TheEndIcon-DJ1KGvIf.js";import"./StarFilled-BP7P5gqM.js";import"./ArrowRightOutlined-CqcflkC2.js";import"./progress-DOO7QNuo.js";var ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm72-112c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48zm400-188h-59.3c-2.6 0-5 1.2-6.5 3.3L763.7 538.1l-49.9-68.8a7.92 7.92 0 00-6.5-3.3H648c-6.5 0-10.3 7.4-6.5 12.7l109.2 150.7a16.1 16.1 0 0026 0l165.8-228.7c3.8-5.3 0-12.7-6.5-12.7zm-44 306h-64.2c-5.5 0-10.6 2.9-13.6 7.5a352.2 352.2 0 01-49.8 62.2A355.92 355.92 0 01651.1 840a355 355 0 01-138.7 27.9c-48.1 0-94.8-9.4-138.7-27.9a355.92 355.92 0 01-113.3-76.3A353.06 353.06 0 01184 650.5c-18.6-43.8-28-90.5-28-138.5s9.4-94.7 28-138.5c17.9-42.4 43.6-80.5 76.4-113.2 32.8-32.7 70.9-58.4 113.3-76.3a355 355 0 01138.7-27.9c48.1 0 94.8 9.4 138.7 27.9 42.4 17.9 80.5 43.6 113.3 76.3 19 19 35.6 39.8 49.8 62.2 2.9 4.7 8.1 7.5 13.6 7.5H892c6 0 9.8-6.3 7.2-11.6C828.8 178.5 684.7 82 517.7 80 278.9 77.2 80.5 272.5 80 511.2 79.5 750.1 273.3 944 512.4 944c169.2 0 315.6-97 386.7-238.4A8 8 0 00892 694z"}}]},name:"issues-close",theme:"outlined"},Fe=function(n,o){return f.createElement(se,ne({},n,{ref:o,icon:ke}))},$e=f.forwardRef(Fe);function M({children:s}){return e.jsx(e.Fragment,{children:s})}const j={ASSIGNMENT:"ASSIGNMENT",INVESTIGATION:"INVESTIGATION",ASSESSMENT:"ASSESSMENT",FINAL_ASSESSMENT:"FINAL_ASSESSMENT",RESOLUTION:"RESOLUTION"},C={LAST_QUESTIONER:"LAST_QUESTIONER",MAKE_ACCUSATION:"MAKE_ACCUSATION",SUBMIT_VOTE:"SUBMIT_VOTE",GUESS_LOCATION:"GUESS_LOCATION"},_=({location:s,role:n,header:o})=>{const{translate:t}=p(),i=t("Local Desconhecido","Unknown Location"),u=t("Você é o espião","You are the spy"),r=t(`Você é um(a) ${n}`,`You are a ${n}`);return e.jsx(ve,{color:s==="SPY"?"red":"lime",header:s==="SPY"?i:o,size:"large",footer:n==="SPY"?u:r,className:"e-card",footerClassName:"e-card__footer",children:s==="SPY"?e.jsx(Ie,{}):s})};function L({locations:s}){const{translate:n}=p(),{cache:o,setCache:t}=z(),i=r=>{t(l=>{const c={...l};return c[r]?delete c[r]:c[r]=!0,c})},u=()=>{t(r=>{const l={...r};return Object.keys(l).forEach(c=>{c.startsWith("_")||delete l[c]}),l})};return e.jsxs("div",{className:"e-list",children:[e.jsxs("h3",{className:"e-list__title",children:[e.jsx(Ee,{})," ",e.jsx(a,{pt:"Possíveis Locais",en:"Possible Locations"}),e.jsx(q,{title:n("Desmarcar todos","Unselect all"),children:e.jsx(g,{shape:"circle",ghost:!0,type:"default",size:"small",icon:e.jsx(B,{}),onClick:u,className:"e-list__clear-button"})})]}),e.jsx("ul",{className:v("e-list__list","e-list__list--column"),children:s.map(r=>e.jsx("li",{className:v("e-list__item",o[r.id]&&"e-list__item--crossed"),role:"button",onClick:()=>i(r.id),children:r.name},r.id))})]})}function R(){const{translate:s}=p();return e.jsx("textarea",{name:"",id:"",cols:30,rows:10,className:"e-notes",placeholder:s("Escreva anotações aqui se quiser, mas cuidado com o teclado fazendo muito barulho","Write your notes here, but don't make too much noise with those key strokes")})}function Ge({user:s,isUserTheSpy:n,locations:o}){return O(),e.jsxs(N,{className:"e-phase-step",children:[e.jsx(P,{className:"e-phase-title",children:e.jsx(a,{pt:"Você está no(a)...",en:"We are in/at/on..."})}),e.jsx(_,{location:s.location,role:s.role}),e.jsx(me,{children:e.jsx(a,{pt:"Começar cronômetro",en:"Start Timer"})}),e.jsx(d,{className:"e-phase-instruction",children:n?e.jsx(a,{pt:"Você terá 10 minutos para descobrir onde os outros agentes estão! Pronto?",en:"You have 10 minutes to find out where the other agents are! Ready?"}):e.jsx(a,{pt:"Você terá 10 minutos para descobrir quem é o espião entre nós! Pronto?",en:"You have 10 minutes to find out who is the spy! Ready?"})}),e.jsx(d,{className:"e-lists",children:e.jsx(L,{locations:o})}),e.jsx(R,{})]})}function Ue({state:s,players:n,user:o}){const{step:t,goToNextStep:i}=T(0),[,u]=S("currentSpyId",s,n);return e.jsx(y,{phase:s?.phase,allowedPhase:j.ASSIGNMENT,className:"e-phase",children:e.jsxs(A,{step:t,players:n,children:[e.jsx(be,{round:s.round,onPressButton:i,time:5,className:"e-round-announcement",children:e.jsx(d,{className:"e-phase-instruction",children:e.jsx(a,{pt:"Há um espião entre nós!",en:"There's a spy among us!"})})}),e.jsx(x,{icon:e.jsx(Ne,{}),title:e.jsx(a,{pt:"Prólogo",en:"Prologue"}),onClose:i,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement e-phase-announcement--animated",duration:15,type:"block",children:e.jsx(d,{children:e.jsx(a,{pt:e.jsxs(e.Fragment,{children:["Estamos todos em um local que somente agentes confiáveis sabem onde é, mas um espião conseguiu se infiltrar em nosso sistema.",e.jsx("br",{}),"Estamos nos comunicando pelo ponto em nossos ouvidos porque somos espiões hi-tech."]}),en:e.jsxs(e.Fragment,{children:["We're all in a secret location that only the most trustworthy agents are assigned to, but a spy has hacked our system.",e.jsx("br",{}),"We are communication through our in-ear spy tech."]})})})}),e.jsx(k,{goToNextStep:i}),e.jsx(x,{icon:e.jsx(Se,{}),title:e.jsx(a,{pt:"Você tem uma missão",en:"You have one mission"}),onClose:i,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement e-phase-announcement--animated",duration:10,type:"block",children:e.jsx(d,{children:e.jsx(a,{pt:e.jsxs(e.Fragment,{children:["Se você é um agente, sua missão é descobrir quem é o espião.",e.jsx("br",{}),"Se você é o espião, sua missão é descobrir qual local os outros estão."]}),en:e.jsxs(e.Fragment,{children:["If you are an agent, your mission is to figure out who the spy is.",e.jsx("br",{}),"If you are the spy, your mission is to find out where the agents are and nuke it!."]})})})}),e.jsx(k,{goToNextStep:i}),e.jsx(x,{icon:e.jsx(ge,{}),title:e.jsx(a,{pt:"Mais detalhes",en:"More details"}),onClose:i,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement e-phase-announcement--animated",duration:30,type:"block",children:e.jsx(d,{children:e.jsx(a,{pt:e.jsxs(e.Fragment,{children:["Um jogador faz uma pergunta a outro, qualquer tipo de pergunta, e então esse o jogador responde, de qualquer forma.",e.jsx("br",{}),"Você quer ser específico o suficiente para que outros jogadores não te acusem, mas vago o suficiente para que espião não sabia onde estamos.",e.jsx("br",{}),"O jogador que responde se torna o novo 'perguntador'.",e.jsx("br",{}),"Mas fique esperto, você só pode acusar alguém (ou tentar descobrir a localização) uma única vez durante o jogo."]}),en:e.jsxs(e.Fragment,{children:["One player will ask a question to another player, any kind of question, then this player will respond, in any way.",e.jsx("br",{}),"You want to be specific enough so other players don't accuse you, but vague enough so the spy does not figure out where you are.",e.jsx("br",{}),"The asked player becomes the new questioner.",e.jsx("br",{}),"But watch out! You can only accuse someone (or guess the location) a single time during the game."]})})})}),e.jsx(Ge,{user:o,isUserTheSpy:u,locations:s.locations})]})})}function We(s){const{translate:n}=p(),o=w({actionName:"submit-guess",onBeforeCall:()=>s(3),onError:()=>s(0),successMessage:n("Chute submetido com sucesso","Guess submitted successfully"),errorMessage:n("Vixi, o aplicativo encontrou um erro ao tentar enviar seu chute","Oops, the application found an error while trying to submit your guess")});return t=>{o({action:C.GUESS_LOCATION,...t})}}function J(s){const{translate:n}=p(),o=w({actionName:"make-accusation",onBeforeCall:()=>s(3),onError:()=>s(0),successMessage:n("Acusação submetida com sucesso","Accusation submitted successfully"),errorMessage:n("Vixi, o aplicativo encontrou um erro ao tentar enviar sua acusação","Oops, the application found an error while trying to submit your acusação")});return t=>{o({action:C.MAKE_ACCUSATION,...t})}}function Ye(s){const{translate:n}=p(),o=w({actionName:"submit-vote",onError:()=>s(1),successMessage:n("Voto submetido com sucesso","Vote submitted successfully"),errorMessage:n("Vixi, o aplicativo encontrou um erro ao tentar enviar seu voto","Oops, the application found an error while trying to submit your vote")});return t=>{o({action:C.SUBMIT_VOTE,...t})}}function ze(s){const{translate:n}=p(),o=w({actionName:"submit-last-questioner",onError:()=>s(1),successMessage:n("Último perguntador submetido com sucesso","Last questioner submitted successfully"),errorMessage:n("Vixi, o aplicativo encontrou um erro ao tentar enviar o último perguntador","Oops, the application found an error while trying to submit the last questioner")});return t=>{o({action:C.LAST_QUESTIONER,...t})}}function Be(s){return n=>{console.log(n)}}function He({onSendLastQuestioner:s,players:n}){const o=de();return e.jsxs(Q,{open:o,title:e.jsx(a,{pt:"O Tempo Acabou!",en:"Time's up"}),footer:null,closable:!1,className:"e-modal",children:[e.jsx(a,{pt:"Quem foi a última pessoa a responder uma pergunta?",en:"Who was the last person to answer a question?"}),e.jsx(F,{wrap:!0,children:Object.entries(n).map(([t,i])=>e.jsx(g,{type:"default",icon:e.jsx(oe,{}),onClick:()=>s({lastPlayerId:t}),children:i.name},t))})]})}function Qe({locations:s,onSend:n}){const{translate:o}=p(),{isLoading:t}=E(),[i,u]=f.useState(""),r=c=>u(c),l=f.useMemo(()=>s.find(c=>c.id===i)?.name??"",[i,s]);return e.jsxs($,{className:"e-select-container e-select-container--locations",children:[e.jsx(I,{onChange:r,placeholder:o("Chute um local","Guess location"),children:s.map(c=>e.jsx(I.Option,{value:c.id,children:c.name},`select-${c.id}`))}),e.jsx(D,{title:e.jsx(a,{pt:`Você só pode chutar uma vez durante o jogo! Tem certeza que quer chutar ${l}?`,en:`You may guess the location only once! Are you sure you want to guess ${l}?`}),onConfirm:()=>n({locationId:i}),okText:"Sim",cancelText:"Não",children:e.jsxs(g,{type:"primary",disabled:!i||t,icon:t?e.jsx(Y,{}):null,children:[e.jsx(a,{pt:"Chutar",en:"Guess"}),l?`: ${l}`:""]})})]})}function K({players:s,onSend:n,isFinalAssessment:o=!1}){const{translate:t}=p(),{isLoading:i}=E(),[u]=te("userId"),[r,l]=f.useState(""),c=Object.values(s).filter(h=>h.id!==u),m=h=>l(h);return e.jsxs($,{children:[e.jsx(I,{onChange:m,className:"e-select",placeholder:t("Acuse um jogador","Accuse a player"),children:c.map(h=>e.jsx(I.Option,{value:h.id,children:h.name},h.id))}),e.jsx(D,{title:`${o?"":t("Você só pode acusar uma vez durante o jogo!","You may only make one accusation during the game!")} ${t("Tem certeza que quer acusar","Are you sure you want to accuse")} ${s[r]?.name}?`,onConfirm:()=>n({targetId:r}),okText:t("Sim","Yes"),cancelText:t("Não","No"),children:e.jsxs(g,{type:"primary",disabled:!r||i,icon:i?e.jsx(Y,{}):null,children:[e.jsx(a,{pt:"Acusar",en:"Accuse"}),r?`: ${s[r]?.name}`:""]})})]})}function U({players:s}){const{translate:n}=p(),{cache:o,setCache:t}=z(),i=ae(s),u=l=>{t(c=>{const m={...c};return m[l]?delete m[l]:m[l]=!0,m})},r=()=>{t(l=>{const c={...l};return Object.keys(c).forEach(m=>{m.startsWith("_")&&delete c[m]}),c})};return e.jsxs("div",{className:"e-list",children:[e.jsxs("h3",{className:"e-list__title",children:[e.jsx(we,{})," ",e.jsx(a,{pt:"Suspeitos",en:"Suspects"}),e.jsx(q,{title:n("Desmarcar todos","Unselect all"),children:e.jsx(g,{shape:"circle",ghost:!0,type:"default",size:"small",icon:e.jsx(B,{}),onClick:r,className:"e-list__clear-button"})})]}),e.jsx("ul",{className:"e-list__list",children:i.map(l=>e.jsxs("li",{className:v("e-list__item",o[l.id]&&"e-list__item--crossed"),role:"button",onClick:()=>u(l.id),children:[l.name," ",l.usedAccusation&&e.jsx(q,{title:"Já usou acusação",children:e.jsx($e,{size:12})})]},l.id))})]})}function De({timer:s,hideAccusationSelect:n,setStep:o}){const t=()=>{n(),o(2)},{minutes:i,seconds:u}=ie.useTimer({expiryTimestamp:re(s.timeRemaining-2e3),autoStart:!0,onExpire:t});return e.jsxs("div",{className:"e-timer",children:[i,":",u<10?`0${u}`:u]})}function Je({user:s,isUserTheSpy:n,locations:o,players:t,timer:i,onGuessLocation:u,onMakeAccusation:r,onSendLastQuestioner:l,outcome:c,setStep:m}){O();const{translate:h}=p(),[V,b]=f.useState(!0),{notification:Z}=G.useApp();f.useEffect(()=>{c?.type==="VOTE_FAIL"&&Z.info({message:h("A votação não foi unânime","The voting was not unanimous"),description:c.votedYes?`Votaram sim: ${c.votedYes}`:"Ninguém votou sim",duration:10})},[c?.type]);const ee=()=>{b(!1)};return e.jsxs(N,{className:"e-phase-step",children:[e.jsxs("div",{className:"e-phase-step-header",children:[e.jsx("div",{className:"e-phase-step-header__timer-container",children:e.jsx(De,{timer:i,hideAccusationSelect:ee,setStep:m})}),e.jsxs("div",{className:"e-phase-step-header__center",children:[e.jsx(ce,{level:2,className:"e-phase-title",children:n?e.jsx(a,{pt:"Onde eles estão?",en:"Where are they?"}):e.jsx(a,{pt:"Quem é o espião?",en:"Who is the spy?"})}),e.jsx(_,{location:s.location,role:s.role})]})]}),V&&e.jsxs(F,{children:[n&&e.jsx(Qe,{locations:o,onSend:u}),"|",s?.usedAccusation?e.jsx(d,{className:"e-phase-instruction",children:e.jsx(a,{pt:"Você já usou sua chance de acusar",en:"You already used your accusation"})}):e.jsx(K,{players:t,onSend:r})]}),e.jsxs(d,{className:"e-lists",children:[e.jsx(U,{players:t}),e.jsx(L,{locations:o})]}),e.jsx(R,{})]})}function Ke({state:s,players:n,user:o}){const{translate:t}=p(),{step:i,goToNextStep:u,setStep:r}=T(0),{notification:l}=G.useApp(),[,c]=S("currentSpyId",s,n),[m]=S("startingPlayerId",s,n),h=We(r),V=J(r),b=ze(r);return f.useEffect(()=>{s.timeRemaining>59e4&&m.name&&l.info({message:t("10 minutos!","10 minutes!"),description:t(`${m.name} começa perguntando!`,`${m.name} starts questioning!`),duration:10})},[m.name]),e.jsx(y,{phase:s?.phase,allowedPhase:j.INVESTIGATION,className:"e-phase",children:e.jsxs(A,{step:i,players:n,children:[s?.outcome?.type!=="VOTE_FAIL"?e.jsx(x,{icon:e.jsx(Oe,{}),title:e.jsx(a,{pt:"Investigação",en:"Investigation"}),onClose:u,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement",duration:3,type:"block"}):e.jsx(x,{icon:e.jsx(H,{}),title:e.jsx(a,{pt:"A investigação continua",en:"The investigation continues"}),onClose:u,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement",duration:3,type:"block",children:e.jsx(d,{children:e.jsx(a,{pt:"A votação não foi unanime",en:"The vote wasn't unanimous"})})}),e.jsx(Je,{user:o,isUserTheSpy:c,locations:s.locations,players:n,timer:s.timer,onGuessLocation:h,onMakeAccusation:V,onSendLastQuestioner:b,outcome:s.outcome,setStep:r}),e.jsxs(x,{icon:e.jsx(Pe,{}),title:e.jsx(a,{pt:"O tempo acabou!!!",en:"Time's up!!!"}),unskippable:!0,duration:300,onClose:()=>{},currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement",type:"block",children:[e.jsx(d,{children:e.jsx(a,{pt:"Preparado para a avaliação final?",en:"Are you ready for the final assessment?"})}),e.jsx(He,{onSendLastQuestioner:b,players:n})]})]})})}function Xe({user:s,locations:n,players:o,onSubmitVote:t,accuser:i,isUserTheAccuser:u,target:r,isUserTheTarget:l}){const{translate:c}=p(),{isLoading:m}=E();return e.jsxs(N,{className:"e-phase-step",children:[e.jsx(P,{className:"e-phase-title",children:e.jsx(a,{pt:`${i.name} está acusando ${r.name} de ser o espião. Concorda?`,en:`${i.name} is accusing ${r.name} to be the spy. Do you agree?`})}),e.jsxs(Ce,{cases:[u,l,!0],children:[e.jsx(M,{children:e.jsx(d,{className:"e-phase-instruction",children:e.jsx(a,{pt:"Você não participa dessa votação, afinal, você quem acusou!",en:"You do not join the voting, after all, you triggered it!"})})},"accuser"),e.jsx(M,{children:e.jsx(d,{className:"e-phase-instruction",children:e.jsx(a,{pt:"Você não participa dessa votação, afinal, é você quem está no paredão!",en:"You do not joint the voting, after all, you are the target"})})},"target"),e.jsx(M,{children:s.ready?e.jsx(d,{className:"e-phase-instruction",children:e.jsx(a,{pt:"Voto computado",en:"Vote accepted"})}):e.jsxs($,{children:[e.jsx(g,{ghost:!0,disabled:m,onClick:()=>t({vote:!0}),children:e.jsx(a,{pt:"Também acho!",en:"Agree!"})}),e.jsx(g,{ghost:!0,disabled:m,onClick:()=>t({vote:!1}),children:e.jsx(a,{pt:"Não é ele(a)",en:"It's not them"})})]})},"others")]}),e.jsx(_,{location:s.location,role:s.role}),e.jsx(pe,{players:o,readyText:c("Votei","I voted"),readyTextPlural:c("Votamos","We voted"),hideNames:!0}),e.jsxs(d,{className:"e-lists",children:[e.jsx(U,{players:o}),e.jsx(L,{locations:n})]}),e.jsx(R,{})]})}function Ze({state:s,players:n,user:o}){const{step:t,goToNextStep:i,setStep:u}=T(0),[r,l]=S("accuserId",s,n),[c,m]=S("targetId",s,n),h=Ye(u);return e.jsx(y,{phase:s?.phase,allowedPhase:j.ASSESSMENT,className:"e-phase",children:e.jsxs(A,{step:t,players:n,children:[e.jsx(x,{icon:e.jsx(Te,{}),title:e.jsx(a,{pt:"Acusação!",en:"Accusation!"}),onClose:i,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement e-phase-announcement--alert",duration:5,type:"block",children:e.jsx(d,{children:e.jsx(a,{pt:e.jsxs(e.Fragment,{children:["Alguém foi acusado! Bafo!",e.jsx("br",{}),"Apenas se a votação for unanime que o resultado é revelado."]}),en:e.jsxs(e.Fragment,{children:["Someone was accused! Drama!!!",e.jsx("br",{}),"The solution is revealed only if the voting is unanimous."]})})})}),e.jsx(Xe,{user:o,locations:s.locations,players:n,onSubmitVote:h,accuser:r,isUserTheAccuser:l,target:c,isUserTheTarget:m})]})})}const es=(s,n,o,t)=>{const i=t.find(u=>u.id===s?.guess)??{};return{isPlayerVictory:s.isSpyWin===n,isUserTheSpy:n,wasABadVoting:s.isSpyWin&&o>0,wasAnAccusationAttempt:s.type==="SPY_FOUND",didSpyGuess:s.type==="SPY_GUESS",didTheSpyWin:s.isSpyWin,phaseIcon:s.isSpyWin?"nuclear-explosion":"handcuffs",guess:i,currentLocation:s.currentLocation}};function ss({players:s,target:n,resolutionStatus:o,currentSpy:t,onProgressGame:i}){O();const{isLoading:u}=E();return e.jsxs(N,{className:"e-phase-step",children:[e.jsx(P,{className:v("e-phase-title",!o.isPlayerVictory&&"e-phase-title--fail"),children:o.isPlayerVictory?e.jsx(a,{pt:"Missão Cumprida!",en:"Mission Accomplished!"}):e.jsx(a,{pt:"Missão Fracassada",en:"Mission Failed"})}),o.wasAnAccusationAttempt&&n&&e.jsx(d,{className:"e-phase-instruction",children:e.jsx(a,{pt:e.jsxs(e.Fragment,{children:["Os agentes tentaram incriminar ",n.name,o.didTheSpyWin?" e erraram feio!":" e acertaram na mosca!",e.jsx("br",{}),o.didTheSpyWin?`O espião era ${t.name}! Todos os segredos da agência foram revelados e o mundo vai acabar.`:"Parabéns! O mundo está salvo graças a você.",e.jsx("br",{}),o.wasABadVoting&&"Da próxima vez, discutam mais antes de fazerem uma votação precipitada."]}),en:e.jsxs(e.Fragment,{children:["The agents tried to pin ",n.name,o.didTheSpyWin?" and got it all wrong!":" and hit the bull's eye!",e.jsx("br",{}),o.didTheSpyWin?`The spy was ${t.name}! All of the agency secrets were revealed and the world will end.`:"Congratulations! The world is safe and sound thanks to you.",e.jsx("br",{}),o.wasABadVoting&&"Next time, discuss more before making a rash decision."]})})}),o.didSpyGuess&&o.currentLocation&&e.jsx(d,{className:"e-phase-instruction",children:e.jsx(a,{pt:e.jsxs(e.Fragment,{children:["O espião disse que o local é ",o.guess.name,o.didTheSpyWin?" e acertou na mosca!":` e errou feio! Os Agentes estão num(a) ${o.currentLocation.name}.`,e.jsx("br",{}),o.didTheSpyWin?"Todos os segredos da agência foram revelados e o mundo vai acabar.":"Foi por pouco, mas não foi dessa vez que o mal venceu."]}),en:e.jsxs(e.Fragment,{children:["The spy guessed the location: ",o.guess.name,o.didTheSpyWin?" and hit the bull's eye!":` and got it all wrong! The agents were at a ${o.currentLocation.name}.`,e.jsx("br",{}),o.didTheSpyWin?"All of the agency secrets were revealed and the world will end...":"That was close... but evil won't win this time."]})})}),e.jsxs(d,{className:"e-phase-instruction",children:[e.jsx("h4",{children:o.currentLocation?.name}),e.jsx(a,{pt:"Disfarces dos infiltrados:",en:"Agent's roles:"}),Object.values(s).map(({id:r,name:l,role:c})=>e.jsxs("li",{children:[l," ",e.jsx(a,{pt:"como",en:"as"})," ",c==="SPY"?e.jsx(a,{pt:"ESPIÃO",en:"SPY"}):c]},`role-list-${r}`))]}),e.jsxs(he,{children:[e.jsx(W,{onClick:()=>i({continue:!0}),disabled:u,children:e.jsx(a,{pt:"Jogar mais uma rodada",en:"Play another round"})}),e.jsx(W,{onClick:()=>i({end:!0}),disabled:u,children:e.jsx(a,{pt:"Terminar Jogo",en:"End Game"})})]})]})}function ns({state:s,players:n}){const{step:o,goToNextStep:t}=T(0),[i,u]=S("currentSpyId",s,n),[r]=S("targetId",s,n),l=Be(),c=f.useMemo(()=>es(s.resolution,u,s.timeRemaining,s.locations),[s.resolution,u,s.timeRemaining,s.locations]);return e.jsx(y,{phase:s?.phase,allowedPhase:j.RESOLUTION,className:"e-phase",children:e.jsxs(A,{step:o,players:n,children:[e.jsxs(Re,{condition:c.didSpyGuess,children:[e.jsx(x,{icon:e.jsx(ye,{}),title:e.jsx(a,{pt:"O espião tentou adivinhar o local",en:"The spy tried to guess the location"}),onClose:t,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement",duration:5,type:"block"}),e.jsx(x,{icon:e.jsx(Le,{}),title:e.jsx(a,{pt:"A votação foi unanime!",en:"The vote was unanimous!"}),onClose:t,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement",duration:5,type:"block"})]}),e.jsx(k,{goToNextStep:t}),e.jsx(x,{icon:c.phaseIcon==="nuclear-explosion"?e.jsx(_e,{}):e.jsx(Ae,{}),title:e.jsx(a,{pt:"O fim chegou!",en:"The end is here!"}),onClose:t,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement",duration:5,type:"block"}),e.jsx(ss,{players:n,target:r,resolutionStatus:c,currentSpy:i,onProgressGame:l})]})})}function X({finalAssessment:s,players:n}){const{playerOrder:o,playerOrderIndex:t}=s,i=n[o[t]],u=ue(o,n).join(", ");return e.jsx(d,{className:"e-phase-instruction",children:e.jsx(a,{pt:e.jsxs(e.Fragment,{children:["Já que vocês falharam em encontrar o espião, há uma última possibilidade!",e.jsxs("ul",{children:[t===0?e.jsxs("li",{children:["Cada jogador, começando por ",i.name,", faz uma acusação."]}):e.jsxs("li",{children:["Agora é a vez de ",i.name," faz uma acusação."]}),e.jsx("li",{children:"Se a votação for unânime em qualquer uma das votações, o jogo acaba e revelam-se os papéis."}),e.jsx("li",{children:"Sem discussão dessa vez, simplesmente acuse alguém! Não temos mais tempo!"}),e.jsxs("li",{children:["A ordem será essa: ",u]})]})]}),en:e.jsxs(e.Fragment,{children:["Since you've failed to find the spy, here's a last resort!",e.jsxs("ul",{children:[t===0?e.jsxs("li",{children:["Each player will, starting with ",i.name,", will make an accusation."]}):e.jsxs("li",{children:["Now it's time for ",i.name," to make an accusation."]}),e.jsx("li",{children:"If the voting result is unanimous, the game is over and the roles are revealed."}),e.jsx("li",{children:"No discussion, just accuse somebody! There's no time anymore!"}),e.jsxs("li",{children:["The order is: ",u]})]})]})})})}function os({isModalVisible:s,onMakeAccusation:n,players:o,finalAssessment:t}){return e.jsxs(Q,{open:s,title:e.jsx(a,{pt:"Quem você vai acusar?",en:"Who are you gonna accuse?"}),footer:null,closable:!1,className:"e-modal",children:[e.jsx(X,{finalAssessment:t,players:o}),e.jsx(a,{pt:"Não há tempo pra pensar, escolha alguém!",en:"There's no time to think, just choose someone"}),e.jsx(F,{children:e.jsx(K,{players:o,onSend:n,isFinalAssessment:!0})})]})}function ts({finalAssessment:s,players:n,user:o,locations:t,isUserTheAccuser:i,onMakeAccusation:u,outcome:r}){O();const{notification:l}=G.useApp(),{translate:c}=p();return f.useEffect(()=>{r?.type==="VOTE_FAIL"&&l.info({message:c("A votação não foi unânime","The voting was not unanimous"),description:r.votedYes?`Votaram sim: ${r.votedYes}`:"Ninguém votou sim",duration:10})},[r?.type]),e.jsxs(N,{children:[e.jsx(P,{className:"e-phase-title",children:e.jsx(a,{pt:"Última Chance!",en:"Last chance!"})}),e.jsx(os,{isModalVisible:i,onMakeAccusation:u,players:n,finalAssessment:s}),e.jsx(X,{finalAssessment:s,players:n}),e.jsx(_,{location:o.location,role:o.role}),e.jsxs(d,{className:"e-lists",children:[e.jsx(U,{players:n}),e.jsx(L,{locations:t})]}),e.jsx(R,{})]})}function as({state:s,players:n,user:o}){const{step:t,goToNextStep:i,setStep:u}=T(0),r=J(u),l=s.finalAssessment.playerOrder[s.finalAssessment.playerOrderIndex]===o.id;return e.jsx(y,{phase:s?.phase,allowedPhase:j.FINAL_ASSESSMENT,className:"e-phase",children:e.jsxs(A,{step:t,players:n,children:[s.finalAssessment.playerOrderIndex===0?e.jsx(x,{icon:e.jsx(Ve,{}),title:e.jsx(a,{pt:"O tempo acabou!",en:"Time's up!"}),onClose:i,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement",duration:2,type:"block"}):e.jsx(x,{icon:e.jsx(H,{}),title:e.jsx(a,{pt:"A avaliação final continua",en:"The final assessment continues"}),onClose:i,currentRound:s?.round?.current,buttonText:"",className:"e-phase-announcement",duration:3,type:"block",children:e.jsx(d,{children:e.jsx(a,{pt:"A votação não foi unanime",en:"The vote wasn't unanimous"})})}),e.jsx(ts,{onMakeAccusation:r,players:n,finalAssessment:s.finalAssessment,outcome:s.outcome,user:o,locations:s.locations,isUserTheAccuser:l})]})})}function is({state:s,players:n}){return e.jsx(qe,{state:s,players:n,announcementIcon:e.jsx(Me,{})})}function rs(s){switch(s.phase){case j.ASSIGNMENT:return Ue;case j.INVESTIGATION:return Ke;case j.ASSESSMENT:return Ze;case j.FINAL_ASSESSMENT:return as;case j.RESOLUTION:return ns;case fe.DEFAULT.GAME_OVER:return is;default:return je}}function ln(){return e.jsx(xe,{gameCollection:le.ESPIAO_ENTRE_NOS,getActiveComponent:rs})}export{ln as default};
