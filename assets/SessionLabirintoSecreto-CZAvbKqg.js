import{j as e,i as Ae,T as j,f as pe,e as C,aM as ue,aL as U,I as _,n as me,bH as Ne,k as Ye,r as W,b0 as Q,bj as Xe,cM as Je,bc as ye,B as z,l as ie,q as Me,bF as Fe,bG as le,bK as We,aY as Qe,aW as Ke,aX as Ze}from"./index-BTRYo_JU.js";import{e as re,f as O,u as Le,a as De,S as $,b as te,c as he,d as xe,P as je,g as fe,n as es,i as ss,j as rs,k as ts,l as os}from"./StepSwitcher-DnkTIRnq.js";import{A as Ue}from"./AnimatedProcessingIcon-SOUXtTsN.js";import{I as V}from"./Instruction-BWsH0zfP.js";import{M as oe,D as ns,P as as}from"./PathIcon-iCkgrhf3.js";import{V as Be}from"./ViewOr-TzM4WjBZ.js";import{N as L}from"./NoIcon-CXiSKkI0.js";import{g as is}from"./ItemCard-D77AlGip.js";import{T as ke}from"./TreeCard-BwrmiP76.js";import{S as cs}from"./Sprite-Ca9BEowv.js";import{F as ls,C as He,T as de}from"./TreeIcon-BHfj90Xl.js";import{P as E}from"./PointsHighlight-Ba1GEDtW.js";import{R as B}from"./RuleInstruction-DXytLzLg.js";import{T as ds,a as ps,R as us,b as ms,c as hs}from"./index.esm-CPGt1gJE.js";import{A as q}from"./ArrowIcon-CPXOXdCD.js";import{A as xs}from"./AvatarGroup-xQ5nxwbF.js";import{V as Oe}from"./ViewIf-KllO0pe9.js";import{F as _e}from"./FlagIcon-CWoy2Ion.js";import{M as Te}from"./MetricHighlight-CNg2LqOC.js";import{L as js}from"./LocationIcon-BxnhkExi.js";import{C as fs}from"./Card-Be4Z3hsW.js";import{C as Ge}from"./Container-BS29JhJs.js";import{T as _s}from"./TextHighlight-BBtbimeM.js";import{u as Ts}from"./useWhichPlayerIsThe-BEz-MI3K.js";import{T as gs}from"./TurnOrder-CBuZPmmu.js";import{A as K}from"./AvatarName-DAenfZgV.js";import{D as Ss}from"./DevButton-Cf6ysBry.js";import{M as vs}from"./MouseFollowingContent-CDgRfIAZ.js";import{S as bs,u as Es}from"./SlideShowControls-itS88Jy6.js";import{S as Is}from"./StepRankingWrapper-nRGimJ4u.js";import{A as Ns}from"./Avatar-DW9OA1dO.js";import{A as ys}from"./AvatarStrip-DzM0A_-I.js";import"./GameOver-CMXfCRxr.js";import{G as Os}from"./GameOverWrapper-BXAAv3Eb.js";import{A as Cs}from"./Achievements-DYLN-sms.js";import"./useBlurCards-DsbGDTih.js";import"./speech-CjFYMbZ_.js";import"./useDevFeatures-2MI9JLMb.js";import"./RulesModal-C76og4QM.js";import"./WritingIcon-D6LBsyev.js";import"./DoubleRightOutlined-K_i5wRdY.js";import"./PurePanel-CTbaOXVZ.js";import"./useMutation-Y0s_HXnf.js";import"./Game-LGO8TFe5.js";import"./WaitingRoomIcon-Bo40Gclr.js";import"./AnimatedClockIcon-BDIxvchV.js";import"./index-DQmIDfSh.js";import"./useBubbleLock-DT_m3yep.js";import"./index-dP7AQMWH.js";import"./Overflow-D27nJfac.js";import"./useEvent-BwBIfN2J.js";import"./index-DX9UPUKj.js";import"./index-BuD-th2M.js";import"./GameBanner-D1metudZ.js";import"./useTDBaseUrl-BF9foKiS.js";import"./index-C1CA2Fg3.js";import"./InfoCircleOutlined-DfJnCAq1.js";import"./index-DBrFGq3m.js";import"./SignIn-JevPnEZv.js";import"./GoogleIcon-CVRgS1Xf.js";import"./Loading-CG6iLMHE.js";import"./AnimatedLoaderIcon-BwNpHgfi.js";import"./LikeFilled-wzJD_VGZ.js";import"./WarningOutlined-B3EsXJRm.js";import"./StarIcon-DF1wNOC4.js";import"./StarFilled-C0wh3iHN.js";import"./StarFilled-CNctUIhy.js";import"./StepBackwardOutlined-s1BgcjQQ.js";import"./TrophyOutlined-eCMPMWlX.js";import"./RankingBoard-2N7-lH7B.js";import"./CaretUpOutlined-CTN4lzvm.js";import"./ArrowRightOutlined-ClvBEYc8.js";import"./useMergedState-D5VgOPJ1.js";import"./progress-ED-Q4esO.js";import"./TheEndIcon-Bfl_iIZj.js";import"./Medal-2F0xZROC.js";import"./QuestionCircleOutlined-CNAY2SAs.js";function ws({state:r}){return e.jsx(re,{phase:r==null?void 0:r.phase,allowedPhase:O.DEFAULT.WAIT,className:"setup",children:e.jsxs("div",{className:"phase-announcement",children:[e.jsx(Ae,{children:e.jsx(j,{pt:"Processando...",en:"Processing..."})}),e.jsx(Ue,{className:"phase-announcement__icon"}),e.jsx(V,{children:e.jsx(j,{pt:"Aguarde um momento",en:"Just a moment"})})]})})}const ze={SUBMIT_MAP:"SUBMIT_MAP",SUBMIT_PATH:"SUBMIT_PATH"},P=7,J=5,y={UP:"UP",RIGHT:"RIGHT",DOWN:"DOWN",LEFT:"LEFT",UP_LEFT:"UP_LEFT",UP_RIGHT:"UP_RIGHT",DOWN_LEFT:"DOWN_LEFT",DOWN_RIGHT:"DOWN_RIGHT"},Ps=15;function Rs(r){const{translate:s}=pe(),n=Le({actionName:"submit-map",onSuccess:()=>r(2),onError:()=>r(0),successMessage:s("Mapa submetido com sucesso","Map submitted successfully"),errorMessage:s("Vixi, o aplicativo encontrou um erro ao tentar enviar seu mapa","Oops, the application found an error while trying to submit your map")});return o=>{n({action:ze.SUBMIT_MAP,...o})}}function As(r){const{translate:s}=pe(),n=Le({actionName:"submit-path",onSuccess:()=>r(2),onError:()=>r(0),successMessage:s("Caminho submetido com sucesso","Path submitted successfully"),errorMessage:s("Vixi, o aplicativo encontrou um erro ao tentar enviar seu caminho","Oops, the application found an error while trying to submit your path")});return o=>{n({action:ze.SUBMIT_PATH,...o})}}function Y({id:r,text:s,width:n=100,className:o}){if(typeof r=="string"){const[t,i]=is(r);return e.jsxs("div",{className:C("tree-card",o),style:{width:`${n}px`},children:[e.jsx(cs,{source:t,id:i,width:n,title:s}),e.jsx(ue,{title:s,children:e.jsx("div",{className:"tree-card__text",children:s})})]})}return e.jsx(ke,{id:String(r),text:s,width:n,className:o})}function Ms({forest:r,map:s,newMap:n}){if(!n||!s)return e.jsx(e.Fragment,{});const o=(s??[]).filter(t=>!t.passed);return e.jsx(U,{wrap:!0,children:o.map((t,i)=>{const{treeId:a,passed:d}=t,l=r[a],c=n==null?void 0:n[i];return e.jsxs("div",{className:"map-builder__segment",children:[!!c&&e.jsxs("div",{className:"map-builder__card map-builder__card--new",children:[c.text,(c==null?void 0:c.negate)&&e.jsx(_,{icon:e.jsx(L,{}),size:"small",className:"map-builder__card-no"})]}),t.clues.map(p=>e.jsxs("div",{className:"map-builder__card",children:[p.text,(p==null?void 0:p.negate)&&e.jsx(_,{icon:e.jsx(L,{}),size:"small",className:"map-builder__card-no"})]},`card-${t.index}-${p.id}`)),e.jsx(Y,{id:l.treeType,text:d?"":l.card.text})]},a)})})}const M=r=>{const[s,n]=r;return s+n*P},Z=r=>{const s=r%P,n=Math.floor(r/P);return[s,n]},Fs=r=>{const s=Z(r),[n,o]=s;return n===0?y.LEFT:n===P-1?y.RIGHT:o===0?y.UP:o===J-1?y.DOWN:null},ce=(r,s)=>{const[n,o]=Z(r),[t,i]=Z(s),a=t-n+(i-o)*P;return a===1?y.RIGHT:a===-1?y.LEFT:a===P?y.DOWN:a===-7?y.UP:a===P+1?y.DOWN_RIGHT:a===P-1?y.DOWN_LEFT:a===-6?y.UP_RIGHT:a===-8?y.UP_LEFT:y.UP},ge=(r,s)=>{const[n,o]=Z(r),t=[],i=[n,o-1],a=M(i);i[1]>=0&&!s.includes(a)&&t.push(i);const d=[n+1,o],l=M(d);d[0]<P&&!s.includes(l)&&t.push(d);const c=[n,o+1],p=M(c);c[1]<J&&!s.includes(p)&&t.push(c);const x=[n-1,o],N=M(x);x[0]>=0&&!s.includes(N)&&t.push(x);const g=[n-1,o-1],I=M(g);g[0]>=0&&g[1]>=0&&!s.includes(I)&&t.push(g);const b=[n+1,o-1],A=M(b);b[0]<P&&b[1]>=0&&!s.includes(A)&&t.push(b);const R=[n-1,o+1],w=M(R);R[0]>=0&&R[1]<J&&!s.includes(w)&&t.push(R);const u=[n+1,o+1],h=M(u);return u[0]<P&&u[1]<J&&!s.includes(h)&&t.push(u),t.map(m=>M(m))},Ws=(r,s)=>{if(!s)return[];const n=r.filter(o=>o.passed).map(o=>o.treeId);return ge(s.previousTree??s.treeId,n).filter(o=>o!==s.treeId)},Ls=(r,s)=>{const n=s.map,o=n.filter(i=>i.active),t={};if(o[0].index>0){const i=n[o[0].index-1];t[i.treeId]=Object.keys(r).filter(a=>a!==s.id)}return Object.values(r).forEach(i=>{const a=i.history[s.id];a&&o.forEach((d,l,c)=>{const p=a[d.index];if(p)if(l===c.length-1)p.forEach(x=>{t[x]===void 0&&(t[x]=[]),t[x].push(i.id)});else{const x=p==null?void 0:p[p.length-1];t[x]===void 0&&(t[x]=[]),t[x].push(i.id)}})}),t},Ds=(r,s,n)=>{const o=s[0],t={},i=r.history[n];if(i){const a=i[o.index];a&&a.forEach(d=>{t[d]===void 0&&(t[d]=[]),t[d].push(r.id)})}return t},Us=(r,s)=>{const o=(s.map??[]).filter(i=>!i.passed),t={};return Object.values(r).forEach(i=>{const a=i.history[s.id];a&&o.forEach((d,l,c)=>{const p=a[d.index];if(p)if(l===c.length-1)p.forEach(x=>{t[x]===void 0&&(t[x]=[]),t[x].push(i.id)});else{const x=p==null?void 0:p[p.length-1];t[x]===void 0&&(t[x]=[]),t[x].push(i.id)}})}),t},Bs=(r,s,n=!1,o=[])=>{const t=me.union(r.filter(i=>i.passed).map(i=>i.treeId),o);return s.map(i=>{const a=ge(t[t.length-1],t),d=i.treeId,l=n?Ne([...a,d]):Ne(a);return t.push(l),l})};function ks(){const r=Ye({initialWidth:300,initialHeight:300}),[s,n]=W.useState(r);return W.useEffect(()=>{const o=document.getElementById("screen");o&&n({width:Math.min(o.clientWidth,r.width),height:Math.min(o.clientHeight,r.height)})},[r.width,r.height]),[s.width,s.height]}function Ce({segment:r,tree:s,startingTeeId:n,finalTreeId:o,currentTreeId:t,showPath:i=!1,showArrow:a=!1,className:d="",hidePassedTreeNames:l=!1,width:c=75}){const p=!!r,x=n===s.id,N=Fs(s.id),g=o===s.id,I=t===s.id,b=((r==null?void 0:r.passed)&&!I)??!1;return e.jsxs("div",{className:C("forest__tree",x&&`forest__tree--${N}`,g&&i&&"forest__tree--goal",p&&i&&"forest__tree--segment",b&&"forest__tree--passed",I&&"forest__tree--current",d),children:[e.jsx(Y,{id:s.treeType,text:r!=null&&r.passed&&l?"":s.card.text,width:c}),i&&g&&e.jsx(_,{icon:e.jsx(ls,{}),size:"large",className:`forest__end forest__end--${r.direction}`}),I&&e.jsx("div",{className:"forest__compass",children:e.jsx(_,{icon:e.jsx(He,{}),size:"large",className:C("forest__compass-icon",Q("pulse",{infinite:!0}))})}),x&&e.jsx(_,{icon:e.jsx(_e,{}),size:"large",className:`forest__start forest__start--${N}`}),(a||i||b)&&!g&&p&&r.direction&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:C(`forest__arrow-line forest__arrow-line--${r.direction}`,p&&i&&"forest__tree--segment",b&&"forest__tree--passed",I&&"forest__tree--current")}),e.jsx(_,{icon:e.jsx(q,{}),size:"large",className:`forest__arrow forest__arrow--${r.direction}`})]})]})}function X({forest:r,map:s=[],showPath:n,actions:o,players:t,size:i="large",hidePassedTreeNames:a=!1,user:d=Je,forestBorderColor:l="transparent",playerMapping:c}){var h,m,S;const[p]=ks(),x=Xe(7,{gap:16,minWidth:60,maxWidth:100});if(!r||!s||s.length===0||!p)return e.jsx(U,{vertical:!0,children:e.jsx(_,{icon:e.jsx(Ue,{}),size:"large"})});const N=(h=s==null?void 0:s[0])==null?void 0:h.treeId,g=s.reduce((v,F)=>(v[F.treeId]=F,v),{}),I=((m=me.findLast(s,v=>v.passed))==null?void 0:m.treeId)??N,b=(S=s[s.length-1])==null?void 0:S.treeId,A=150*7+72,u=Math.min(A,p*(i==="small"?.5:.9))/A;return e.jsx("div",{className:"forest-container-area",children:e.jsx(ds,{initialScale:u,minScale:.5,maxScale:4,wheel:{step:.05,disabled:!0},centerOnInit:!0,children:({zoomIn:v,zoomOut:F,resetTransform:k})=>e.jsxs(e.Fragment,{children:[e.jsx(Pe,{position:"top",zoomIn:v,zoomOut:F,resetTransform:k}),e.jsx(Pe,{position:"bottom",zoomIn:v,zoomOut:F,resetTransform:k}),e.jsx(ps,{wrapperClass:C("forest-container",i==="small"&&"forest-container--small"),children:e.jsx("div",{className:"forest",style:{borderColor:l},children:r.map(f=>{const ve=g==null?void 0:g[f.id];if(o){const{selection:D=[],clickableTrees:$e,onSelectTree:Ve,activeTree:be,disabled:H}=o,G=$e.includes(f.id),ne=G||D.includes(f.id);if(ne){const ae=D.includes(f.id),Ee=be===f.id,Ie=D.indexOf(f.id);return e.jsxs("div",{className:C("forest__tree-container forest__tree-button",G&&H&&"forest__tree-button--disabled"),onClick:()=>{(ne&&!H||ne&&H&&!G)&&Ve(f.id)},children:[e.jsx(Ce,{segment:ve,tree:f,startingTeeId:N,finalTreeId:b,currentTreeId:I,showPath:n,className:C(G&&!H&&"forest__tree--clickable",ae&&"forest__tree--selected",Ee&&"forest__tree--active"),width:x}),ae&&I!==f.id&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:C(`forest__arrow-from-line forest__arrow-from-line--${ce(D[Ie-1],f.id)}`,ae&&"forest__tree--selected",Ee&&"forest__tree--active")}),e.jsx(_,{icon:e.jsx(q,{}),size:"large",className:C(`forest__arrow-to forest__arrow-to--${ce(D[Ie-1],f.id)}`)})]}),G&&!H&&e.jsx(_,{icon:e.jsx(q,{}),size:"large",className:C(`forest__arrow-to forest__arrow-to--${ce(D[D.length-1]??be,f.id)}`)}),e.jsx(Oe,{condition:!!t&&!!(c!=null&&c[f.id]),children:e.jsx("div",{className:"forest__players",children:!!t&&e.jsx(we,{players:t,playerIds:(c==null?void 0:c[f.id])??[],user:d})})})]},`tree-${f.id}`)}}return e.jsxs("div",{className:"forest__tree-container",children:[e.jsx(Ce,{segment:ve,tree:f,startingTeeId:N,finalTreeId:b,currentTreeId:I,showPath:n,hidePassedTreeNames:a,width:x}),e.jsx(Oe,{condition:!!t&&!!(c!=null&&c[f.id]),children:e.jsx("div",{className:"forest__players",children:!!t&&e.jsx(we,{players:t,playerIds:(c==null?void 0:c[f.id])??[],user:d})})})]},`tree-${f.id}`)})})})]})})})}function we({players:r,playerIds:s,user:n}){const{translate:o}=pe(),t=s.map(i=>r[i]);return e.jsx(xs,{list:t,user:n,tooltipPrefix:o("Último lugar visitado por: ","Last visited place by: ")})}function Pe({zoomIn:r,zoomOut:s,resetTransform:n,position:o}){return e.jsx(ye,{className:C("forest-container-controls",`forest-container-controls--${o}`),justify:"center",children:e.jsxs(ye,{children:[e.jsx(z,{onClick:()=>r(.1),size:"small",children:e.jsx(us,{})}),e.jsx(z,{onClick:()=>s(.1),size:"small",children:e.jsx(ms,{})}),e.jsx(z,{onClick:()=>n(),size:"small",children:e.jsx(hs,{})})]})})}function Re({children:r}){return e.jsx(Te,{icon:e.jsx(He,{}),children:r})}function ee({children:r}){return e.jsx(Te,{icon:e.jsx(oe,{}),children:r})}function se({children:r}){return e.jsx(Te,{icon:e.jsx(de,{}),children:r})}function Hs({user:r,forest:s,onSubmitMap:n}){var w;const o=(r==null?void 0:r.map)??[],t=o.filter(u=>!u.passed),i=t.map(u=>u.clues),[a,d]=W.useState(t.map(u=>null)),[l,c]=W.useState(0),[p,x]=W.useState([]),N=u=>{d(h=>{const m=[...h];return m[l]={...u},m}),c(h=>h+1)},g=u=>{d(h=>{const m=[...h];return m[l]=null,m}),x(h=>[...h,u]),c(h=>h+1)},I=u=>{d(h=>[...h].map((S,v)=>v<u?S:null)),x(h=>h.filter(m=>m!==u)),c(u)},b=u=>{d(h=>{var S;const m=[...h??[]];return m[u]&&(m[u].negate=!((S=m[u])!=null&&S.negate)),m})},A=a.map(u=>u==null?void 0:u.id).filter(Boolean),R=Ws(o,t==null?void 0:t[l]);return e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"map-builder",wrap:!0,children:t.map((u,h)=>{var S,v,F,k;if(u.passed)return e.jsx(e.Fragment,{});const m=s[u.treeId];return m?e.jsxs("div",{className:"map-builder__segment",children:[l===h&&e.jsx("div",{className:"map-builder__caret",children:e.jsx(_,{icon:e.jsx(js,{}),className:Q("bounce",{speed:"slow",infinite:!0}),size:"small"})}),!!a[h]&&e.jsx(ue,{title:e.jsx(j,{pt:`Clique para negar: Não-${(S=a==null?void 0:a[h])==null?void 0:S.text}`,en:`Click to negate: Non-${(v=a==null?void 0:a[h])==null?void 0:v.text}`}),children:e.jsxs(ie,{onClick:()=>b(h),disabled:!(a!=null&&a[h]),className:"map-builder__card map-builder__card--new",children:[((F=a==null?void 0:a[h])==null?void 0:F.negate)&&e.jsx(_,{icon:e.jsx(L,{}),size:"small",className:"map-builder__card-no"}),(k=a==null?void 0:a[h])==null?void 0:k.text]})}),((i==null?void 0:i[h])??[]).map(f=>e.jsxs("div",{className:"map-builder__card",children:[(f==null?void 0:f.negate)&&e.jsx(_,{icon:e.jsx(L,{}),size:"small",className:"map-builder__card-no"}),f.text]},f.id)),e.jsx(ie,{onClick:()=>I(h),disabled:!(a!=null&&a[h]||p.includes(h)),children:e.jsx(Y,{id:m.treeType,text:m.card.text})})]},`map-segment-${u.index}`):e.jsx(e.Fragment,{})})}),R.length>0&&e.jsxs(Me,{className:"contained",wrap:!0,children:[e.jsxs("strong",{children:[e.jsx(j,{pt:"Caminhos possíveis para a árvore atual",en:"Possible paths for the current tree"}),":"]}),R.map((u,h)=>{var m,S;return e.jsx(_s,{className:Q("tada",{delay:h}),children:(S=(m=s==null?void 0:s[u])==null?void 0:m.card)==null?void 0:S.text},`highlighted-possibility-${u}`)})]}),e.jsxs(Ge,{title:e.jsx(j,{pt:"Cartas",en:"Hand"}),contained:!0,children:[(r.hand??[]).map(u=>e.jsx(ie,{onClick:()=>N(u),disabled:A.includes(u.id)||l>=t.length,className:"map-builder__card-button",children:e.jsx(fs,{hideHeader:!0,children:u.text})},u.id)),e.jsx(z,{size:"large",type:"default",onClick:()=>g(l),disabled:!((w=i==null?void 0:i[l])!=null&&w.length),children:e.jsx(j,{pt:"Pular árvore",en:"Skip tree"})})]}),e.jsx(U,{children:e.jsx(Fe,{size:"large",disabled:A.length===0,onClick:()=>n({newMap:a}),children:e.jsx(j,{pt:"Enviar Mapa",en:"Submit Map"})})})]})}function Gs({players:r,user:s,announcement:n,forest:o,currentRound:t,onSubmitMap:i}){De();const a=Us(r,s);return e.jsxs($,{fullWidth:!0,announcement:n,children:[e.jsx(te,{children:t===1?e.jsx(j,{pt:"Construa o seu mapa",en:"Build your map"}):e.jsx(j,{pt:"Expanda seu mapa",en:"Expand your map"})}),e.jsx(B,{type:"rule",children:e.jsx(j,{pt:e.jsxs(e.Fragment,{children:["Você precisa ajudar os outros jogadores a descobrirem o seu caminho pela floresta.",e.jsx("br",{}),"Começando da ",e.jsx(Re,{children:"bússola"}),", escolha 1 carta para cada árvore do caminho.",e.jsx("br",{}),"Você ganha ",e.jsx(E,{children:"pontos"})," se jogadores adivinharem seu caminho, então tente fazer um bom trabalho."]}),en:e.jsxs(e.Fragment,{children:["You need to help the other players to discover your path through the forest.",e.jsx("br",{}),"Starting from the ",e.jsx(Re,{children:"compass"}),", choose 1 card for each tree of the path.",e.jsx("br",{}),"You earn ",e.jsx(E,{children:"points"})," if players guess your path correctly, so try to do a good job."]})})}),e.jsx(X,{forest:o,map:s.map,showPath:!0,hidePassedTreeNames:!0,players:r,playerMapping:a}),e.jsx(B,{type:"action",children:e.jsx(j,{pt:e.jsxs(e.Fragment,{children:["Clique nas cartas em sequência para definir seu mapa, uma carta por árvore.",e.jsx("br",{}),"Você pode fazer quantos segmentos quiser desde que pelo menos uma carta esteja em cada árvore (dessa rodada ou de uma rodada anterior já que as cartas são cumulativas).",e.jsx("br",{}),"Na barra abaixo, se quiser negar ",e.jsx(_,{icon:e.jsx(L,{}),size:"small"})," um adjectivo selecionado, clique nele acima da árvore para trocar.",e.jsx("br",{}),"Se quiser refazer uma árvore ",e.jsx(_,{icon:e.jsx(de,{}),size:"small"}),", clique nela.",e.jsx("br",{}),"Quando você estiver pronto, aperte Enviar Mapa."]}),en:e.jsxs(e.Fragment,{children:["Click on the cards in sequence to define your map, you can't skip any tree.",e.jsx("br",{}),"You can build as many segments you with as long as there is at least one card on each tree (from this round or a previous one since the cards are cumulative).",e.jsx("br",{}),"If you want to negate ",e.jsx(_,{icon:e.jsx(L,{}),size:"small"})," an adjective you selected, click on it below the tree to change.",e.jsx("br",{}),"If you want to redo a tree ",e.jsx(_,{icon:e.jsx(de,{}),size:"small"}),", click on it.",e.jsx("br",{}),"When you are ready, press Submit Map."]})})}),e.jsx(Hs,{user:s,forest:o,onSubmitMap:i})]})}function zs({user:r,announcement:s,forest:n}){return e.jsxs($,{fullWidth:!0,announcement:s,children:[e.jsx(te,{children:e.jsx(j,{pt:"Todos os jogadores já descobriam seu mapa completamente",en:"All players have discovered your map completely"})}),e.jsx(V,{contained:!0,children:e.jsx(j,{pt:e.jsx(e.Fragment,{children:"Aguarde pacientemente, você ainda vai participar na hora de adivinhar."}),en:e.jsx(e.Fragment,{children:"Sit and wait patiently, you will still participate when it's time to guess."})})}),e.jsx(X,{forest:n,map:r.map,showPath:!0})]})}function qs({players:r,state:s}){var l,c;const n=he(r,s),{step:o,setStep:t}=xe(),i=Rs(t),a=e.jsx(je,{icon:e.jsx(oe,{}),title:s.round.current===1?e.jsx(j,{pt:"Construa o seu mapa",en:"Build your map"}):e.jsx(j,{pt:"Expanda seu mapa",en:"Expand your map"}),currentRound:(l=s==null?void 0:s.round)==null?void 0:l.current,type:"overlay",children:e.jsx(V,{children:e.jsx(j,{pt:"Você consegue mapear as árvores usando apenas adjetivos?",en:"Can you map the tree path using only adjectives?"})})}),d=(c=n==null?void 0:n.map)==null?void 0:c.every(p=>p.passed);return e.jsx(re,{phase:s==null?void 0:s.phase,allowedPhase:O.LABIRINTO_SECRETO.MAP_BUILDING,children:e.jsx(fe,{step:o,players:r,waitingRoom:{content:e.jsx(Ms,{forest:s.forest,map:n.map,newMap:n.newMap})},children:e.jsxs(Be,{condition:d,children:[e.jsx(zs,{user:n,announcement:a,forest:s.forest}),e.jsx(Gs,{players:r,user:n,announcement:a,forest:s.forest,currentRound:s.round.current,onSubmitMap:i})]})})})}function qe({segment:r,tree:s,showArrow:n,className:o}){return e.jsxs("div",{className:C("map-entry",o),children:[s&&e.jsx(Y,{id:s.treeType,text:s.card.text,className:"map-entry__tree"}),e.jsx(_,{icon:e.jsx(oe,{}),size:"large",className:"map-entry__icon"}),r.clues.map(t=>e.jsxs("div",{className:"map-entry__clue",children:[t.text,(t==null?void 0:t.negate)&&e.jsx(_,{icon:e.jsx(L,{}),size:"small",className:"map-entry__clue-no"})]},`clue-${r.index}-${t.id}`)),n&&e.jsx(_,{icon:e.jsx(q,{}),size:"small",className:"map-entry__arrow"})]},`map-${r.index}`)}const $s={id:0,treeType:0,card:{id:"",text:""}};function Se({map:r=[],selectedTrees:s=[],fullMap:n=!1}){const o=n?r:r.filter(t=>t.active);return e.jsx(U,{wrap:!0,className:"player-map",style:{gridTemplateColumns:`repeat(${o.length}, 100px)`},children:o.map((t,i,a)=>{const d=s[i+1],l=n&&a.length-1===i?$s:void 0;return e.jsx(qe,{className:"player-map__segment",tree:l??d,segment:t,showArrow:a.length-1!==i},`map-${t.index}`)})})}function Vs({forest:r,map:s=[],onSubmitPath:n,pathId:o,user:t,players:i}){var u,h;const a=s.filter(m=>!m.passed&&m.clues.length>0),d=((u=me.findLast(s,m=>m.passed))==null?void 0:u.treeId)??((h=s==null?void 0:s[0])==null?void 0:h.treeId)??0,l=s.filter(m=>m.passed).map(m=>m.treeId),c=Ds(t,a,o),[p,x]=W.useState([d]),[N,g]=W.useState(d),I=ge(N,[...p,...l]),b=p.length>a.length,A=m=>{g(m);const S=p.indexOf(m);S>-1?x(v=>v.slice(0,S+1)):x(v=>[...v,m])},R=p.map(m=>r[m]),w=a==null?void 0:a[p.length-1];return De(),e.jsxs(U,{vertical:!0,children:[e.jsx(Se,{map:s,selectedTrees:R}),e.jsx(vs,{active:!!w,children:e.jsx(qe,{segment:w,className:Q("rubberBand")},w==null?void 0:w.treeId)}),e.jsx(Fe,{size:"large",onClick:()=>n({guess:p.slice(1),pathId:o,choseRandomly:!1}),disabled:p.length-1<a.length,children:e.jsx(j,{pt:"Concluir",en:"Submit"})}),e.jsx(Ss,{onClick:()=>n({guess:Bs(s,a,!0,Object.values(c).flat().map(Number)),pathId:o,choseRandomly:!0}),ghost:!0,children:"Random Dev"}),e.jsx(X,{forest:r,map:s,actions:{selection:p,clickableTrees:I,onSelectTree:A,activeTree:N,disabled:b},playerMapping:c,players:i})]})}function Ys({players:r,announcement:s,forest:n,activePlayer:o,onSubmitPath:t,user:i}){const a=Object.keys(r).length;return e.jsxs($,{fullWidth:!0,announcement:s,children:[e.jsx(te,{children:e.jsx(j,{pt:e.jsxs(e.Fragment,{children:["Siga o mapa de ",e.jsx(K,{player:o})]}),en:e.jsxs(e.Fragment,{children:["Follow ",e.jsx(K,{player:o}),"'s map"]})})}),e.jsx(B,{type:"action",children:e.jsx(j,{pt:e.jsxs(e.Fragment,{children:["Baseado no ",e.jsx(ee,{children:"mapa de adjetivos"}),", clique nas"," ",e.jsx(se,{children:"árvores"})," circuladas de pontinhos brancos para escolher aquele caminho.",e.jsx("br",{}),"Cada árvore correta vale ",e.jsx(E,{children:"1 ponto"})," por jogador que acertar (Por exemplo, 3 jogadores = 3 pontos).",e.jsx("br",{}),"Então, talvez valha a pena discutir! Porém, se somente um jogador acertar o caminho, ele ganha"," ",e.jsxs(E,{children:[a," pontos"]}),".",e.jsx("br",{}),"O criador do mapa ganha o mesmo número de pontos que os jogadores."]}),en:e.jsxs(e.Fragment,{children:["Based on the ",e.jsx(ee,{children:"adjectives map"}),", click on the"," ",e.jsx(se,{children:"circled trees"})," with white dots to choose that path.",e.jsx("br",{}),"Each correct tree is worth ",e.jsx(E,{children:"1 point"})," per player that guesses it (For example, 3 players = 3 points).",e.jsx("br",{}),"So, it might be worth discussing out loud! However, if only one player guesses the path, they earn ",e.jsxs(E,{children:[a," points"]}),".",e.jsx("br",{}),"The map creator also earns the same number of points as the players."]})})}),!!n&&o.map&&e.jsx(Vs,{forest:n,map:o.map,onSubmitPath:t,pathId:o.id,user:i,players:r})]})}function Xs({players:r,announcement:s,forest:n,activePlayer:o}){const t=Object.keys(r).length;return e.jsxs($,{fullWidth:!0,announcement:s,children:[e.jsx(te,{children:e.jsx(j,{pt:e.jsx(e.Fragment,{children:"Os jogadores estão seguindo o seu mapa!"}),en:e.jsx(e.Fragment,{children:"Players are following your map!"})})}),e.jsx(B,{type:"wait",children:e.jsx(j,{pt:e.jsxs(e.Fragment,{children:["Baseado no ",e.jsx(ee,{children:"mapa de adjetivos"}),", eles vão clicando nas"," ",e.jsx(se,{children:"árvores"})," para escolher o caminho.",e.jsx("br",{}),"Cada árvore correta vale ",e.jsx(E,{children:"1 ponto"})," por jogador que acertar. Por exemplo, 3 jogadores = 3 pontos.",e.jsx("br",{}),"Se somente um jogador acertar o caminho, ele ganha"," ",e.jsxs(E,{children:[t," pontos"]}),".",e.jsx("br",{}),"Você, como criador do mapa, ganha o mesmo número de pontos que os jogadores."]}),en:e.jsxs(e.Fragment,{children:["Based on the ",e.jsx(ee,{children:"adjectives map"}),", players will click on the"," ",e.jsx(se,{children:"trees"})," to choose the path.",e.jsx("br",{}),"Each correct tree is worth ",e.jsx(E,{children:"1 point"})," per player that guesses it. For example, 3 players = 3 points.",e.jsx("br",{}),"If only one player guesses the path, they earn"," ",e.jsxs(E,{children:[t," points"]}),".",e.jsx("br",{}),"You as the map creator also earns the same number of points as the players."]})})}),e.jsx(Se,{map:o.map}),e.jsx(X,{forest:n,map:o.map,showPath:!0})]})}function Js({players:r,state:s}){var c;const n=he(r,s),{step:o,setStep:t}=xe(),[i,a]=Ts("activePlayerId",s,r),d=As(t),l=e.jsx(je,{icon:e.jsx(ns,{}),title:e.jsx(j,{pt:"Siga os mapas!",en:"Follow the maps!"}),currentRound:(c=s==null?void 0:s.round)==null?void 0:c.current,type:"overlay",duration:3,children:e.jsxs(V,{children:[e.jsx(j,{pt:"Vamos analisar e tentar seguir o mapa de cada jogador",en:"Let's analise and try to follow the each player's map"}),e.jsx("br",{}),e.jsx(gs,{players:r,order:s.turnOrder,activePlayerId:s.activePlayerId})]})});return e.jsx(re,{phase:s==null?void 0:s.phase,allowedPhase:O.LABIRINTO_SECRETO.PATH_FOLLOWING,children:e.jsx(fe,{step:o,players:r,children:e.jsxs(Be,{condition:a,children:[e.jsx(Xs,{players:r,announcement:l,forest:s.forest,activePlayer:i}),e.jsx(Ys,{players:r,user:n,announcement:l,forest:s.forest,onSubmitPath:d,activePlayer:i,isTheActivePlayer:a})]})})})}function Qs({players:r,ranking:s,onGoBack:n,round:o}){return e.jsxs(Is,{players:r,ranking:s,gainedPointsDescriptions:[e.jsx(j,{pt:"Rotas corretos",en:"Correct paths"},"1"),e.jsx(j,{pt:"Pontos por sua rota",en:"Points for your route"},"2")],children:[e.jsx(B,{type:"event",children:e.jsx(j,{pt:"Não se preocupe se você ficou pra trás! O jogador mais a frente de cada rota, te gritou e você conseguiu encontrá-lo.",en:"Don't worry if you were left behind! The player furthest ahead on that route, call you and you caught up"})}),e.jsx(U,{children:e.jsx(z,{onClick:n,children:e.jsx(j,{pt:"Ver resultado novamente",en:"See results again"})})}),e.jsx(es,{round:o})]})}function Ks({players:r,forest:s,currentPlayer:n}){const o=n.map.filter(t=>t.active);return e.jsx("div",{className:"div-container player-map",style:{gridTemplateColumns:`repeat(${o.length}, 120px)`},children:o.map((t,i,a)=>{const d=t.passed?s[t.treeId]:null;return e.jsxs("div",{className:"player-map__segment",children:[e.jsxs("div",{className:"player-map__top",children:[d?e.jsx(Y,{id:d.treeType,text:d.card.text,className:"player-map__tree",width:75}):e.jsx(ke,{id:"1",className:"player-map__tree-invisible",text:"",width:75}),e.jsx(_,{icon:e.jsx(oe,{}),size:"large",className:"player-map__icon"}),e.jsx("div",{children:t.clues.map(l=>e.jsxs("div",{className:"player-map__clue",children:[l.text,(l==null?void 0:l.negate)&&e.jsx(_,{icon:e.jsx(L,{}),size:"small",className:"player-map__clue-no"})]},`clue-${t.index}-${l.id}`))}),t.index===0&&e.jsx(_,{icon:e.jsx(_e,{}),size:"small",className:"player-map__starting-flag"}),a.length-1!==i&&e.jsx(_,{icon:e.jsx(q,{}),size:"small",className:"player-map__arrow"})]}),e.jsxs("div",{className:"player-map__scoring",children:[t.playersIds.length>0?e.jsx("div",{className:"player-map__players",children:t.playersIds.map(l=>{const c=r[l];return e.jsx(ue,{title:c.name,children:e.jsx(Ns,{size:"small",id:c.avatarId})},`player-${l}`)})}):e.jsx("div",{className:"player-map__no-players",children:e.jsx(j,{pt:"Nenhum jogador",en:"No players"})}),e.jsx("div",{children:t.score>0&&e.jsx(E,{children:t.score})})]})]},`map-${t.index}`)})})}function Zs({players:r,gallery:s,user:n,forest:o,slideShowConfig:t}){const i=Object.keys(r).length,a=s[t.slideIndex],d=le(a.avatarId),l=Ls(r,a);return e.jsxs($,{fullWidth:!0,children:[e.jsx(Ae,{children:e.jsx(j,{pt:e.jsxs(e.Fragment,{children:["Mapa do(a) ",e.jsx(K,{player:a})]}),en:e.jsxs(e.Fragment,{children:[e.jsx(K,{player:a}),"'s map"]})})}),e.jsx(B,{type:"rule",children:e.jsx(j,{pt:e.jsxs(e.Fragment,{children:["Você ganha pontos ao acertar o caminho do mapa. ",e.jsx("br",{}),"Cada árvore correta vale ",e.jsx(E,{children:"1 ponto"})," por jogador que acertar."," ",e.jsx("br",{}),"Se você for o único que acertou, você ganha"," ",e.jsxs(E,{children:[i," pontos"]}),"."]}),en:e.jsxs(e.Fragment,{children:["You get points by guessing the map path. ",e.jsx("br",{}),"Each correct tree is worth ",e.jsx(E,{children:"1 point"})," per player who guesses it."," ",e.jsx("br",{}),"If you are the only one who guessed it, you get"," ",e.jsxs(E,{children:[i," points"]}),"."]})})}),e.jsx(Ks,{players:r,forest:o,currentPlayer:a}),e.jsxs("div",{children:[e.jsx(X,{forest:o,map:a.map,size:"small",players:r,user:n,forestBorderColor:le(a.avatarId),playerMapping:l}),e.jsx(bs,{config:t,barColor:d})]})]})}function er({players:r,state:s}){var c;const n=he(r,s),{step:o,goToPreviousStep:t,goToNextStep:i}=xe(),a=W.useMemo(()=>We(r).filter(p=>p.map.some(x=>x.active)),[r]),d=Es({length:a.length,slideDuration:Ps,onExpire:i}),l=()=>{d.reset(),t()};return e.jsx(re,{phase:s==null?void 0:s.phase,allowedPhase:O.LABIRINTO_SECRETO.RESULTS,children:e.jsxs(fe,{step:o,players:r,children:[e.jsx(je,{icon:e.jsx(as,{}),title:e.jsx(j,{pt:"Resultado",en:"Results"}),currentRound:(c=s==null?void 0:s.round)==null?void 0:c.current,type:"block",onClose:i,unskippable:!0,children:e.jsx(V,{children:e.jsx(j,{pt:"Quem é o melhor em seguir direções?",en:"Who is the best at following directions?"})})}),e.jsx(Zs,{gallery:a,players:r,slideShowConfig:d,forest:s.forest,user:n}),e.jsx(Qs,{players:r,round:s.round,ranking:s.ranking,onGoBack:l})]})})}const T={MOST_CARDS:"MOST_CARDS",FEWEST_CARDS:"FEWEST_CARDS",MOST_NEGATIVE_CARDS:"MOST_NEGATIVE_CARDS",FEWEST_NEGATIVE_CARDS:"FEWEST_NEGATIVE_CARDS",MOST_TREES:"MOST_TREES",FEWEST_TREES:"FEWEST_TREES",BEST_MAP:"BEST_MAP",WORST_MAP:"WORST_MAP",BEST_SCOUT:"BEST_SCOUT",WORST_SCOUT:"WORST_SCOUT",MOST_UP:"MOST_UP",MOST_RIGHT:"MOST_RIGHT",MOST_DOWN:"MOST_DOWN",MOST_LEFT:"MOST_LEFT",MOST_UP_LEFT:"MOST_UP_LEFT",MOST_UP_RIGHT:"MOST_UP_RIGHT",MOST_DOWN_LEFT:"MOST_DOWN_LEFT",MOST_DOWN_RIGHT:"MOST_DOWN_RIGHT"},sr={[T.MOST_CARDS]:{icon:"list",title:{pt:"Mais Cartas",en:"Most Cards"},description:{pt:"Usou o maior número de cartas",en:"Used the most cards"}},[T.FEWEST_CARDS]:{icon:"ellipsis",title:{pt:"Menos Cartas",en:"Fewest Cards"},description:{pt:"Usou o menor número de cartas",en:"Used the fewest cards"}},[T.MOST_NEGATIVE_CARDS]:{icon:"minus",title:{pt:"Mais Adjetivos Negativos",en:"Most Negative Adjectives"},description:{pt:"Usou o maior número de cartas negativas",en:"Used the most negative cards"}},[T.FEWEST_NEGATIVE_CARDS]:{icon:"plus",title:{pt:"Menos Cartas Negativas",en:"Fewest Negative Cards"},description:{pt:"Usou o menor número de cartas negativas",en:"Used the fewest negative cards"}},[T.MOST_TREES]:{icon:"tree",title:{pt:"Mais Árvores",en:"Most Trees"},description:{pt:"Passou pelo maior número de árvores",en:"Passed by the most trees"}},[T.FEWEST_TREES]:{icon:"x",title:{pt:"Menos Árvores",en:"Fewest Trees"},description:{pt:"Passou pelo menor número de árvores",en:"Passed by the fewest trees"}},[T.BEST_MAP]:{icon:"sun",title:{pt:"Melhor Guia",en:"Best Guide"},description:{pt:"Construiu um mapa que os outros jogadores melhor encontraram as direções corretas",en:"Built a map that other players found the correct directions the best"}},[T.WORST_MAP]:{icon:"arrows",title:{pt:"Mapeador Divergente",en:"Diverging Mapper"},description:{pt:"Construiu um mapa que os outros jogadores tiveram mais dificuldade em encontrar as direções corretas",en:"Built a map that other players had the most difficulty finding the correct directions"}},[T.BEST_SCOUT]:{icon:"foot-prints",title:{pt:"Melhor Explorador",en:"Best Scout"},description:{pt:"Acertou as árvores corretas mais vezes",en:"Hit the correct trees the most times"}},[T.WORST_SCOUT]:{icon:"face-tired",title:{pt:"Explorador Confuso",en:"Confused Scout"},description:{pt:"Acertou as árvores corretas menos vezes",en:"Hit the correct trees the fewest times"}},[T.MOST_UP]:{icon:"arrow-up",title:{pt:"Norte",en:"North"},description:{pt:"Andou mais para cima",en:"Walked more up"}},[T.MOST_RIGHT]:{icon:"arrow-right",title:{pt:"Leste",en:"East"},description:{pt:"Andou mais para direita",en:"Walked more right"}},[T.MOST_DOWN]:{icon:"arrow-down",title:{pt:"Sul",en:"South"},description:{pt:"Andou mais para baixo",en:"Walked more down"}},[T.MOST_LEFT]:{icon:"arrow-left",title:{pt:"Oeste",en:"West"},description:{pt:"Andou mais para esquerda",en:"Walked more left"}},[T.MOST_UP_LEFT]:{icon:"double-arrow-up",title:{pt:"Noroeste",en:"Northwest"},description:{pt:"Andou mais para cima e esquerda",en:"Walked more up and left"}},[T.MOST_UP_RIGHT]:{icon:"double-arrow-up",title:{pt:"Nordeste",en:"Northeast"},description:{pt:"Andou mais para cima e direita",en:"Walked more up and right"}},[T.MOST_DOWN_LEFT]:{icon:"double-arrow-down",title:{pt:"Sudoeste",en:"Southwest"},description:{pt:"Andou mais para baixo e esquerda",en:"Walked more down and left"}},[T.MOST_DOWN_RIGHT]:{icon:"double-arrow-down",title:{pt:"Sudeste",en:"Southeast"},description:{pt:"Andou mais para baixo e direita",en:"Walked more down and right"}}};function rr({state:r,players:s}){const n=We(s),o=r.forest??[];return e.jsxs(Os,{state:r,players:s,announcementIcon:e.jsx(_e,{}),children:[e.jsx(Cs,{players:s,achievements:r.achievements,reference:sr}),e.jsx(Ge,{title:e.jsx(j,{pt:"Mapas dos Jogadores",en:"Players' Maps"}),children:n.map(t=>{const i=(t.map??[]).map(a=>o[a.treeId]);return e.jsxs(Me,{className:"game-over-strip",style:{borderColor:le(t.avatarId)},children:[e.jsx(ys,{player:t,withName:!0,className:"game-over-avatar-strip"}),e.jsx(Se,{map:t.map,fullMap:!0,selectedTrees:i})]},t.id)})})]})}function tr(r){if(r&&!r.phase)return Ke;switch(r.phase){case O.DEFAULT.LOBBY:return os;case O.DEFAULT.RULES:return ts;case O.DEFAULT.SETUP:return rs;case O.DEFAULT.WAIT:return ws;case O.LABIRINTO_SECRETO.MAP_BUILDING:return qs;case O.LABIRINTO_SECRETO.PATH_FOLLOWING:return Js;case O.LABIRINTO_SECRETO.RESULTS:return er;case O.DEFAULT.GAME_OVER:return rr;default:return Ze}}function yt(){return e.jsx(ss,{gameCollection:Qe.LABIRINTO_SECRETO,getActiveComponent:tr})}export{yt as default};
