import{r as g,$ as T,bp as C,bH as z,aw as D,v as y,j as a,c as $,av as h,T as k,bv as F}from"./index-sVTxFDD7.js";import{u as G}from"./DebugOnly-TgI2C47y.js";import{P}from"./PlayerAvatar-DnsbNrmw.js";var L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zM512 734.2c-62.1 0-112.6-50.5-112.6-112.6S449.9 509 512 509s112.6 50.5 112.6 112.6S574.1 734.2 512 734.2zm0-160.9c-26.6 0-48.2 21.6-48.2 48.3 0 26.6 21.6 48.3 48.2 48.3s48.2-21.6 48.2-48.3c0-26.6-21.6-48.3-48.2-48.3z"}}]},name:"crown",theme:"filled"};function f(){return f=Object.assign?Object.assign.bind():function(s){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(s[e]=i[e])}return s},f.apply(this,arguments)}const H=(s,n)=>g.createElement(T,f({},s,{ref:n,icon:L})),I=g.forwardRef(H);function q({gainedPoint:s,order:n,description:i}){const e=s>0,t=s<0;return a.jsx("li",{className:$("ranking-board__gained-point",e&&"ranking-board__gained-point--plus",t&&"ranking-board__gained-point--minus",`ranking-board__gained-point--${n}`),children:a.jsxs(h,{title:i??a.jsx(k,{pt:"Pontos ganhos",en:"Gained Points"}),color:e?"gold":t?"red":"gray",children:[e?"+":"",s]})})}function R({gainedPoints:s,playerId:n,gainedPointsDescriptions:i=[]}){const e=Array.isArray(s)?s:[s];return a.jsx("ul",{className:"ranking-board__cell-gained-points",children:e.map((t,m)=>a.jsx(q,{gainedPoint:t,order:m,description:i[m]},`gained-point-${n}-${m}`))})}function U({players:s,ranking:n,gainedPointsDescriptions:i,hideGainedPoints:e=!1,delay:t=0,victoryIndex:m=0}){const[v,j]=g.useState(0),[N,A]=g.useState([]),[w,E]=g.useState(0),[B,{height:S}]=C(),M=g.useId(),O=g.useMemo(()=>z(n.map(l=>l.newScore).sort((l,c)=>c-l)),[n]),{seconds:_}=G({duration:5+t,autoStart:!0,onExpire:()=>{E(1),j(3)}});return D(()=>{const l={};let c=0,r=0;const x=y.orderBy(n,["newScore","name"],["desc","asc"]).reduce((d,p,o)=>(d[p.playerId]=o,(r===0||p.newScore<r)&&(r=p.newScore,c+=1),l[p.playerId]=[0,c],d),{}),b=y.orderBy(n,["previousScore","name"],["desc","asc"]);c=0,r=0;const u=b.map((d,p)=>{const o={...d};return o.order=[p,x[o.playerId]],o.position=l[o.playerId],(r===0||d.previousScore<r)&&(r=d.previousScore,c+=1),o.position[0]=c,o});A(u)}),g.useEffect(()=>{_===4+t?j(1):_===2+t&&j(2)},[_,t]),a.jsxs("div",{className:$("ranking-board",_>4&&"ranking-board--hidden",_===4&&F("fadeIn")),style:{height:`${(Math.max(60,S)+8)*N.length}px`},children:[a.jsxs("div",{className:"ranking-board__row",id:`ranking-row-${M}-placeholder`,style:{opacity:0},ref:B,children:[a.jsx("div",{className:"ranking-board__cell-crown",children:a.jsx(I,{className:"ranking-board__crown-icon"})}),a.jsx("div",{className:"ranking-board__cell-position",children:"#0"}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(P,{avatarId:"A"})}),a.jsx("div",{className:"ranking-board__name",children:"Placeholder"})]}),a.jsx(h,{title:a.jsx(k,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:"0"})}),a.jsx(R,{gainedPoints:0,playerId:"A"}),a.jsx(h,{title:"Total",color:"gold",children:a.jsx("span",{className:"ranking-board__cell-points-total",children:"0"})})]}),N.map((l,c)=>{const{playerId:r,newScore:x,previousScore:b,gainedPoints:u,order:d,position:p}=l,o=(Math.max(60,S)+8)*(d[w]??0);return a.jsxs("div",{className:`ranking-board__row ranking-board__row--${c}`,style:{top:`${o}px`},children:[a.jsx("div",{className:"ranking-board__cell-crown",children:O[m]===x&&v>=3&&a.jsx(I,{className:"ranking-board__crown-icon"})}),a.jsxs("div",{className:"ranking-board__cell-position",children:["#",p[w]??""]}),a.jsxs("div",{className:"ranking-board__cell-player",children:[a.jsx("div",{className:"ranking-board__avatar",children:a.jsx(P,{avatarId:s[r].avatarId})}),a.jsx("div",{className:"ranking-board__name",children:s[r].name})]}),a.jsx(h,{title:a.jsx(k,{pt:"Pontos Anteriores",en:"Previous Points"}),color:"gray",children:a.jsx("div",{className:"ranking-board__cell-points",children:b})}),!e&&v>=1&&u!==void 0&&a.jsx(R,{gainedPoints:u,playerId:r,gainedPointsDescriptions:i}),a.jsx(h,{title:"Total",color:"gold",children:v>=2?a.jsx("span",{className:"ranking-board__cell-points-total",children:x}):a.jsx("span",{className:"ranking-board__cell-points-total-preliminary",children:x})})]},`ranking-${r}`)})]})}export{U as R,I as a};
