import{r as m,aF as L,a7 as M,h as $,j as e,T as l,aP as T,k as ge,n as K,aQ as Y,b2 as Ce,b3 as ve,e as G,x as ye,O as Se,F as ie,ch as Q,P as be,B as W,aM as Ie,aT as ce,cj as Re,cq as we,cg as Ee,q as le,bo as Pe,cr as Te,o as Ne,a_ as Ae}from"./index-DvppfgRv.js";import{u as Z,S as U,a as _,P as F,f as Ge,c as We,d as ke,e as Be}from"./Session-X-N4hf4T.js";import{G as Oe}from"./GridIcon-CbGrN1IJ.js";import{S as q,P as D,a as V,u as Le}from"./StepSwitcher-GRRK4efZ.js";import{R as Me}from"./RoundAnnouncement-Cy0tFB_F.js";import{P as S}from"./PointsHighlight-Bs0aLT2D.js";import{I as J}from"./useDevFeatures-w3W2BPgK.js";import{T as H}from"./TextHighlight-CzzSq99L.js";import{R as k}from"./RuleInstruction-Ce3WP52S.js";import{P as X}from"./PopoverRule-bex7tCWl.js";import{S as $e,a as Ue}from"./SpreadsheetGrid-C5VDqD8b.js";import{a as _e}from"./DebugOnly-f-8UdT-g.js";import{u as Fe}from"./useTDBaseUrl-BF9foKiS.js";import{I as qe}from"./ItemCard-CaP1t_mc.js";/* empty css                             */import{I as de}from"./ImageBlurButtonContainer-CG0vBwYl.js";import{I as De}from"./ImageCard-DhQL9sKw.js";import{u as ue}from"./useMock-Dswnhv6P.js";import{G as Ve}from"./GuessIcon-D6Ns5Qh5.js";import{D as ze,a as He,u as Ye,b as Ke,c as Qe,P as Ze}from"./DragAndDrop-BIsX7cBA.js";import{P as Je}from"./PlayerAvatar-4I-LnJ6Z.js";import{R as me}from"./PlusCircleFilled-7Cdr7FmG.js";import{R as Xe}from"./iconUtil-CB_wrvrW.js";import{R as er}from"./ThunderboltOutlined-Cl9d9rUK.js";import{R as rr}from"./RankIcon-BDGHFaon.js";import{T as tr}from"./TimedButton-CI7WX-Lk.js";import{T as pe}from"./TitledContainer-C0jb369F.js";import{P as ee}from"./PlayerAvatarName-DErJPECv.js";import{F as sr}from"./Table-jS_1QvsW.js";import{R as nr}from"./TrophyOutlined-GJ8W9mNT.js";import{S as ar}from"./StepRankingWrapper-D5F24iM0.js";import{V as or}from"./VerifyListIcon-WbqTyDuw.js";import{u as ir}from"./useBooleanDictionary-Dzp_oOrM.js";import{C as cr}from"./Card-WbYe71KY.js";import{B as lr}from"./index-nROAR8Mh.js";import{T as dr}from"./TrophyIcon-B6ZaOE0q.js";import"./GameBanner-sa2yhoJA.js";import{G as ur}from"./GameOverWrapper-BPyd_8y0.js";import{A as mr}from"./Achievements-D9TRJ4BY.js";import{a as pr}from"./achievements-B2fypp9m.js";import{D as xr}from"./index-Dpp6_Nt0.js";import"./Game-Ch5JUYDX.js";import"./useMutation-CdsDiU7r.js";import"./speech-DB2TJQrk.js";import"./index-B6lvJW0z.js";import"./index-Bk4RdLjp.js";import"./Overflow-CZZSli7j.js";import"./PurePanel-C9S70P0-.js";import"./index-JzbJh84j.js";import"./RulesModal-BupD63Bo.js";import"./WritingIcon-DQQLo40-.js";import"./index-qRlSqIqu.js";import"./index-DF_wMmXU.js";import"./index-BsP26atl.js";import"./useBubbleLock-CKJopiFI.js";import"./InfoCircleOutlined-BXVUvu-2.js";import"./useToggle-DTgQq2Yy.js";import"./SignIn-DdSI9y1n.js";import"./GoogleIcon-3W4a7kM5.js";import"./AnimatedGearIcon-B24Zs_ID.js";import"./AnimatedClockIcon-D32Srta7.js";import"./Loading-BIZ_exdO.js";import"./AnimatedLoaderIcon-D7DW2oqt.js";import"./WaitingRoomIcon-Cr_Gt9Nn.js";import"./LikeFilled-B_cr3hlL.js";import"./StarIcon-BiKTXYQ2.js";import"./MetricHighlight-g7-kGe_z.js";import"./StarFilled-ux0NNX7L.js";import"./Sprite-B6DIA9QU.js";import"./WarningOutlined-D7wFJdME.js";import"./ImageBlurButton-DrAF5C05.js";import"./EllipsisOutlined-CJly6ZPQ.js";import"./index-B-ePZ_54.js";import"./scrollTo-Baquy7LE.js";import"./FilterFilled-D8eOtwhc.js";import"./CaretDownOutlined-BJIGCgik.js";import"./CaretUpOutlined-TvuZELu9.js";import"./RankingBoard-DS2XfLZ2.js";import"./TheEndIcon-Cr396Q8e.js";import"./ArrowRightOutlined-B_l1V0lD.js";import"./progress-DAcelAuX.js";import"./Medal-CrePrlMI.js";var hr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM695.5 365.7l-210.6 292a31.8 31.8 0 01-51.7 0L308.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H689c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-square",theme:"filled"},jr=function(t,s){return m.createElement(L,M({},t,{ref:s,icon:hr}))},fr=m.forwardRef(jr),gr={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112c17.7 0 32 14.3 32 32v736c0 17.7-14.3 32-32 32H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32zM639.98 338.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-square",theme:"filled"},Cr=function(t,s){return m.createElement(L,M({},t,{ref:s,icon:gr}))},vr=m.forwardRef(Cr),yr={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112c17.7 0 32 14.3 32 32v736c0 17.7-14.3 32-32 32H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32zm-40 72H184v656h656V184zM640.01 338.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-square",theme:"outlined"},Sr=function(t,s){return m.createElement(L,M({},t,{ref:s,icon:yr}))},br=m.forwardRef(Sr),Ir={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},Rr=function(t,s){return m.createElement(L,M({},t,{ref:s,icon:Ir}))},wr=m.forwardRef(Rr);const E={WORDS_SELECTION:"WORDS_SELECTION",CLUE_WRITING:"CLUE_WRITING",GUESSING:"GUESSING",REVEAL:"REVEAL"},re={SUBMIT_WORDS:"SUBMIT_WORDS",SUBMIT_CLUE:"SUBMIT_CLUE",SUBMIT_GUESSES:"SUBMIT_GUESSES"};function Er(r){const{translate:t}=$(),s=Z({actionName:"submit-words",onBeforeCall:()=>r(2),onError:()=>r(0),successMessage:t("Palavras enviadas com sucesso","Words submitted successfully"),errorMessage:t("Vixi, o aplicativo encontrou um erro ao tentar enviar suas palavras","Oops, the application failed to send your words")});return n=>{s({action:re.SUBMIT_WORDS,...n})}}function Pr(r){const{translate:t}=$(),s=Z({actionName:"submit-clue",onBeforeCall:()=>r(3),onError:()=>r(1),successMessage:t("Dica enviada com sucesso","Clue submitted successfully"),errorMessage:t("Vixi, o aplicativo encontrou um erro ao tentar enviar sua dica","Oops, the application failed to send your clue")});return n=>{s({action:re.SUBMIT_CLUE,...n})}}function Tr(r){const{translate:t}=$(),s=Z({actionName:"submit-guesses",onBeforeCall:()=>r(2),onError:()=>r(1),successMessage:t("Respostas enviadas com sucesso","Guesses submitted successfully"),errorMessage:t("Vixi, o aplicativo encontrou um erro ao tentar enviar suas respostas","Oops, the application failed to send your guesses")});return n=>{s({action:re.SUBMIT_GUESSES,...n})}}function xe({playerCount:r}){return e.jsx(J,{children:e.jsx(l,{pt:e.jsxs(e.Fragment,{children:["Você tem uma coordenada específica e única na grade de palavras.",e.jsx("br",{}),"Escreva uma dica (palavra única) que conecte as palavras da linha e da coluna assinalada a você.",e.jsx("br",{}),"Escreva algo bem simples e óbvio porque se ninguém entender você perderá"," ",e.jsxs(S,{type:"negative",children:["- ",r]})," pontos."]}),en:e.jsxs(e.Fragment,{children:["You will get an unique coordinate in the word grid.",e.jsx("br",{}),"You must write a single word clue that connects the word in the column and in the row of your coordinate.",e.jsx("br",{}),"Write something simple and obvious because if nobody gets your clue you will lose"," ",e.jsxs(S,{type:"negative",children:["- ",r]}),"points."]})})})}function te({playerCount:r}){return e.jsx(J,{children:e.jsx(l,{pt:e.jsxs(e.Fragment,{children:["Você ganha ",e.jsx(S,{children:"+2"})," pontos para cada célula com uma resposta correta sua.",e.jsx("br",{}),e.jsx(S,{children:"+1"})," ponto para cada célula com uma dica mas uma resposta errada sua.",e.jsx("br",{}),e.jsx(S,{children:"+1"})," ponto para cada voto correto que sua dica recebeu.",e.jsx("br",{}),"Mas se ninguém acertar sua dica, você perde"," ",e.jsxs(S,{type:"negative",children:["- ",r]})," pontos."]}),en:e.jsxs(e.Fragment,{children:["You get ",e.jsx(S,{children:"+2"})," points for each cell with your correct answer.",e.jsx("br",{}),e.jsx(S,{children:"+1"})," point for each cell with a clue but with a wrong answer of yours.",e.jsx("br",{}),e.jsx(S,{children:"+1"})," point for each correct vote your clue received.",e.jsx("br",{}),"But if nobody gets your clue correctly, you lose"," ",e.jsxs(S,{type:"negative",children:["- ",r]})," points."]})})})}function Nr({user:r,grid:t}){const s=t[r.currentClueCoordinate];return!r.clue||!s?null:e.jsxs(T,{direction:"vertical",className:"mb-10",children:[e.jsx(ge,{size:"xx-small",children:e.jsx(l,{pt:"Sua dica",en:"Your clue"})}),e.jsxs("span",{children:[e.jsx(H,{children:s.xText})," + ",e.jsx(H,{children:s.yText})," ="," ",e.jsx(H,{children:r.clue})]})]})}function Ar(r){return r.gridType==="contenders"?e.jsx(Gr,{...r}):r.gridType==="images"?e.jsx(Wr,{...r}):r.gridType==="items"?e.jsx(kr,{...r}):e.jsx(e.Fragment,{children:r.cell.text})}function Gr({cell:r}){const{shouldBeBlurred:t}=_e(),s=Fe("images"),n=K(8,{gap:16,minWidth:30,maxWidth:100}),o=r.id?.replace(/-/g,"/"),c=t(r.id);return e.jsxs("div",{className:"w-contender",style:{width:`${n}px`},children:[e.jsx(Y,{title:r.text,children:e.jsx("span",{className:"w-contender-name",children:r.text})}),e.jsx(Ce,{src:`${s}/${o}.jpg`,width:n,className:G("w-contender-image",c&&"w-contender-image--blur"),fallback:`${ve.IN_GAME}/w-no-image.jpg`,alt:r.text})]})}function Wr({cell:r}){const t=K(8,{gap:16,minWidth:30,maxWidth:100});return e.jsx("div",{className:"w-contender",style:{width:`${t}px`},children:e.jsx(de,{cardId:r.id??"",children:e.jsx(De,{cardId:r.id??"",cardWidth:t})})})}function kr({cell:r}){const t=K(8,{gap:16,minWidth:30,maxWidth:100});return e.jsx("div",{className:"w-contender",style:{width:`${t}px`},children:e.jsx(de,{cardId:r.id??"",children:e.jsx(qe,{itemId:r.id??"",text:{pt:r.text,en:r.text},width:t,className:"transparent-gradient"})})})}function z({grid:r,user:t,CellComponent:s,gridType:n,cellComponentProps:o={}}){const c=Math.sqrt(r.length);return e.jsx($e,{columns:c,rows:c,children:r.map(a=>e.jsxs(Ue,{header:a.kind==="header",children:[a.kind==="header"&&e.jsx(Ar,{cell:a,gridType:n}),a.kind==="cell"&&e.jsx(s,{...o,cell:a,user:t})]},`${a.index}-${a.kind}`))})}function se({clue:r}){return e.jsx("div",{className:"x-previous-clue",children:r})}function Br({x:r,y:t,onSubmit:s,disabled:n,index:o}){const[c,a]=m.useState(""),i=m.useRef(null),d=u=>{a(u.target.value)};return m.useEffect(()=>i?.current?.focus(),[]),ue(()=>{s({clue:`${r.substring(0,r.length/2)}${t.substring(t.length/2)}`,currentClueCoordinate:o})},[]),e.jsxs(ye,{direction:"vertical",children:[e.jsx(Se,{ref:i,placeholder:`${r} + ${t}`,onChange:d,onPressEnter:()=>s({clue:c,currentClueCoordinate:o})}),e.jsx(ie,{justify:"flex-end",children:e.jsx(Q,{onClick:()=>s({clue:c,currentClueCoordinate:o}),disabled:n||!c.length,children:e.jsx(l,{pt:"Enviar",en:"Submit"})})})]})}function Or({onSubmitClue:r,cell:t,user:s,disabled:n}){return t.writable&&s.id===t.playerId?e.jsx(be,{content:e.jsx(Br,{x:t.xText??"",y:t.yText??"",index:t.index,onSubmit:r}),title:e.jsx(l,{pt:"Escreva",en:"Write"}),trigger:"click",children:e.jsx(W,{shape:"circle",type:"primary",disabled:n,children:e.jsx(wr,{})})}):t.text?e.jsx(se,{clue:t.text}):null}function Lr({grid:r,gridType:t,user:s,onSubmitClue:n,players:o,announcement:c}){const{isLoading:a}=Ie(),i=d=>{n({clue:d.clue.trim().toLowerCase(),currentClueCoordinate:d.currentClueCoordinate})};return e.jsxs(q,{fullWidth:!0,announcement:c,children:[e.jsx(U,{children:e.jsx(l,{pt:"Escreva sua dica",en:"Write your clue"})}),e.jsx(X,{content:e.jsx(xe,{playerCount:Object.keys(o).length})}),e.jsx(k,{type:"action",children:e.jsx(l,{pt:e.jsxs(e.Fragment,{children:["Clique em um dos ícones na grade e escreva sua dica.",e.jsx("br",{}),"Você só precisa escrever a dica para uma das coordenadas.",e.jsx("br",{}),"Sua dica deve conter apenas ",e.jsx("strong",{children:"uma palavra única"}),".",e.jsx("br",{}),"Você ",e.jsx("strong",{children:"NÃO"})," pode usar nenhuma palavra que esteja na grade."]}),en:e.jsxs(e.Fragment,{children:["Click on the icon on either of the table cell and write your clue.",e.jsx("br",{}),"You only need to write the clue for one of the coordinates.",e.jsx("br",{}),"Your clue must be a ",e.jsx("strong",{children:"single-word"})," clue.",e.jsx("br",{}),"You can ",e.jsx("strong",{children:"NOT"})," use any words already in the table."]})})}),e.jsx(z,{grid:r,user:s,CellComponent:Or,cellComponentProps:{onSubmitClue:i,disabled:a},gridType:t})]})}function Mr({players:r,state:t,user:s}){const{step:n,goToNextStep:o,setStep:c}=_(0),a=Pr(c),i=e.jsx(D,{icon:e.jsx(Oe,{}),title:e.jsx(l,{pt:"Escreva!",en:"Write!"}),currentRound:t?.round?.current,type:"overlay",children:e.jsx(xe,{playerCount:Object.keys(r).length})});return e.jsx(F,{phase:t?.phase,allowedPhase:E.CLUE_WRITING,children:e.jsxs(V,{step:n,players:r,waitingRoom:{content:e.jsx(Nr,{grid:t.grid,user:s})},children:[e.jsx(Me,{round:t?.round,onPressButton:o,buttonText:" ",time:5}),e.jsx(Lr,{user:s,grid:t.grid,gridType:t.gameType,onSubmitClue:a,players:r,announcement:i})]})})}const $r=r=>!!r?.clue,w=r=>`${r?.clue}${ce}${r?.playerId}`,he=r=>r.split(ce)??["",""];function ne({isMatched:r,isSelected:t,clue:s,color:n,player:o,strikeMatches:c=!1}){return e.jsxs("div",{className:G("x-clue-card",t&&"x-clue-card--selected",n&&`color-border--${n}`),children:[e.jsx("span",{className:G("x-clue-card__icon",n&&`color-background--${n}`),children:r?o?e.jsx(Je,{avatarId:o?.avatarId}):e.jsx(Re,{}):e.jsx(me,{style:t?{color:"gold"}:{color:"white"}})}),e.jsx("span",{className:G("x-clue-card__clue",r&&c&&"x-clue-card__clue--matched"),children:s})]})}function je({clue:r,isSelected:t,isMatched:s,onActivateClue:n,color:o,disabled:c=!1}){const a=w(r);return e.jsx(ze,{id:a,disabled:c,onClick:()=>n(r),className:"x-clue-card-draggable",options:{dragOpacity:.8,dragScale:1.03,withTransition:!0},children:e.jsx(ne,{isMatched:s,isSelected:t,clue:r.clue,color:o,strikeMatches:!0})})}function Ur({onActivateClue:r,cell:t,active:s,guesses:n,clues:o,clueColors:c,user:a}){const i=t.index===s,d=Object.entries(n).find(C=>C[1]===t.index),[u,v]=d??[],[g,I]=he(u??""),p=v===t.index,h=p&&I===a.id,P=!!t.text||t.playerId===a.id||p;if(p&&h)return e.jsx(Y,{title:e.jsx(l,{pt:"Essa é a sua própria dica!",en:"This is your own clue!"}),children:e.jsx(ne,{isMatched:p,isSelected:i,clue:g||o.find(C=>C.playerId===a.id)?.clue,color:c[g]})});if(t.text)return e.jsx(se,{clue:t.text});if(t.playerId===a.id)return e.jsx(Y,{title:e.jsx(l,{pt:"Essa célula pertence a uma de duas outras dicas, então não pode ser essa",en:"This cell belongs to one of two other clues, so it can't be this one"}),children:e.jsx(W,{shape:"circle",ghost:!0,children:e.jsx(Xe,{})})});if(p){const C=o.find(B=>B.clue===g&&B.playerId===I);return C?e.jsx(je,{clue:C,isSelected:i,isMatched:!1,onActivateClue:r,color:c[g],disabled:I===a.id}):void 0}return e.jsx(He,{id:t.index,disabled:P,style:{width:"100%",height:"100%",minHeight:"4rem"},children:e.jsx(ie,{style:{outline:i?"2px solid gold":"none",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",minHeight:"inherit"},align:"center",justify:"center",vertical:!1,children:e.jsx(me,{style:{color:"white"}})})})}function _r({clues:r,clueColors:t,onActivateClue:s,active:n,guesses:o,user:c}){const a=r.filter(i=>i.playerId!==c.id);return e.jsx("ul",{className:"x-clue-cards",children:a.map(i=>{const d=typeof n!="number"&&i.coordinate===n?.coordinate,u=!!o[w(i)];return u?null:e.jsx("li",{className:"x-clue-card-li",children:e.jsx(je,{clue:i,isSelected:d,isMatched:u,color:t[i.clue],onActivateClue:s})},`${i.coordinate}-${i.clue}`)})})}function Fr({grid:r,gridType:t,user:s,clues:n,onSubmitGuesses:o,announcement:c}){const[a,i]=m.useState(null),[d,u]=m.useState({}),[v,g]=m.useState(!1),I=m.useMemo(()=>n.sort().reduce((j,x,f)=>(j[x.clue]=we(f),j),{}),[n]),p=m.useCallback(j=>{if(!a||$r(a)){i(j);return}typeof a=="number"&&(u(x=>({...x,[w(j)]:a})),i(null))},[a]),h=m.useCallback(()=>{const j=Object.entries(d).reduce((x,[f,b])=>{const[,R]=he(f);return x[R]=b,x},{});o({guesses:j,choseRandomly:v})},[d,o,v]);m.useEffect(()=>{const j=n.find(x=>x.playerId===s.id);if(j){const x=r.filter(f=>f.available&&f.playerId===s.id);if(x.length>0){const f=x.length===1?x[0]:x.find(b=>b.index===j.coordinate);f&&u(b=>({...b,[w(j)]:f.index}))}}},[n,r,s.id]);const P=()=>{const j=Object.values(d),x=Object.keys(d);g(!0);const f=Ee(r.filter(y=>y.available&&y.playerId!==s.id&&!j.includes(y.index))),R=n.filter(y=>!x.includes(w(y))).reduce((y,N,O)=>(N.playerId===s.id?y[w(N)]=N.coordinate:y[w(N)]=f[O].index,y),{});u({...R,...d})},C=Ye(Ke(Ze,{activationConstraint:{distance:8}})),B=m.useCallback(j=>{const{active:x,over:f}=j;if(f&&x.id!==f.id){const b=String(x.id),R=Number(f.id),y=n.find(A=>w(A)===b);if(y?.playerId===s.id||Object.values(d).includes(R))return;const O=r.find(A=>A.index===R);if(O&&O.playerId===s.id)return;y&&typeof R=="number"&&u(A=>({...A,[b]:R}))}},[n,d,s.id,r]);return e.jsxs(q,{fullWidth:!0,announcement:c,children:[e.jsx(U,{children:e.jsx(l,{pt:"Decifre as dicas!",en:"Guess the cells!"})}),e.jsxs(Qe,{sensors:C,onDragEnd:B,children:[e.jsx(_r,{clues:n,onActivateClue:p,active:a,guesses:d,user:s,clueColors:I}),e.jsx(k,{type:"action",children:e.jsx(l,{pt:"Arraste as dicas acima para as células correspondentes abaixo.",en:"Drag the clues above to their corresponding cells below."})}),e.jsxs(T,{align:"center",children:[e.jsx(W,{size:"large",type:"dashed",onClick:P,icon:e.jsx(er,{}),children:e.jsx(l,{pt:"Desistir",en:"Give up"})}),e.jsx(Q,{size:"large",onClick:h,disabled:Object.keys(d).length!==n.length,children:e.jsx(l,{pt:"Enviar respostas",en:"Send guesses"})})]}),e.jsx(z,{grid:r,gridType:t,user:s,CellComponent:Ur,cellComponentProps:{active:a,guesses:d,clues:n,clueColors:I,user:s}})]})]})}function qr({players:r,state:t,user:s}){const{step:n,setStep:o}=_(0),c=Tr(o),a=e.jsx(D,{icon:e.jsx(Ve,{}),title:e.jsx(l,{pt:"Match!",en:"Combine!"}),currentRound:t?.round?.current,type:"overlay",children:e.jsx(J,{children:e.jsx(l,{pt:e.jsxs(e.Fragment,{children:["Agora combine as dicas de cada jogador com as coordenadas corretas!",e.jsx("br",{}),"Basta clicar em uma das dicas no topo e então em uma das células da grade."]}),en:e.jsxs(e.Fragment,{children:["Now match the clues from each player with the correct coordinates",e.jsx("br",{}),"Just click on one of the clues on top then in one of the cells in the grid."]})})})});return e.jsx(F,{phase:t?.phase,allowedPhase:E.GUESSING,children:e.jsx(V,{step:n,players:r,children:e.jsx(Fr,{user:s,grid:t.grid,gridType:t.gameType,clues:t.clues,onSubmitGuesses:c,announcement:a})})})}function ae({badCluesPlayersList:r}){return e.jsx("span",{children:r.map((t,s)=>e.jsxs("span",{children:[e.jsx(ee,{player:t,size:"small"},`bad-clue-${t.id}`),r.length>0&&s<r.length-1?", ":""]},`bad-clue-${t.id}-${s}`))})}function Dr({players:r,grid:t,correctCoordinatesPerPlayer:s}){const{translate:n}=$(),o=[{title:n("Jogador","Player"),dataIndex:"player",key:"player",render:a=>e.jsx(ee,{player:a}),sorter:(a,i)=>a.playerName.localeCompare(i.playerName)},{title:n("Achou que","Thought that"),dataIndex:"guess",key:"guess",render:a=>a.toUpperCase(),sorter:(a,i)=>a.guess.localeCompare(i.guess)},{title:n("Era","Was"),dataIndex:"clue",key:"clue",render:a=>a.toUpperCase(),sorter:(a,i)=>a.clue.localeCompare(i.clue)},{title:n("Resultado","Result"),dataIndex:"result",key:"result",render:a=>a?e.jsx(fr,{style:{color:"green"}}):e.jsx(vr,{style:{color:"red"}}),sorter:a=>a.result===!0?1:-1}],c=m.useMemo(()=>{const a=Object.values(r).map(i=>Object.entries(i?.guesses??{}).reduce((d,[u,v])=>{if(u===i.id)return d;const g=t[v];return d.push({playerName:i.name,player:i,clue:`${g.yText} + ${g.xText}`,guess:r[u].clue,result:s?.[v]===u}),d},[]));return le.orderBy(a.flat(),["playerName","guess"],["asc","asc"])},[r,t,s]);return e.jsx(sr,{size:"small",columns:o,dataSource:c,pagination:!1})}function oe({cellPlayers:r,players:t}){return e.jsx("ul",{children:r.map(({playerId:s,isCorrect:n})=>n?e.jsx("li",{className:G(n&&"x-players-in-cell-player--correct"),children:e.jsx(ee,{player:t[s],size:"small"})},`players-in-cell-${s}`):void 0)})}function fe({cell:r,clues:t,players:s,playerPerVotedCell:n,colorCodedCluesPerPlayer:o}){const c=t.find(i=>i.coordinate===r.index),a=(n[r.index]??[]).filter(i=>i.isCorrect);return c?.playerId?e.jsxs("div",{className:"center",children:[e.jsx(ne,{isMatched:!0,clue:c.clue,color:o[c.playerId],player:s[c.playerId]}),a.length?e.jsx(oe,{cellPlayers:a,players:s}):e.jsx(br,{style:{color:"white"}})]}):r.text?e.jsx(se,{clue:r.text}):e.jsx("span",{children:!!a.length&&e.jsx(oe,{cellPlayers:a,players:s})})}const Vr=Pe;function zr({grid:r,gridType:t,user:s,players:n,clues:o,goToNextStep:c,whoGotNoPoints:a,announcement:i}){Le();const{correctCoordinatesPerPlayer:d,colorCodedCluesPerPlayer:u,whoGotNoPointsNames:v,playerCount:g}=m.useMemo(()=>({correctCoordinatesPerPlayer:o.reduce((p,h)=>(h.playerId&&(p[h.coordinate]=h.playerId),p),{}),colorCodedCluesPerPlayer:o.reduce((p,h)=>(h.playerId&&(p[h.playerId]=Vr[n[h.playerId].avatarId].color),p),{}),whoGotNoPointsNames:a.map(p=>n[p]),playerCount:Object.keys(n).length}),[n,o,a]),I=m.useMemo(()=>Object.values(n).reduce((p,h)=>(Object.entries(h.guesses??{}).forEach(([P,C])=>{P!==h.id&&(p[C]===void 0&&(p[C]=[]),p[C].push({playerId:h.id,color:u[P],isCorrect:d[C]===P}))}),p),{}),[n,d,u]);return e.jsxs(q,{fullWidth:!0,announcement:i,children:[e.jsx(U,{children:e.jsx(l,{pt:"Resultado",en:"Results"})}),e.jsx(X,{content:e.jsx(te,{playerCount:g})}),!!a.length&&e.jsx(k,{type:"alert",children:e.jsx(l,{pt:e.jsxs(e.Fragment,{children:["Ninguém acertou a(s) dica(s) dadas por",e.jsx(ae,{badCluesPlayersList:v}),", então ele(s) perde(m)"," ",e.jsxs(S,{type:"negative",children:["- ",g]})," pontos."]}),en:e.jsxs(e.Fragment,{children:["Nobody got the clues given by",e.jsx(ae,{badCluesPlayersList:v}),", so they lose"," ",e.jsxs(S,{type:"negative",children:["- ",g]})," points."]})})}),e.jsx(z,{grid:r,gridType:t,user:s,CellComponent:fe,cellComponentProps:{clues:o,players:n,playerPerVotedCell:I,colorCodedCluesPerPlayer:u}}),e.jsx(T,{align:"center",children:e.jsx(tr,{duration:Te(g,6,40,15)+5,icon:e.jsx(nr,{}),onExpire:c,onClick:c,children:e.jsx(l,{pt:"Ver Ranking",en:"See Ranking"})})}),e.jsx(pe,{title:e.jsx(l,{pt:"Todas as respostas",en:"All Answers"}),children:e.jsx(Dr,{correctCoordinatesPerPlayer:d,players:n,grid:r})})]})}function Hr({players:r,playerCount:t,ranking:s,goToPreviousStep:n,round:o}){return e.jsxs(ar,{players:r,ranking:s,gainedPointsDescriptions:[e.jsx(l,{pt:"Palpites corretos",en:"Correct guesses"},"1"),e.jsx(l,{pt:"Palpites que acertaram a célula de outra dica",en:"Guesses that were placed in a cell for a different clue"},"2"),e.jsx(l,{pt:"Palpites recebidos corretamente",en:"Received correct guesses"},"3"),e.jsx(l,{pt:"Penalidade se ninguém acertou a sua dica",en:"Penalty for nobody getting your clue correctly"},"4")],children:[e.jsx(X,{content:e.jsx(te,{playerCount:t})}),e.jsx(T,{align:"center",children:e.jsx(W,{onClick:n,children:e.jsx(l,{pt:"Ver resultado novamente",en:"See results again"})})}),e.jsx(Ge,{round:o,withWaitingTimeBar:!0}),o.current===3&&e.jsx(k,{type:"event",children:e.jsx(l,{pt:"Está pronto para uma reviravolta?",en:"Ready for a twist?"})})]})}function Yr({state:r,players:t,user:s}){const{step:n,goToNextStep:o,goToPreviousStep:c}=_(0),a=Object.keys(t).length,i=e.jsx(D,{icon:e.jsx(rr,{}),title:e.jsx(l,{pt:"Resultado",en:"Results"}),currentRound:r?.round?.current,type:"overlay",children:e.jsx(te,{playerCount:a})});return e.jsx(F,{phase:r?.phase,allowedPhase:E.REVEAL,children:e.jsxs(V,{step:n,players:t,children:[e.jsx(zr,{user:s,grid:r.grid,gridType:r.gameType,clues:r.clues,goToNextStep:o,players:t,whoGotNoPoints:r.whoGotNoPoints??[],announcement:i}),e.jsx(Hr,{players:t,playerCount:a,round:r.round,ranking:r.ranking,goToPreviousStep:c})]})})}function Kr({deck:r,onSubmitWords:t,user:s,announcement:n}){const{updateDict:o,length:c,keys:a,setDict:i}=ir({});ue();const d=()=>{i(le.sampleSize(r,10).reduce((u,v)=>(u[v.id]=!0,u),{}))};return e.jsxs(q,{fullWidth:!0,announcement:n,children:[e.jsx(U,{children:e.jsx(l,{pt:"Quais cartas deveriam estar no jogo?",en:"What cards should be in the game?"})}),e.jsx(k,{type:"action",children:e.jsx(l,{pt:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Selecione"})," pelo menos 10 cartas para estar no jogo.",e.jsx("br",{}),"Quanto mais melhor!"]}),en:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Select"})," at least 10 cards to be in the game.",e.jsx("br",{}),"The more the merrier!"]})})}),e.jsxs(T,{children:[e.jsx(W,{onClick:d,size:"large",children:e.jsx(l,{pt:"Selecione pra mim",en:"Select for me"})}),e.jsx(lr,{count:c,children:e.jsx(Q,{onClick:()=>t({words:a}),size:"large",disabled:c<10||s.ready,children:e.jsx(l,{pt:"Enviar cartas",en:"Submit cards"})})})]}),e.jsx(T,{className:"max-width",wrap:!0,children:r.map(u=>e.jsx(Ne,{onClick:()=>o(u.id),active:a.includes(u.id),children:e.jsx(cr,{hideHeader:!0,children:u.text})},u.id))})]})}function Qr({players:r,state:t,user:s}){const{step:n,setStep:o}=_(0),c=Er(o),a=e.jsx(D,{icon:e.jsx(or,{}),title:e.jsx(l,{pt:"Preparação da Grade",en:"Grid Setup"}),currentRound:t?.round?.current,type:"overlay"});return e.jsx(F,{phase:t?.phase,allowedPhase:E.WORDS_SELECTION,children:e.jsx(V,{step:n,players:r,children:e.jsx(Kr,{deck:t.deck,onSubmitWords:c,user:s,announcement:a})})})}function Zr({state:r,players:t,user:s}){return e.jsxs(ur,{state:r,players:t,announcementIcon:e.jsx(dr,{}),children:[e.jsx(mr,{players:t,achievements:r.achievements,reference:pr}),e.jsx(xr,{}),e.jsx(pe,{title:e.jsx(l,{en:"The Final Grid",pt:"A Grade Final"}),children:e.jsx(z,{grid:r.grid,gridType:r.gameType,user:s,CellComponent:fe,cellComponentProps:{clues:[],players:t,playerPerVotedCell:{},colorCodedCluesPerPlayer:{}}})})]})}function Jr(r){switch(r.phase){case E.WORDS_SELECTION:return Qr;case E.CLUE_WRITING:return Mr;case E.GUESSING:return qr;case E.REVEAL:return Yr;case Be.DEFAULT.GAME_OVER:return Zr;default:return ke}}function Es(){return e.jsx(We,{gameCollection:Ae.CRUZA_PALAVRAS,getActiveComponent:Jr})}export{Es as default};
