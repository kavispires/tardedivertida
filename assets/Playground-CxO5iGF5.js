import{r as y,$ as N,j as o,O as T,B as A,h as D,b1 as B,v as M,E as F,x as _,L as W}from"./index-Dm74Z5K1.js";import{D as H}from"./DevHeader-DJGgICdL.js";import{D as U,u as q}from"./core.esm-DDgaBUX7.js";import{R as V,p as $}from"./soundEffects-Cli4Y4mJ.js";import{t as Z}from"./index-DyzrMMI9.js";import{C as G}from"./index-CIcDCLo8.js";import{S as K}from"./index-R__9kipT.js";import"./index-CLv8vwJN.js";import"./extends-CF3RwP-h.js";import"./useId-DLIABLDt.js";import"./index-AONvdDJc.js";import"./EllipsisOutlined-Dl4zkLvB.js";import"./Overflow-CFETzgpu.js";import"./PlusOutlined-ClPcZ7pY.js";var Q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};function O(){return O=Object.assign?Object.assign.bind():function(e){for(var f=1;f<arguments.length;f++){var a=arguments[f];for(var v in a)Object.prototype.hasOwnProperty.call(a,v)&&(e[v]=a[v])}return e},O.apply(this,arguments)}const J=(e,f)=>y.createElement(N,O({},e,{ref:f,icon:Q})),ee=y.forwardRef(J),te=({data:e,imageUrl:f,totalCols:a,totalRows:v,blockSize:r,index:i})=>{const{attributes:p,listeners:b,setNodeRef:I,transform:u,isDragging:L}=q({id:e.id,disabled:e.isLocked,data:{...e}}),S={position:"absolute",left:e.currentPos.x,top:e.currentPos.y,transform:u?`translate3d(${u.x}px, ${u.y}px, 0)`:void 0,zIndex:L?9999:e.isLocked?1:100,cursor:e.isLocked?"default":"grab",touchAction:"none"};return o.jsx("div",{ref:I,style:S,...b,...p,children:o.jsx(D.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:L?1.1:1,filter:e.isLocked?"brightness(1)":L?"brightness(1.1)":"brightness(1)"},transition:{duration:.3,delay:e.isLocked?0:i*.05,type:"spring",stiffness:300,damping:20},whileTap:e.isLocked?void 0:{scale:.95},children:e.shape.map((P,j)=>{const n=-(e.correctPos.x+P.x)*r,m=-(e.correctPos.y+P.y)*r;return o.jsx(D.div,{style:{position:"absolute",left:P.x*r,top:P.y*r,width:r,height:r,backgroundImage:`url(${f})`,backgroundSize:`${a*r}px ${v*r}px`,backgroundPosition:`${n}px ${m}px`,boxSizing:"border-box"},animate:{border:e.isLocked?"0px solid transparent":"1px solid rgba(255,255,255,0.8)",boxShadow:L?"0px 10px 20px rgba(0,0,0,0.4)":e.isLocked?"none":"0px 2px 4px rgba(0,0,0,0.3)"}},j)})})})},se=({data:e,onComplete:f})=>{const[a,v]=y.useState([]),r=y.useRef(null),[i,p]=y.useState(0),[b,I]=y.useState({width:0,height:0}),[u,L]=y.useState({x:0,y:20}),[S,P]=y.useState(!1),{token:j}=Z.useToken();y.useEffect(()=>{const t=()=>{if(!r.current)return;const s=r.current.offsetWidth,c=window.innerHeight-200,h=(s-32)/e.gridCols,l=Math.min(50,Math.floor(h)),g=e.gridCols*l,w=(s-g)/2;p(l),I({width:s,height:c}),L({x:w,y:20})};t();const d=new ResizeObserver(()=>t());return r.current&&d.observe(r.current),()=>d.disconnect()},[e.gridCols]),y.useEffect(()=>{if(i===0||b.width===0)return;const t=b.width<600,d=e.gridRows*i,s=e.pieces.map(c=>{const h=u.x+c.correctPos.x*i,l=u.y+c.correctPos.y*i;if(c.initialLocked)return{...c,currentPos:{x:h,y:l},isLocked:!0};let g,w;if(t){const z=b.width-i*2,E=d+40,C=Math.max(E+300,b.height);g=Math.random()*Math.max(0,z),w=E+Math.random()*(C-E)}else{const z=u.x+e.gridCols*i+20,E=b.width-i,C=d-i;g=z+Math.random()*Math.max(0,E-z),w=Math.random()*C}return{...c,currentPos:{x:g,y:w},isLocked:!1}});v(s),P(!0)},[e,i,b.width,u.x]);const n=t=>{const{active:d,delta:s}=t;v(c=>{const h=M.cloneDeep(c),l=h.find(R=>R.id===d.id);if(!l)return c;let g=l.currentPos.x+s.x,w=l.currentPos.y+s.y;const z=u.x+l.correctPos.x*i,E=u.y+l.correctPos.y*i,C=Math.sqrt((g-z)**2+(w-E)**2),Y=i*.45;return C<Y?(g=z,w=E,l.isLocked=!0,$("addCorrect")):$("bubbleOut"),l.currentPos={x:g,y:w},h.every(R=>R.isLocked)&&!c.every(R=>R.isLocked)&&f&&($("win"),f()),h})},m=y.useMemo(()=>a.length>0&&a.every(t=>t.isLocked),[a]),x=e.gridRows*i,k=e.gridCols*i;return o.jsxs(G,{style:{width:"100%",maxWidth:900,margin:"0 auto",border:"none",background:"transparent"},bodyStyle:{padding:0},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:"0 10px"},children:[o.jsx(T.Title,{level:4,style:{margin:0},children:"Puzzle"}),o.jsx(A,{icon:o.jsx(ee,{}),onClick:()=>{P(!1),window.dispatchEvent(new Event("resize"))},children:"Reset"})]}),o.jsx(U,{onDragEnd:n,children:o.jsxs("div",{ref:r,style:{position:"relative",height:S?m?x+100:Math.max(600,x+450):400,width:"100%",backgroundColor:j.colorFillAlter,borderRadius:j.borderRadiusLG,overflow:"hidden",touchAction:"none",border:`1px solid ${j.colorBorderSecondary}`,transition:"height 0.3s ease"},children:[!S&&o.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:o.jsx(K,{tip:"Loading Puzzle..."})}),S&&i>0&&o.jsxs(o.Fragment,{children:[o.jsxs(D.div,{initial:{opacity:0},animate:{opacity:1},style:{position:"absolute",top:u.y,left:u.x,width:k,height:x,boxShadow:"0 0 0 2px rgba(0,0,0,0.05)",backgroundColor:"rgba(255,255,255,0.5)",zIndex:0},children:[o.jsx("div",{style:{width:"100%",height:"100%",backgroundImage:`
                     linear-gradient(to right, rgba(0,0,0,0.1) 1px, transparent 1px),
                     linear-gradient(to bottom, rgba(0,0,0,0.1) 1px, transparent 1px)
                   `,backgroundSize:`${i}px ${i}px`}}),o.jsx("div",{style:{position:"absolute",bottom:-25,width:"100%",textAlign:"center",color:j.colorTextQuaternary,fontSize:12},children:"Place pieces here"})]}),a.map((t,d)=>o.jsx(te,{index:d,data:t,imageUrl:e.imageUrl,totalCols:e.gridCols,totalRows:e.gridRows,blockSize:i},t.id)),o.jsx(B,{children:m&&o.jsxs(D.div,{initial:{opacity:0,backdropFilter:"blur(0px)"},animate:{opacity:1,backdropFilter:"blur(8px)"},style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255,255,255,0.6)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:2e3},children:[o.jsx(D.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:o.jsx(V,{style:{fontSize:80,color:"#52c41a"}})}),o.jsx(T.Title,{level:2,style:{color:"#52c41a",marginTop:16},children:"Excellent!"})]})})]})]})})]})},X=50,oe=7,ne=(e,f=12,a=6)=>{const v=Math.max(9,Math.min(24,f)),r=Math.round(a*1.5),i=[],p=[];let b=0;for(let n=0;n<r;n++){const m=[];for(let x=0;x<a;x++)m.push(b),p.push({id:b,blocks:[{x,y:n}]}),b++;i.push(m)}let I=0;for(;p.length>v&&!(I>50);){let n=Number.POSITIVE_INFINITY;p.forEach(t=>{t.blocks.length<n&&(n=t.blocks.length)});const m=p.filter(t=>t.blocks.length===n),x=M.shuffle(m);let k=!1;for(const t of x){const d=new Set;if(t.blocks.forEach(s=>{[{x:s.x+1,y:s.y},{x:s.x-1,y:s.y},{x:s.x,y:s.y+1},{x:s.x,y:s.y-1}].forEach(h=>{if(h.x>=0&&h.x<a&&h.y>=0&&h.y<r){const l=i[h.y][h.x];if(l!==t.id){const g=p.find(w=>w.id===l);g&&t.blocks.length+g.blocks.length<=oe&&d.add(l)}}})}),d.size>0){const s=Array.from(d),c=s[M.random(0,s.length-1)],h=p.findIndex(g=>g.id===c),l=p[h];t.blocks=[...t.blocks,...l.blocks],l.blocks.forEach(g=>{i[g.y][g.x]=t.id}),p.splice(h,1),k=!0;break}}if(k)I=0;else if(I++,I>5){const t=M.shuffle(p);for(const d of t);}}const u=p.map((n,m)=>{n.blocks.sort((s,c)=>s.y-c.y||s.x-c.x);const x=n.blocks[0],k=n.blocks.map(s=>({x:s.x-x.x,y:s.y-x.y})),t=a*X+20,d=t+200;return{id:`piece-${m}`,shape:k,correctPos:{x:x.x,y:x.y},initialPos:{x:M.random(t,d),y:M.random(0,r*X-50)},initialLocked:!1}}),L=a/2,S=r/2;let P=-1,j=Number.POSITIVE_INFINITY;if(u.forEach((n,m)=>{let x=0,k=0;n.shape.forEach(c=>{x+=n.correctPos.x+c.x,k+=n.correctPos.y+c.y});const t=x/n.shape.length,d=k/n.shape.length,s=Math.sqrt((t-L)**2+(d-S)**2);s<j&&(j=s,P=m)}),P!==-1){const n=u[P];n.initialPos={x:n.correctPos.x*X,y:n.correctPos.y*X},n.initialLocked=!0}return{imageUrl:e,gridCols:a,gridRows:r,pieces:u}};function Pe(){F("Playground | Dev | Tarde Divertida");const[e,f]=y.useState([]),a=y.useMemo(()=>ne(`https://www.kavispires.com/td-images/images/td/d${M.random(1,12)}/${M.random(10,252)}.jpg`,5),[]);return o.jsxs(_,{children:[o.jsx(H,{title:"Playground"}),o.jsxs(W.Content,{className:"dev-content",children:[o.jsx("div",{children:"playground content"}),o.jsx("div",{style:{padding:20},children:o.jsx(se,{data:a,onComplete:()=>console.log("User finished!")})})]})]})}export{Pe as default};
